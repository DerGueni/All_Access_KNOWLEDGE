{
  "permissions": {
    "allow": [
      "Bash",
      "Bash(netstat:*)",
      "Bash(findstr:*)",
      "Bash(dir:*)",
      "Bash(python:*)",
      "Bash(curl:*)",
      "Bash(copy:*)",
      "Bash(chmod:*)",
      "Bash(./scripts/freeze*.sh:*)",
      "Bash(./scripts/unfreeze.sh:*)",
      "mcp__playwright__browser_navigate",
      "mcp__playwright__browser_click",
      "mcp__playwright__browser_console_messages",
      "mcp__playwright__browser_wait_for",
      "mcp__playwright__browser_snapshot",
      "mcp__playwright__browser_evaluate"
    ],
    "default": "allow"
  },

  "freezeProtection": {
    "enabled": true,
    "freezeFile": "claude.freeze.json",
    "stableDir": "stable/",
    "experimentsDir": "experiments/",

    "rules": {
      "checkBeforeWrite": true,
      "checkBeforeEdit": true,
      "requireExplicitUnfreeze": true,
      "warnOnPatternMatch": true,
      "blockProtectedBlocks": true
    },

    "hooks": {
      "preWrite": {
        "description": "Prueft vor jedem Schreibvorgang ob Datei eingefroren ist",
        "command": "./scripts/freeze-check.sh",
        "failOnFrozen": true
      },
      "preEdit": {
        "description": "Prueft vor jeder Bearbeitung ob Datei eingefroren ist",
        "command": "./scripts/freeze-check.sh",
        "failOnFrozen": true
      },
      "postFreeze": {
        "description": "Nach Einfrieren - Backup erstellen",
        "command": "cp -p ${FILE} stable/$(basename ${FILE})_$(date +%Y-%m-%d)"
      }
    },

    "protectedPatterns": [
      "04_HTML_Forms/forms3/css/form-titles.css",
      "04_HTML_Forms/forms3/css/unified-header.css",
      "06_Server/api_server.py",
      "04_HTML_Forms/forms3/_scripts/mini_api.py",
      "exports/vba/**/*.bas"
    ],

    "neverModify": [
      "claude.freeze.json",
      "CLAUDE.md",
      ".claude/settings.local.json"
    ],

    "alwaysAskBefore": [
      "*.css",
      "*.html",
      "**/logic/*.js",
      "**/*api*.py"
    ]
  },

  "sessionRules": {
    "description": "Regeln fuer alle zukuenftigen Sessions",

    "beforeAnyChange": [
      "Pruefe ob Datei in claude.freeze.json gelistet ist",
      "Pruefe ob Datei einem frozenPattern entspricht",
      "Pruefe ob Aenderung innerhalb eines PROTECTED-Blocks liegt",
      "Bei Treffer: STOPP und User fragen"
    ],

    "afterSuccessfulChange": [
      "Frage ob Element eingefroren werden soll",
      "Bei 'ja': ./scripts/freeze.sh ausfuehren",
      "Dokumentiere in CLAUDE2.md"
    ],

    "experimentWorkflow": [
      "Neue Features zuerst in experiments/ entwickeln",
      "Nach erfolgreichem Test nach stable/ kopieren",
      "Dann erst ins Projekt uebernehmen"
    ]
  },

  "protectedBlockMarkers": {
    "start": ["// PROTECTED START", "/* PROTECTED START", "<!-- PROTECTED START", "# PROTECTED START"],
    "end": ["// PROTECTED END", "/* PROTECTED END", "<!-- PROTECTED END", "# PROTECTED END"]
  },

  "metadata": {
    "version": "2.0.0",
    "created": "2026-01-28",
    "description": "Claude Code CLI Konfiguration mit Freeze-Schutzsystem"
  }
}
