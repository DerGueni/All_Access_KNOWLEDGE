{"id":"MOD_mod_ExportConsys","name":"mod_ExportConsys","kind":"standard","procedures":["Public Sub Export_All_Consys()","Private Sub EnsureFolder(ByVal folderPath As String)","Public Function EscapeJSON(ByVal Text As String) As String","Public Function GetProp(obj As Object, propName As String) As String","Private Sub ExportTableDefsToJSON(exportPath As String)","Private Sub ExportQueryDefsToJSON(exportPath As String)","Private Sub ExportFormsToJSON(exportPath As String)","Private Sub ExportReportsToJSON(exportPath As String)","Private Sub ExportModulesToJSON(exportPath As String)","Private Sub ExportMacrosToJSON(exportPath As String)","Private Sub ExportRelationsToJSON(exportPath As String)","Private Sub DetectWorkflows(exportPath As String)"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"'═══════════════════════════════════════════════════════════════════════════════\n' Modul:     mod_ExportConsys\n' Zweck:     Haupt-Export-Modul für vollständige Datenbank-Dokumentation\n' Autor:     Access-Forensiker Agent\n' Datum:     2025-10-31\n' Version:   1.0\n'═══════════════════════════════════════════════════════════════════════════════\n\nOption Compare Database\nOption Explicit\n\n' Konstanten für Export-Pfade\nPrivate Const EXPORT_BASE_PATH As String = \"\\Documents\\0000_Consys_Wissen_kpl\\03_Export_Ergebnisse\"\n\n'═══════════════════════════════════════════════════════════════════════════════\n' HAUPT-EXPORT-ROUTINE\n'═══════════════════════════════════════════════════════════════════════════════\n\nPublic Sub Export_All_Consys()\n    On Error GoTo ErrorHandler\n    \n    Dim exportPath As String\n    Dim startTime As Double\n    Dim endTime As Double\n    \n    ' Timer starten\n    startTime = Timer\n    \n    ' Export-Pfad vorbereiten\n    exportPath = Environ$(\"USERPROFILE\") & EXPORT_BASE_PATH\n    EnsureFolder exportPath\n    \n    ' Fortschritts-Nachricht\n    Debug.Print \"═══════════════════════════════════════════════════════\"\n    Debug.Print \"Consys-Datenbank Export gestartet...\"\n    Debug.Print \"Export-Pfad: \" & exportPath\n    Debug.Print \"═══════════════════════════════════════════════════════\"\n    Debug.Print \"\"\n    \n    ' 1. Tabellen exportieren\n    Debug.Print \"[1/8] Exportiere Tabellen...\"\n    ExportTableDefsToJSON exportPath\n    Debug.Print \"      ✓ Tabellen exportiert → tables.json\"\n    \n    ' 2. Queries exportieren\n    Debug.Print \"[2/8] Exportiere Queries...\"\n    ExportQueryDefsToJSON exportPath\n    Debug.Print \"      ✓ Queries exportiert → queries.json\"\n    \n    ' 3. Formulare exportieren\n    Debug.Print \"[3/8] Exportiere Formulare...\"\n    ExportFormsToJSON exportPath\n    Debug.Print \"      ✓ Formulare exportiert → forms.json\"\n    \n    ' 4. Reports exportieren\n    Debug.Print \"[4/8] Exportiere Reports...\"\n    ExportReportsToJSON exportPath\n    Debug.Print \"      ✓ Reports exportiert → reports.json\"\n    \n    ' 5. Module exportieren\n    Debug.Print \"[5/8] Exportiere VBA-Module...\"\n    ExportModulesToJSON exportPath\n    Debug.Print \"      ✓ Module exportiert → modules.json\"\n    \n    ' 6. Makros exportieren\n    Debug.Print \"[6/8] Exportiere Makros...\"\n    ExportMacrosToJSON exportPath\n    Debug.Print \"      ✓ Makros exportiert → macros.json\"\n    \n    ' 7. Beziehungen exportieren\n    Debug.Print \"[7/8] Exportiere Beziehungen...\"\n    ExportRelationsToJSON exportPath\n    Debug.Print \"      ✓ Beziehungen exportiert → relations.json\"\n    \n    ' 8. Workflows erkennen\n    Debug.Print \"[8/8] Analysiere Workflows...\"\n    DetectWorkflows exportPath\n    Debug.Print \"      ✓ Workflows analysiert → workflows.json\"\n    \n    ' Timer stoppen\n    endTime = Timer\n    \n    ' Erfolgsmeldung\n    Debug.Print \"\"\n    Debug.Print \"═══════════════════════════════════════════════════════\"\n    Debug.Print \"✓ Export erfolgreich abgeschlossen!\"\n    Debug.Print \"  Dauer: \" & Format(endTime - startTime, \"0.00\") & \" Sekunden\"\n    Debug.Print \"  Pfad: \" & exportPath\n    Debug.Print \"═══════════════════════════════════════════════════════\"\n    \n    MsgBox \"Export abgeschlossen!\" & vbCrLf & vbCrLf & _\n           \"Alle Dateien wurden exportiert nach:\" & vbCrLf & _\n           exportPath & vbCrLf & vbCrLf & _\n           \"Dauer: \" & Format(endTime - startTime, \"0.00\") & \" Sekunden\", _\n           vbInformation, \"Consys Export\"\n    \n    Exit Sub\n\nErrorHandler:\n    Debug.Print \"\"\n    Debug.Print \"✗ FEHLER beim Export!\"\n    Debug.Print \"  Beschreibung: \" & err.description\n    Debug.Print \"  Nummer: \" & err.Number\n    \n    MsgBox \"Fehler beim Export:\" & vbCrLf & vbCrLf & _\n           err.description & vbCrLf & _\n           \"(Fehler-Nr: \" & err.Number & \")\", _\n           vbCritical, \"Consys Export Fehler\"\nEnd Sub\n\n'═══════════════════════════════════════════════════════════════════════════════\n' HILFSFUNKTIONEN\n'═══════════════════════════════════════════════════════════════════════════════\n\n' Stellt sicher, dass ein Ordner existiert\nPrivate Sub EnsureFolder(ByVal folderPath As String)\n    On Error Resume Next\n    If Dir(folderPath, vbDirectory) = \"\" Then\n        MkDir folderPath\n    End If\n    On Error GoTo 0\nEnd Sub\n\n' Escaped JSON-Strings (ersetzt \" durch ')\nPublic Function EscapeJSON(ByVal Text As String) As String\n    If IsNull(Text) Then\n        EscapeJSON = \"\"\n        Exit Function\n    End If\n    \n    ' Anführungszeichen durch ' ersetzen\n    Text = Replace(Text, \"\"\"\", \"'\")\n    \n    ' Zeilenumbrüche durch \\n ersetzen\n    Text = Replace(Text, vbCrLf, \"\\n\")\n    Text = Replace(Text, vbCr, \"\\n\")\n    Text = Replace(Text, vbLf, \"\\n\")\n    \n    ' Backslashes escapen\n    Text = Replace(Text, \"\\\", \"\\\\\")\n    \n    EscapeJSON = Text\nEnd Function\n\n' Gibt Property-Wert zurück oder leeren String\nPublic Function GetProp(obj As Object, propName As String) As String\n    On Error Resume Next\n    GetProp = obj.Properties(propName)\n    If err.Number <> 0 Then\n        GetProp = \"\"\n    End If\n    On Error GoTo 0\nEnd Function\n\n'═══════════════════════════════════════════════════════════════════════════════\n' PLATZHALTER FÜR EXPORT-FUNKTIONEN\n' (werden in separaten Modulen implementiert)\n'═══════════════════════════════════════════════════════════════════════════════\n\nPrivate Sub ExportTableDefsToJSON(exportPath As String)\n    ' Wird in mod_ExportTables implementiert\n    mod_ExportTables.ExportTableDefsToJSON exportPath\nEnd Sub\n\nPrivate Sub ExportQueryDefsToJSON(exportPath As String)\n    ' Wird in mod_ExportQueries implementiert\n    mod_ExportQueries.ExportQueryDefsToJSON exportPath\nEnd Sub\n\nPrivate Sub ExportFormsToJSON(exportPath As String)\n    ' Wird in mod_ExportForms implementiert\n    mod_ExportForms.ExportFormsToJSON exportPath\nEnd Sub\n\nPrivate Sub ExportReportsToJSON(exportPath As String)\n    ' Wird in mod_ExportReports implementiert\n    mod_ExportReports.ExportReportsToJSON exportPath\nEnd Sub\n\nPrivate Sub ExportModulesToJSON(exportPath As String)\n    ' Wird in mod_ExportModules implementiert\n    mod_ExportModules.ExportModulesToJSON exportPath\nEnd Sub\n\nPrivate Sub ExportMacrosToJSON(exportPath As String)\n    ' Wird in mod_ExportMacros implementiert\n    ' Makros sind in Access selten, daher einfacher Export\n    Dim f As Integer\n    Dim filePath As String\n    filePath = exportPath & \"\\macros.json\"\n    f = FreeFile\n    Open filePath For Output As #f\n    Print #f, \"[]\"\n    Close #f\nEnd Sub\n\nPrivate Sub ExportRelationsToJSON(exportPath As String)\n    ' Wird in mod_ExportRelations implementiert\n    mod_ExportRelations.ExportRelationsToJSON exportPath\nEnd Sub\n\nPrivate Sub DetectWorkflows(exportPath As String)\n    ' Wird in mod_WorkflowDetector implementiert\n    mod_WorkflowDetector.DetectWorkflows exportPath\nEnd Sub"}
