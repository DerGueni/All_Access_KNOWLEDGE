{"id":"MOD_mdl_FormularErsteller","name":"mdl_FormularErsteller","kind":"standard","procedures":["Public Sub CreateEventAuswahlFormNow()"],"calls":{"DoCmd.OpenForm":["frm_EventAuswahl"],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n\n' ============================================================================\n' ANLEITUNG:\n' 1. Oeffnen Sie Access: Consys_FE_N_Test_Claude.accdb\n' 2. Druecken Sie ALT+F11 (VBA-Editor)\n' 3. Menue: Datei > Datei importieren\n' 4. Waehlen Sie diese .bas-Datei\n' 5. Druecken Sie F5 und fuehren Sie CreateEventAuswahlFormNow aus\n' ============================================================================\n\nPublic Sub CreateEventAuswahlFormNow()\n    On Error GoTo ErrorHandler\n Dim frmName As String\n \n    Dim frm As Form\n    Dim lst As control\n    Dim btn1 As control, btn2 As control, btn3 As control, btn4 As control\n    Dim lbl As control\n    \n    ' Loesche Formular falls es existiert\n    On Error Resume Next\n    DoCmd.DeleteObject acForm, \"frm_EventAuswahl\"\n    On Error GoTo ErrorHandler\n    \n    ' Erstelle neues Formular\n    Set frm = CreateForm\n    \n    ' Formular-Eigenschaften\n    With frm\n        .caption = \"Event-Auswahl\"\n        .RecordSelectors = False\n        .NavigationButtons = False\n        .ScrollBars = 0\n        .AutoCenter = True\n        .BorderStyle = 3\n        .width = 12000\n        .Section(acDetail).height = 6500\n    End With\n    \n    ' Label\n    \n' NACHHER (RICHTIG - Properties einzeln setzen):\nSet lbl = CreateControl(frmName, acLabel, acDetail)\nlbl.Left = 200\nlbl.Top = 200\nlbl.width = 11500\n    With lbl\n        .caption = \"Bitte waehlen Sie die Events aus, die importiert werden sollen:\"\n        .FontSize = 10\n        .FontBold = True\n    End With\n    \n    ' ListBox\n    Set lst = CreateControl(frm.Name, acListBox, acDetail, , , 200, 700, 11500, 4500)\n    With lst\n        .Name = \"lstEvents\"\n        .ColumnCount = 5\n        .ColumnWidths = \"400;800;5500;2000;0\"\n        .MultiSelect = 1\n        .FontSize = 9\n    End With\n    \n    ' Button: Alle auswaehlen\n    Set btn1 = CreateControl(frm.Name, acCommandButton, acDetail, , , 200, 5400, 2500, 600)\n    With btn1\n        .Name = \"btnAlleAuswaehlen\"\n        .caption = \"Alle auswaehlen\"\n    End With\n    \n    ' Button: Alle abwaehlen\n    Set btn2 = CreateControl(frm.Name, acCommandButton, acDetail, , , 2900, 5400, 2500, 600)\n    With btn2\n        .Name = \"btnAlleAbwaehlen\"\n        .caption = \"Alle abwaehlen\"\n    End With\n    \n    ' Button: OK\n    Set btn3 = CreateControl(frm.Name, acCommandButton, acDetail, , , 7200, 5400, 2000, 600)\n    With btn3\n        .Name = \"btnOK\"\n        .caption = \"OK\"\n        .Default = True\n    End With\n    \n    ' Button: Abbrechen\n    Set btn4 = CreateControl(frm.Name, acCommandButton, acDetail, , , 9400, 5400, 2000, 600)\n    With btn4\n        .Name = \"btnAbbrechen\"\n        .caption = \"Abbrechen\"\n        .Cancel = True\n    End With\n    \n    ' Formular speichern\n    DoCmd.Close acForm, frm.Name, acSaveYes\n    DoCmd.Rename \"frm_EventAuswahl\", acForm, frm.Name\n    \n    MsgBox \"Formular 'frm_EventAuswahl' erfolgreich erstellt!\" & vbCrLf & vbCrLf & _\n           \"Jetzt muss noch der Formular-Code hinzugefuegt werden.\", vbInformation\n    \n    ' Oeffne Formular im Entwurfsmodus\n    DoCmd.OpenForm \"frm_EventAuswahl\", acDesign\n    \n    Exit Sub\n    \nErrorHandler:\n    MsgBox \"Fehler beim Erstellen des Formulars:\" & vbCrLf & vbCrLf & _\n           \"Fehler-Nr: \" & err.Number & vbCrLf & _\n           \"Beschreibung: \" & err.description, vbCritical\nEnd Sub"}
