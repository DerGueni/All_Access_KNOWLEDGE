{"id":"MOD_mdlTstTabField","name":"mdlTstTabField","kind":"standard","procedures":["Function xxtst()","Public Function ShowIndexNames()","Public Function WriteIndexNames()","Function TableInfoTab(strTableName As String, Optional dbname As String = \"\")","Function TableInfoTest(strTableName As String)","Function TableInfo(strTableName As String)","Function TableInfoConst(strTableName As String)","Function TableInfoMit(strTableName As String)","Function fieldType(n) As String","Function AccessEigenschaftEinstellen(obj As Object, StrName As String, _","Function TSQL_TableDescription(sPath As String, Optional InclLinkTables As Boolean = True, Optional MitUpdate As Boolean = True)"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n\nFunction xxtst()\nCall TSQL_TableDescription(\"C:\\Access2\\NeueTabellen_PLZ_BLZ_2013_03\\TSQL_CreateTableDesc.sql\", False)\nEnd Function\n\n\nPublic Function ShowIndexNames()\n    Dim tdf As TableDef\n    Dim idx As Index\n    Dim idf As field\n    Dim num_indexes As Long\n\nOn Error GoTo ErrorHandler\n\n    For Each tdf In CurrentDb.TableDefs\n        num_indexes = tdf.indexes.Count\n        If Left$(tdf.Name, 4) <> \"MSys\" Then\n            If num_indexes > 0 Then\n                For Each idx In tdf.indexes\n                    Debug.Print CurrentDb.Name, tdf.Name, idx.Name, idx.Primary, idx.Foreign, idx.Unique\n'                    For Each idf In idx.Fields\n'                        Debug.Print , CurrentDb.Name, idx.Name, idf.Name\n'                    Next idf\n                Next idx\n            End If\n         End If\n    Next tdf\n\nExitHere:\n    Exit Function\n\nErrorHandler:\n    Select Case err.Number\n    Case 3110\n        'Could not read definitions; no read definitions '\n        'permission for table or query '<Name>'. '\n        Debug.Print \"No read definitions permission for \" _\n            & tdf.Name\n        num_indexes = 0\n        Resume Next\n    Case Else\n        Debug.Print err.Number & \"-> \" & err.description\n        GoTo ExitHere\n    End Select\nEnd Function\n\nPublic Function WriteIndexNames()\n    Dim tdf As TableDef\n    Dim idx As Index\n    Dim idf\n    Dim num_indexes As Long\n    \n    Dim db As DAO.Database\n'    Dim rst As DAO.Recordset\n    Dim rst1 As DAO.Recordset\n\nOn Error GoTo ErrorHandler\n\n'    CurrentDb.Execute (\"DELETE * FROM _tblTabIndex;\")\n    CurrentDb.Execute (\"DELETE * FROM _tblTabIndexFeld;\")\n    DoEvents\n    \n    Set db = CurrentDb\n'    Set rst = db.OpenRecordset(\"SELECT * FROM _tblTabIndex;\")\n    Set rst1 = db.OpenRecordset(\"SELECT * FROM _tblTabIndexFeld;\")\n\n    For Each tdf In CurrentDb.TableDefs\n        num_indexes = tdf.indexes.Count\n        If Left$(tdf.Name, 4) <> \"MSys\" Then\n            If num_indexes > 0 Then\n                For Each idx In tdf.indexes\n'                    Debug.Print CurrentDb.Name, tdf.Name, idx.Name, idx.Primary\n'                    rst.AddNew\n'                        rst.Fields(\"Datenbankname\") = CurrentDb.Name\n'                        rst.Fields(\"Tabellenname\") = tdf.Name\n'                        rst.Fields(\"Indexname\") = idx.Name\n'                        rst.Fields(\"istPK\") = idx.Primary\n'                    rst.Update\n                        \n                    For Each idf In idx.fields\n'                        Debug.Print , CurrentDb.Name, idx.Name, idf.Name\n                    rst1.AddNew\n                        rst1.fields(\"Datenbankname\") = CurrentDb.Name\n                        rst1.fields(\"Indexname\") = idx.Name\n                        rst1.fields(\"Tabellenname\") = tdf.Name\n                        rst1.fields(\"Feldname\") = idf.Name\n                        rst1.fields(\"istPK\") = idx.Primary\n                        rst1.fields(\"IndexIstUnique\") = idx.Unique\n                        rst1.fields(\"IndexIstReferentiell\") = idx.Foreign\n                    rst1.update\n                    Next idf\n                Next idx\n            End If\n         End If\n    Next tdf\n\n'    rst.Close\n    rst1.Close\n    \n'    Set rst = Nothing\n    Set rst1 = Nothing\n    \nExitHere:\n    Exit Function\n\nErrorHandler:\n    Select Case err.Number\n    Case 3110\n        'Could not read definitions; no read definitions '\n        'permission for table or query '<Name>'. '\n        Debug.Print \"No read definitions permission for \" _\n            & tdf.Name\n        num_indexes = 0\n        Resume Next\n    Case Else\n        Debug.Print err.Number & \"-> \" & err.description\n        GoTo ExitHere\n    End Select\nEnd Function\n\n\nFunction TableInfoTab(strTableName As String, Optional dbname As String = \"\")\n   ' Alison Brown / geändert: KObd\n   ' Purpose: Print in the immediate window the field names, types, and sizes for any table.\n   ' Argument: name of a table in the current database.\n   Dim db As DAO.Database\n'   Dim tdf As TableDef\n   Dim tdf As DAO.Recordset\n   Dim i As Integer\n   Dim fldnam As String, fldtyp As String, fldsiz As String, flddes As String\n   Dim prp As Properties\n   Set db = DBEngine(0)(0)\n   On Error GoTo TableInfoTabErr\n'   Set tdf = db.TableDefs(strTableName)\n   Set tdf = db.OpenRecordset(strTableName, dbOpenDynaset, dbSeeChanges)\n   Dim dbs As DAO.Database\n   Dim rst As DAO.Recordset\n                \n'   If Not AccessEigenschaftEinstellen(tdf, \"Description\", dbText, False) Then\n'       MsgBox \"Adding Description Property to tables did not work\"\n'       Exit Function\n'   End If\n   Set dbs = CurrentDb\n   Set rst = dbs.OpenRecordset(\"SELECT TOP 1 * FROM _tblTabFelder;\", dbOpenDynaset, dbSeeChanges)\n   \n   On Error GoTo TableInfoTabErrPrint\n'   Debug.Print strTableName\n'   Debug.Print \"FIELD NAME\", , \"FIELD TYPE\", \"SIZE\", \"DESCRIPTION\"\n'   Debug.Print \"==========\", , \"==========\", \"====\", \"===========\"\n   For i = 0 To tdf.fields.Count - 1\n   \n     \n     fldnam = tdf.fields(i).Name\n     fldtyp = fieldType(tdf.fields(i).Type)\n     fldsiz = tdf.fields(i).Size\n        On Error Resume Next\n     flddes = \"\"\n     flddes = tdf.fields(i).Properties(\"Description\")\n        err.clear\n        On Error GoTo TableInfoTabErrPrint\n          \n'     Debug.Print fldnam, ,\n'     Debug.Print fldtyp,\n'     Debug.Print fldsiz,\n'     Debug.Print flddes\n          \n      rst.AddNew\n         rst.fields(\"Datenbankname\").Value = dbname\n         rst.fields(\"Tabellenname\").Value = strTableName\n         rst.fields(\"TabFeldname\").Value = fldnam\n         rst.fields(\"FldTypNr\").Value = tdf.fields(i).Type\n         rst.fields(\"FldTypDesc\").Value = fldtyp\n         rst.fields(\"FldLaenge\").Value = fldsiz\n         rst.fields(\"FldDesc\").Value = flddes\n      rst.update\n      \n'      Debug.Print tdf.Fields(I).Name,\n'      Debug.Print FieldType(tdf.Fields(I).Type),\n'      Debug.Print tdf.Fields(I).Size,\n'      Debug.Print tdf.Fields(I).Properties(\"Description\")\n   \n   Next\n'   Debug.Print \"==========\", , \"==========\", \"====\", \"==========\";\n'   Debug.Print\n'   Debug.Print\n\n   rst.Close\n   Set rst = Nothing\n\nTableInfoTabExit:\ndb.Close\n   Exit Function\n\nTableInfoTabErrPrint:\n' Needed because a non existing Description within a field always causes an Error\n' and just a \"Resume Next\" would print the following fieldname within the same line\n      \n If err = 3270 Then\n      Debug.Print\n      Resume Next\n Else\n      Debug.Print \"Unerwarteter Fehler : \" & err\n      Resume Next\n End If\n\nTableInfoTabErr:\nSelect Case err\n   Case 3265   ' Supplied table name invalid\n       MsgBox strTableName & \" table doesn't exist\"\n       Resume TableInfoTabExit\n   Case Else\n       Debug.Print \"TableInfo() Error \" & err & \": \" & Error\n   End Select\n   End Function\n   \nFunction TableInfoTest(strTableName As String)\n   ' Alison Brown / geändert: KObd\n   ' Purpose: Print in the immediate window the field names, types, and sizes for any table.\n   ' Argument: name of a table in the current database.\n   Dim db As DAO.Database, tdf As DAO.Recordset, i As Integer, j As Long\n   Dim fldnam As String, fldtyp As String, fldsiz As String, flddes As String, flddes2 As String\n   Dim prp As Properties\n   Set db = DBEngine(0)(0)\n   On Error GoTo TableInfoErr\n'   Set tdf = db.TableDefs(strTableName)\n   Set tdf = db.OpenRecordset(strTableName, dbOpenDynaset, dbSeeChanges)\n                \n'   If Not AccessEigenschaftEinstellen(tdf, \"Description\", dbText, False) Then\n'       MsgBox \"Adding Description Property to tables did not work\"\n'       Exit Function\n'   End If\n   On Error GoTo TableInfoErrPrint\n   Debug.Print strTableName\n   Debug.Print \"FIELD NAME\" ', , \"FIELD TYPE\", \"SIZE\", \"DESCRIPTION\"\n   Debug.Print \"==========\" ', , \"==========\", \"====\", \"===========\"\n   For i = 0 To tdf.fields.Count - 1\n   \n     fldnam = tdf.fields(i).Name\n     fldtyp = fieldType(tdf.fields(i).Type)\n     fldsiz = tdf.fields(i).Size\n        On Error Resume Next\n     flddes = \"\"\n   For j = 0 To tdf.fields(i).Properties.Count - 1\n     flddes = \"\"\n     flddes2 = \"\"\n     flddes = tdf.fields(i).Properties(j).Name\n     flddes2 = tdf.fields(i).Properties(j).Value\n        Debug.Print , flddes, flddes2\n     flddes2 = \"\"\n     flddes = \"\"\n    Next j\n        err.clear\n        On Error GoTo TableInfoErrPrint\n          \n     Debug.Print i, fldnam\n'     Debug.Print fldnam, tdf.Fields(i).Type\n'     Debug.Print fldnam   ', ,\n'     Debug.Print i & \" - \" & fldnam   ', ,\n'     Debug.Print fldtyp,\n'     Debug.Print fldsiz,\n     Debug.Print flddes\n          \n'      Debug.Print tdf.Fields(I).Name,\n'      Debug.Print FieldType(tdf.Fields(I).Type),\n'      Debug.Print tdf.Fields(I).Size,\n'      Debug.Print tdf.Fields(I).Properties(\"Description\")\n   \n   Next\n   Debug.Print \"==========\" ', , \"==========\", \"====\", \"==========\";\n   Debug.Print\n   Debug.Print\n\nTableInfoExit:\ndb.Close\n   Exit Function\n\nTableInfoErrPrint:\n' Needed because a non existing Description within a field always causes an Error\n' and just a \"Resume Next\" would print the following fieldname within the same line\n      \n If err = 3270 Then\n      Debug.Print\n      Resume Next\n Else\n      Debug.Print \"Unerwarteter Fehler : \" & err\n      Resume Next\n End If\n\nTableInfoErr:\nSelect Case err\n   Case 3265   ' Supplied table name invalid\n       MsgBox strTableName & \" table doesn't exist\"\n       Resume TableInfoExit\n   Case Else\n       Debug.Print \"TableInfo() Error \" & err & \": \" & Error\n   End Select\n   End Function\n      \n   \nFunction TableInfo(strTableName As String)\n   ' Alison Brown / geändert: KObd\n   ' Purpose: Print in the immediate window the field names, types, and sizes for any table.\n   ' Argument: name of a table in the current database.\n   Dim db As DAO.Database, tdf As DAO.Recordset, i As Integer\n   Dim fldnam As String, fldtyp As String, fldsiz As String, flddes As String\n   Dim prp As Properties\n   Set db = DBEngine(0)(0)\n   On Error GoTo TableInfoErr\n'   Set tdf = db.TableDefs(strTableName)\n   Set tdf = db.OpenRecordset(strTableName, dbOpenDynaset, dbSeeChanges)\n                \n'   If Not AccessEigenschaftEinstellen(tdf, \"Description\", dbText, False) Then\n'       MsgBox \"Adding Description Property to tables did not work\"\n'       Exit Function\n'   End If\n   On Error GoTo TableInfoErrPrint\n   Debug.Print strTableName\n   Debug.Print \"FIELD NAME\" ', , \"FIELD TYPE\", \"SIZE\", \"DESCRIPTION\"\n   Debug.Print \"==========\" ', , \"==========\", \"====\", \"===========\"\n'   Debug.Print \"\"\"ID\"\"\" & \"; \" & \"\"\"Feldname\"\"\" & \"; \" & \"\"\"Feldtyp\"\"\"\n   For i = 0 To tdf.fields.Count - 1\n   \n     fldnam = tdf.fields(i).Name\n     fldtyp = fieldType(tdf.fields(i).Type)\n     fldsiz = tdf.fields(i).Size\n        On Error Resume Next\n     flddes = \"\"\n'     flddes = tdf.Fields(I).Properties(\"Description\")\n        err.clear\n        On Error GoTo TableInfoErrPrint\n          \n'     Debug.Print i, fldnam\n'     Debug.Print fldnam\n'''               Als Textdatei ausgeben und dann Import als Tabelle\n'     Debug.Print i + 1 & \"; \" & Chr$(34) & fldnam & Chr$(34) & \"; \" & tdf.Fields(i).Type\n     Debug.Print i, fldnam, tdf.fields(i).Type, fieldType(tdf.fields(i).Type)\n'     Debug.Print fldnam   ', ,\n'     Debug.Print i & \" - \" & fldnam   ', ,\n'     Debug.Print \"$$\" & strTableName & \".\" & fldnam & \" = [\" & strTableName & \"1].[\" & fldnam & \"], $!$\"\n'     Debug.Print fldtyp,\n'     Debug.Print fldsiz,\n'     Debug.Print flddes\n          \n'      Debug.Print tdf.Fields(I).Name,\n'      Debug.Print FieldType(tdf.Fields(I).Type),\n'      Debug.Print tdf.Fields(I).Size,\n'      Debug.Print tdf.Fields(I).Properties(\"Description\")\n   \n   Next\n   Debug.Print \"==========\" ', , \"==========\", \"====\", \"==========\";\n   Debug.Print\n   Debug.Print\n\nTableInfoExit:\ndb.Close\n   Exit Function\n\nTableInfoErrPrint:\n' Needed because a non existing Description within a field always causes an Error\n' and just a \"Resume Next\" would print the following fieldname within the same line\n      \n If err = 3270 Then\n      Debug.Print\n      Resume Next\n Else\n      Debug.Print \"Unerwarteter Fehler : \" & err\n      Resume Next\n End If\n\nTableInfoErr:\nSelect Case err\n   Case 3265   ' Supplied table name invalid\n       MsgBox strTableName & \" table doesn't exist\"\n       Resume TableInfoExit\n   Case Else\n       Debug.Print \"TableInfo() Error \" & err & \": \" & Error\n   End Select\n   End Function\n   \nFunction TableInfoConst(strTableName As String)\n   ' Alison Brown / geändert: KObd\n   ' Purpose: Print in the immediate window the field names, types, and sizes for any table.\n   ' Argument: name of a table in the current database.\n   Dim db As DAO.Database, tdf As DAO.Recordset, i As Integer\n   Dim fldnam As String, fldtyp As String, fldsiz As String, flddes As String\n   Dim prp As Properties\n   Set db = DBEngine(0)(0)\n   On Error GoTo TableInfoErr\n'   Set tdf = db.TableDefs(strTableName)\n   Set tdf = db.OpenRecordset(strTableName, dbOpenDynaset, dbSeeChanges)\n                \n'   If Not AccessEigenschaftEinstellen(tdf, \"Description\", dbText, False) Then\n'       MsgBox \"Adding Description Property to tables did not work\"\n'       Exit Function\n'   End If\n   On Error GoTo TableInfoErrPrint\n   Debug.Print Chr$(39) & \" \" & strTableName\n'   Debug.Print \"FIELD NAME\" ', , \"FIELD TYPE\", \"SIZE\", \"DESCRIPTION\"\n'   Debug.Print \"==========\" ', , \"==========\", \"====\", \"===========\"\n   For i = 0 To tdf.fields.Count - 1\n   \n     fldnam = tdf.fields(i).Name\n     fldtyp = fieldType(tdf.fields(i).Type)\n     fldsiz = tdf.fields(i).Size\n        On Error Resume Next\n     flddes = \"\"\n'     flddes = tdf.Fields(I).Properties(\"Description\")\n        err.clear\n        On Error GoTo TableInfoErrPrint\n          \n     Debug.Print \"Const fn_\" & fldnam & \" AS LONG = \" & i\n'     Debug.Print fldnam, tdf.Fields(i).Type\n'     Debug.Print fldnam   ', ,\n'     Debug.Print i & \" - \" & fldnam   ', ,\n'     Debug.Print fldtyp,\n'     Debug.Print fldsiz,\n'     Debug.Print flddes\n          \n'      Debug.Print tdf.Fields(I).Name,\n'      Debug.Print FieldType(tdf.Fields(I).Type),\n'      Debug.Print tdf.Fields(I).Size,\n'      Debug.Print tdf.Fields(I).Properties(\"Description\")\n   \n   Next\n   Debug.Print Chr$(39) & \"---\"\n'   Debug.Print \"==========\" ', , \"==========\", \"====\", \"==========\";\n   Debug.Print\n   Debug.Print\n\nTableInfoExit:\ndb.Close\n   Exit Function\n\nTableInfoErrPrint:\n' Needed because a non existing Description within a field always causes an Error\n' and just a \"Resume Next\" would print the following fieldname within the same line\n      \n If err = 3270 Then\n      Debug.Print\n      Resume Next\n Else\n      Debug.Print \"Unerwarteter Fehler : \" & err\n      Resume Next\n End If\n\nTableInfoErr:\nSelect Case err\n   Case 3265   ' Supplied table name invalid\n       MsgBox strTableName & \" table doesn't exist\"\n       Resume TableInfoExit\n   Case Else\n       Debug.Print \"TableInfo() Error \" & err & \": \" & Error\n   End Select\n   End Function\n   \nFunction TableInfoMit(strTableName As String)\n   ' Alison Brown / geändert: KObd\n   ' Purpose: Print in the immediate window the field names, types, and sizes for any table.\n   ' Argument: name of a table in the current database.\n   Dim db As DAO.Database, tdf As DAO.Recordset, i As Integer\n   Dim fldnam As String, fldtyp As String, fldsiz As String, flddes As String\n   Dim prp As Properties\n   Set db = DBEngine(0)(0)\n   On Error GoTo TableInfoErr\n'   Set tdf = db.TableDefs(strTableName)\n   Set tdf = db.OpenRecordset(strTableName, dbOpenDynaset, dbSeeChanges)\n                \n'   If Not AccessEigenschaftEinstellen(tdf, \"Description\", dbText, False) Then\n'       MsgBox \"Adding Description Property to tables did not work\"\n'       Exit Function\n'   End If\n   On Error GoTo TableInfoErrPrint\n   Debug.Print strTableName\n   Debug.Print \"ID\", \"FIELD NAME\", \"FIELD TYPE\", \"SIZE\", \"DESCRIPTION\"\n   Debug.Print \"=========\", \"==========\", \"==========\", \"====\", \"===========\"\n   For i = 0 To tdf.fields.Count - 1\n   \n     fldnam = tdf.fields(i).Name\n     fldtyp = fieldType(tdf.fields(i).Type)\n     fldsiz = tdf.fields(i).Size\n        On Error Resume Next\n     flddes = \"\"\n     flddes = tdf.fields(i).Properties(\"Description\")\n        err.clear\n        On Error GoTo TableInfoErrPrint\n          \n     Debug.Print i + 1,\n     Debug.Print fldnam,\n     Debug.Print fldtyp,\n     Debug.Print fldsiz,\n     Debug.Print flddes\n          \n'      Debug.Print tdf.Fields(i).Name,\n'      Debug.Print FieldType(tdf.Fields(i).Type),\n'      Debug.Print tdf.Fields(i).Size,\n'      Debug.Print tdf.Fields(i).Properties(\"Description\")\n'\n   Next\n   Debug.Print \"=========\", \"==========\", \"==========\", \"====\", \"===========\"\n   Debug.Print\n   Debug.Print\n\nTableInfoExit:\ndb.Close\n   Exit Function\n\nTableInfoErrPrint:\n' Needed because a non existing Description within a field always causes an Error\n' and just a \"Resume Next\" would print the following fieldname within the same line\n      \n If err = 3270 Then\n      Debug.Print\n      Resume Next\n Else\n      Debug.Print \"Unerwarteter Fehler : \" & err\n      Resume Next\n End If\n\nTableInfoErr:\nSelect Case err\n   Case 3265   ' Supplied table name invalid\n       MsgBox strTableName & \" table doesn't exist\"\n       Resume TableInfoExit\n   Case Else\n       Debug.Print \"TableInfo() Error \" & err & \": \" & Error\n   End Select\n   End Function\n   \nFunction fieldType(n) As String\n   ' Korrigierte Version\n   ' Purpose: Converts the numeric results of DAO fieldtype to Text.\n   Select Case n\n   Case dbBoolean\n        fieldType = \"Yes/No\"        '1\n   Case dbByte\n        fieldType = \"Byte\"          '2\n   Case dbInteger\n      fieldType = \"Integer\"         '3\n   Case dbLong\n      fieldType = \"Long Integer\"    '4\n   Case dbCurrency\n      fieldType = \"Currency\"        '5\n   Case dbSingle\n      fieldType = \"Single\"          '6\n   Case dbDouble\n      fieldType = \"Double\"          '7\n    Case dbDate\n      fieldType = \"Date/Time\"       '8\n    Case dbText\n      fieldType = \"Text\"            '10\n    Case dbLongBinary\n      fieldType = \"OLE Object\"      '11\n    Case dbMemo\n      fieldType = \"Memo\"            '12\n    Case dbDecimal\n      fieldType = \"Decimal\"         '20\n    Case Else\n      fieldType = \"Unknown Type: \" & n\n   End Select\n   \n   End Function\n\nFunction AccessEigenschaftEinstellen(obj As Object, StrName As String, _\n        intTyp As Integer, varEinstellung As Variant) As Boolean\n    Dim prp As Property\n    Const conEigNichtGef As Integer = 3270\n\n    On Error GoTo FehlerAccessEigenschaftEinstellen\n    ' Explizit auf die Auflistung \"Properties\" verweisen.\n    obj.Properties(StrName) = varEinstellung\n    obj.Properties.Refresh\n    AccessEigenschaftEinstellen = True\n            \nBeendenAccessEigenschaftEinstellen:\n    Exit Function\n\nFehlerAccessEigenschaftEinstellen:\n    If err = conEigNichtGef Then\n        ' Eigenschaft erstellen, Typ festlegen, Anfangswert einstellen.\n        Set prp = obj.CreateProperty(StrName, intTyp, varEinstellung)\n        ' Eigenschaft-Objekt an die Auflistung \"Properties\" anfügen.\n        obj.Properties.append prp\n        obj.Properties.Refresh\n        AccessEigenschaftEinstellen = True\n        Resume BeendenAccessEigenschaftEinstellen\n    Else\n        MsgBox err & \": \" & vbCrLf & err.description\n\nAccessEigenschaftEinstellen = False\n        Resume BeendenAccessEigenschaftEinstellen\n    End If\nEnd Function\n\n\n'---------------------------------------------------------------------------------------\n' Procedure : TSQL_TableDescription\n' Author    : Klaus Oberdalhoff (kobd@gmx.de)\n' Date      : 18.09.2013\n' Purpose   : Erstellen einer T-SQL Datei, die einem die Beschreibung von Tabellenfeldern übernimmt.\n'           : Script erzeugt zuerst ein sp_CreateExtendedProperty und anschliessend nochmal ein\n'           : UpdateExtendedProperty um ggf vorhandene Beschreibungen zu überschreiben\n'           :\n'---------------------------------------------------------------------------------------\n'\nFunction TSQL_TableDescription(sPath As String, Optional InclLinkTables As Boolean = True, Optional MitUpdate As Boolean = True)\nDim db As DAO.Database\nDim rst As DAO.Recordset\nDim dbname As String\nDim handle As Integer\n\nDim strSQL As String\n\n   On Error GoTo tstxx_Error\n\n    CurrentDb.Execute (\"DELETE * FROM _tblTabFelder\")\n    If InclLinkTables Then\n        strSQL = \"Select * From qryMDBTable2 WHERE Type = 1 Or Type = 6;\"\n    Else\n        strSQL = \"Select * From qryMDBTable2 WHERE Type = 1;\"\n    End If\n    \n    Set db = CurrentDb\n    Set rst = db.OpenRecordset(strSQL)\n    With rst\n        Do While Not .EOF\n            If !Type = 1 Then\n                dbname = CurrentDb.Name\n            Else\n                dbname = !Database\n            End If\n            Call TableInfoTab(!objName, dbname)\n            .MoveNext\n        Loop\n        .Close\n    End With\n    \n    strSQL = \"Select * From _tblTabFelder WHERE len(trim(Nz([fldDesc]))) > 0;\"\n    Set rst = db.OpenRecordset(strSQL)\n             \n    handle = FreeFile\n    Open sPath For Output Access Write As #handle\n    \n    ' Tabellenname\n    ' TabFeldname\n    ' FldDesc\n    \n    Print #handle, \"-- ============================================================================================================================\"\n    Print #handle, \"-- == SQLScript (Autor: siegert@consec-nuernberg.de) zur Übernahme der Tabellenfeldbeschreibungen von MS Access - \"\n    Print #handle, \"-- == \" & CurrentDb.Name\n    Print #handle, \"-- == \" & Now()\n    Print #handle, \"-- == Bitte die USE Datenbank anpassen \"\n    Print #handle, \"-- ============================================================================================================================\"\n    Print #handle, \"    \"\n    Print #handle, \"USE  Yourdatase\"\n    Print #handle, \"GO\"\n    Print #handle, \"    \"\n    Print #handle, \"-- ============================================================================================================================\"\n    \n    With rst\n        Do While Not .EOF\n            Print #handle, \"-- ------------------------------------------------------------------------------------\"\n            Print #handle, \"-- Tabelle \" & !Tabellenname & \" -- Feld \" & !TabFeldname\n            Print #handle, \"-- Beschr: \" & !FldDesc\n            Print #handle, \"-- ------------------------------------------------------------------------------------\"\n            Print #handle, \"EXEC sys.sp_addextendedproperty\"\n            Print #handle, \"@name=N'MS_Description',\"\n            Print #handle, \"@value=N'\" & !FldDesc & \"' ,\"\n            Print #handle, \"@level0type=N'SCHEMA',\"\n            Print #handle, \"@level0name=N'dbo',\"\n            Print #handle, \"@level1type=N'TABLE',\"\n            Print #handle, \"@level1name=N'\" & !Tabellenname & \"',\"\n            Print #handle, \"@level2type=N'COLUMN',\"\n            Print #handle, \"@level2name=N'\" & !TabFeldname & \"'\"\n            Print #handle, \"GO\"\n            Print #handle, \"-- ------------------------------------------------------------------------------------\"\n            Print #handle, \" \"\n            .MoveNext\n        Loop\n        \n        If MitUpdate Then\n           \n           .MoveFirst\n            \n            Print #handle, \"-- ============================================================================================================================\"\n            Print #handle, \"-- == Updatescript im Falle die ext. Property existiert    \"\n            Print #handle, \"-- ----------------------------------------------------------------------------------------------------------------------------\"\n            Print #handle, \"-- == SQLScript (Autor: ) zur Übernahme der Tabellenfeldbeschreibungen von MS Access - \"\n            Print #handle, \"-- == \" & CurrentDb.Name\n            Print #handle, \"-- == \" & Now()\n            Print #handle, \"-- ============================================================================================================================\"\n        \n            Do While Not .EOF\n                Print #handle, \"-- ------------------------------------------------------------------------------------\"\n                Print #handle, \"-- Tabelle \" & !Tabellenname & \" -- Feld \" & !TabFeldname\n                Print #handle, \"-- Beschr: \" & !FldDesc\n                Print #handle, \"-- ------------------------------------------------------------------------------------\"\n                Print #handle, \"EXEC sys.sp_updateextendedproperty\"\n                Print #handle, \"@name=N'MS_Description',\"\n                Print #handle, \"@value=N'\" & !FldDesc & \"' ,\"\n                Print #handle, \"@level0type=N'SCHEMA',\"\n                Print #handle, \"@level0name=N'dbo',\"\n                Print #handle, \"@level1type=N'TABLE',\"\n                Print #handle, \"@level1name=N'\" & !Tabellenname & \"',\"\n                Print #handle, \"@level2type=N'COLUMN',\"\n                Print #handle, \"@level2name=N'\" & !TabFeldname & \"'\"\n                Print #handle, \"GO\"\n                Print #handle, \"-- ------------------------------------------------------------------------------------\"\n                Print #handle, \" \"\n                .MoveNext\n            Loop\n            \n        End If\n        \n        .Close\n    End With\n    \n    Close handle\n    Set rst = Nothing\n\n   On Error GoTo 0\n   Exit Function\n\ntstxx_Error:\n\n    MsgBox \"Error \" & err.Number & \" (\" & err.description & \") in procedure TSQL_TableDescription of Modul mdlTstTabField\"\n\nEnd Function\n\n\n'Function ListPK(tbl As String) As String\n''List primary keys for passed table.\n''Must reference ADOX library:\n''Microsoft ADO Ext. 2.8 for DDL and Security.\n'Dim cat As New ADOX.Catalog\n'Dim tblADOX As New ADOX.Table\n'Dim idxADOX As New ADOX.Index\n'Dim colADOX As New ADOX.Column\n'cat.ActiveConnection = CurrentProject.AccessConnection\n'On Error GoTo errHandler\n'For Each tblADOX In cat.Tables\n'    If tblADOX.Name = tbl Then\n'        If tblADOX.Indexes.Count <> 0 Then\n'            For Each idxADOX In tblADOX.Indexes\n'                With idxADOX\n'                    If .PrimaryKey Then\n'                        For Each colADOX In .Columns\n'                            ListPK = colADOX.Name & \", \" & ListPK\n'                        Next\n'                    End If\n'                End With\n'            Next\n'        End If\n'    End If\n'Next\n'If ListPK = \"\" Then\n'    ListPK = \"No primary key\"\n'Else\n'    ListPK = Left(ListPK, Len(ListPK) - 2)\n'End If\n'Set cat = Nothing\n'Set tblADOX = Nothing\n'Set idxADOX = Nothing\n'Set colADOX = Nothing\n'\n'Exit Function\n'errHandler:  MsgBox Err.Number & \": \" & Err.Description, vbOKOnly, _\n'\"Error\"\n'\n'Set cat = Nothing\n'Set tblADOX = Nothing\n'Set idxADOX = Nothing\n'Set colADOX = Nothing\n'End Function\n'\n"}
