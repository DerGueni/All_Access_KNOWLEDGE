{"id":"MOD_zmd_Registry","name":"zmd_Registry","kind":"standard","procedures":["Sub ChangeWebControlFeature()","Function write_reg()","Sub SetWebControlAsIE9()"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"'Option Compare Database\n'Option Explicit\n\n'Private Declare PtrSafe Function CoInternetSetFeatureEnabled Lib \"urlmon.dll\" Alias \"CoInternetSetFeatureEnabledA\" (ByVal FeatureEntry As eINTERNETFEATURELIST, ByVal Flags As eFEATURESetting, ByVal bEnable As Long) As Long\n'Private Declare PtrSafe Function CoInternetIsFeatureEnabled Lib \"urlmon.dll\" Alias \"CoInternetIsFeatureEnabledA\" (ByVal FeatureEntry As eINTERNETFEATURELIST, ByVal Flags As eFEATURESetting) As Long\nPrivate Declare PtrSafe Function CoInternetSetFeatureEnabled Lib \"urlmon.dll\" (ByVal FeatureEntry, ByVal Flags, ByVal bEnable As Long) As Long\nPrivate Declare PtrSafe Function CoInternetIsFeatureEnabled Lib \"urlmon.dll\" (ByVal FeatureEntry, ByVal Flags) As Long\n\n\nSub ChangeWebControlFeature()\n     Dim ret As Long\n     Dim lret As Long\n     \n     SET_FEATURE_ON_PROCESS = \"0x02\"\n     FEATURE_BEHAVIORS = \"0x06\"\n     FEATURE_ZONE_ELEVATION = \"0x01\"\n     FEATURE_RESTRICT_ACTIVEXINSTALL = \"0x0A\"\n     \n     If CoInternetIsFeatureEnabled(FEATURE_BEHAVIORS, SET_FEATURE_ON_PROCESS) <> 0 Then\n         ret = CoInternetSetFeatureEnabled(FEATURE_BEHAVIORS, SET_FEATURE_ON_PROCESS, 1)\n         lret = ret\n     End If\n     If CoInternetIsFeatureEnabled(FEATURE_ZONE_ELEVATION, SET_FEATURE_ON_PROCESS) <> 0 Then\n         ret = CoInternetSetFeatureEnabled(FEATURE_ZONE_ELEVATION, SET_FEATURE_ON_PROCESS, 1)\n         lret = lret + ret\n     End If\n     If CoInternetIsFeatureEnabled(FEATURE_RESTRICT_ACTIVEXINSTALL, SET_FEATURE_ON_PROCESS) <> 0 Then\n          ret = CoInternetSetFeatureEnabled(FEATURE_RESTRICT_ACTIVEXINSTALL, SET_FEATURE_ON_PROCESS, 0)\n         lret = lret + ret\n     End If\n     Debug.Print IIf(lret = 0, \"Features adjusted\", \"Feature adjustment failed\")\nEnd Sub\n\n\n'Registry-Einträge für Webbrowser\nFunction write_reg()\n    Dim oShell As Object\n    \n    Set oShell = CreateObject(\"WScript.Shell\")\n    \n    vRegElement = Array(\"FEATURE_BLOCK_LMZ_SCRIPT\", \"FEATURE_BLOCK_LMZ_OBJECT\", \"FEATURE_BLOCK_LMZ_IMG\")\n    For i = 0 To 2\n         sKey = \"HKEY_CURRENT_USER\\Software\\Microsoft\\\" & _\n             \"Internet Explorer\\Main\\FeatureControl\\\" & _\n             vRegElement(i) & \"\\msaccess.exe\"\n    \n         oShell.RegWrite sKey, 1, \"REG_DWORD\"\n         \n    Next i\n    Set oShell = Nothing\n    \nEnd Function\n\nSub SetWebControlAsIE9()\n    Dim sKey As String\n    Dim oShell As Object\n    Dim vKey As Variant\n    Dim nErr As Long\n    \n    Set oShell = CreateObject(\"WScript.Shell\")\n    \n    sKey = \"HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_BROWSER_EMULATION\\msaccess.exe\"\n    On Error Resume Next\n    vKey = oShell.RegRead(sKey)\n    nErr = err.Number\n    On Error GoTo 0\n    If nErr = -2147024894 Then\n        oShell.RegWrite sKey, 9999, \"REG_DWORD\"\n        Debug.Print \"IE Mode set\"\n    Else\n        If vKey <> 12001 Then 'EDGE\n            oShell.RegWrite sKey, 12001, \"REG_DWORD\" '9999 = IE9\n            Debug.Print \"IE9 Mode set\"\n        Else\n            Debug.Print \"IE Mode is already set\"\n        End If\n    End If\n    Set oShell = Nothing\n    \nEnd Sub\n\n\n\n"}
