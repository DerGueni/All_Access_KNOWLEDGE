{"id":"MOD_Form_frm_Änderungsprotokoll","name":"frm_Änderungsprotokoll","kind":"form_codebehind","source_text":"ÿþVersion =20\nVersionRequired =20\nChecksum =1711542000\nBegin Form\n    RecordSelectors = NotDefault\n    MaxButton = NotDefault\n    MinButton = NotDefault\n    AutoCenter = NotDefault\n    NavigationButtons = NotDefault\n    AllowDeletions = NotDefault\n    AllowAdditions = NotDefault\n    ScrollBars =2\n    BorderStyle =1\n    PictureAlignment =2\n    DatasheetGridlinesBehavior =3\n    GridY =10\n    Width =10204\n    DatasheetFontHeight =10\n    ItemSuffix =18\n    Left =375\n    Top =270\n    Right =14175\n    Bottom =8325\n    DatasheetGridlinesColor =12632256\n    RecSrcDt = Begin\n        0x188e492b0ecee240\n    End\n    GUID = Begin\n        0xa415d41e8ed9844a9a5cdccddc60fdc4\n    End\n    NameMap = Begin\n        0x0acc0e5500000000000000000000000000000000000000000000000000000000 ,\n        0x000000000000000000000000500072006f0074006f006b006f006c006c000000 ,\n        0x0000000000000000000000000000000000000000070000000000000000000000 ,\n        0x0000000000000000700046006f0072006d0075006c00610072004e0061006d00 ,\n        0x6500000000000000000000000000000000000000000000000700000000000000 ,\n        0x000000000000000000000000700044006100740065006e00620061006e006b00 ,\n        0x0000000000000000000000000000000000000000000007000000000000000000 ,\n        0x00000000000000000000700047006500610065006e0064006500720074004100 ,\n        0x6d00000000000000000000000000000000000000000000000700000000000000 ,\n        0x000000000000000000000000700047006500610065006e006400650072007400 ,\n        0x56006f006e000000000000000000000000000000000000000000000007000000 ,\n        0x000000000000000000000000000000007000460065006c0064004e0061006d00 ,\n        0x6500000000000000000000000000000000000000000000000700000000000000 ,\n        0x000000000000000000000000700041006c007400650072005700650072007400 ,\n        0x0000000000000000000000000000000000000000000007000000000000000000 ,\n        0x0000000000000000000070004e00650075006500720057006500720074000000 ,\n        0x0000000000000000000000000000000000000000070000000000000000000000 ,\n        0x0000000000000000700052007500650063006b006700610065006e0067006900 ,\n        0x6700000000000000000000000000000000000000000000000c00000005000000 ,\n        0x0000000000000000000000000000\n    End\n    RecordSource =\"Protokoll\"\n    Caption =\"Änderungsprotokoll:\"\n    DatasheetFontName =\"Arial\"\n    OnLoad =\"[Event Procedure]\"\n    FilterOnLoad =0\n    AllowLayoutView =0\n    DatasheetGridlinesColor12 =12632256\n    NoSaveCTIWhenDisabled =1\n    Begin\n        Begin Label\n            BackStyle =0\n        End\n        Begin CommandButton\n            Width =1701\n            Height =283\n            FontSize =8\n            FontWeight =400\n            ForeColor =-2147483630\n            FontName =\"MS Sans Serif\"\n            BorderLineStyle =0\n        End\n        Begin CheckBox\n            SpecialEffect =2\n            BorderLineStyle =0\n            LabelX =230\n            LabelY =-30\n        End\n        Begin TextBox\n            SpecialEffect =2\n            OldBorderStyle =0\n            BorderLineStyle =0\n            Width =1701\n            LabelX =-1701\n        End\n        Begin FormHeader\n            Height =1417\n            BackColor =-2147483633\n            Name =\"Formularkopf\"\n            GUID = Begin\n                0xaddfafee7ead6f4090b2313c4cb612f1\n            End\n            Begin\n                Begin TextBox\n                    SpecialEffect =5\n                    OverlapFlags =85\n                    TextAlign =1\n                    BackStyle =0\n                    Left =1299\n                    Top =226\n                    Width =4032\n                    Height =226\n                    FontWeight =700\n                    ForeColor =16711680\n                    Name =\"pFormularName\"\n                    ControlSource =\"pFormularName\"\n                    FontName =\"Tahoma\"\n                    GUID = Begin\n                        0x6c00ab26f1d64246aece499339e7a1de\n                    End\n\n                    Begin\n                        Begin Label\n                            OverlapFlags =85\n                            TextAlign =3\n                            Left =226\n                            Top =226\n                            Width =975\n                            Height =240\n                            Name =\"Bezeichnungsfeld2\"\n                            Caption =\"Formular:\"\n                            FontName =\"Tahoma\"\n                            GUID = Begin\n                                0x5bcf1a30c8109844b258a975eefc2879\n                            End\n                        End\n                    End\n                End\n                Begin Label\n                    OverlapFlags =85\n                    TextAlign =2\n                    Left =566\n                    Top =1135\n                    Width =3975\n                    Height =210\n                    FontWeight =700\n                    BackColor =0\n                    Name =\"Bezeichnungsfeld9\"\n                    Caption =\"Änderung am/von:\"\n                    FontName =\"Tahoma\"\n                    GUID = Begin\n                        0x15cedcfa44f99f4a86c2552fab671e68\n                    End\n                End\n                Begin Label\n                    OverlapFlags =85\n                    TextAlign =1\n                    Left =4603\n                    Top =1133\n                    Width =705\n                    Height =210\n                    FontWeight =700\n                    Name =\"Bezeichnungsfeld10\"\n                    Caption =\"Feld:\"\n                    FontName =\"Tahoma\"\n                    GUID = Begin\n                        0xd76d517f98e0ae43a0278cc019fb6508\n                    End\n                End\n                Begin Label\n                    OverlapFlags =85\n                    TextAlign =1\n                    Left =6303\n                    Top =1133\n                    Width =1770\n                    Height =210\n                    FontWeight =700\n                    Name =\"Bezeichnungsfeld11\"\n                    Caption =\"Geändert von:\"\n                    FontName =\"Tahoma\"\n                    GUID = Begin\n                        0x0141749f320e8d4594be762c9b7b2ce8\n                    End\n                End\n                Begin Label\n                    OverlapFlags =85\n                    TextAlign =1\n                    Left =8174\n                    Top =1133\n                    Width =1740\n                    Height =210\n                    FontWeight =700\n                    Name =\"Bezeichnungsfeld12\"\n                    Caption =\"auf:\"\n                    FontName =\"Tahoma\"\n                    GUID = Begin\n                        0x0ba0803be9e7b240b9843096ca2ffd64\n                    End\n                End\n                Begin TextBox\n                    SpecialEffect =5\n                    OverlapFlags =85\n                    TextAlign =1\n                    BackStyle =0\n                    Left =1299\n                    Top =586\n                    Width =8352\n                    Height =226\n                    FontWeight =700\n                    TabIndex =1\n                    ForeColor =16711680\n                    Name =\"pDatenbank\"\n                    ControlSource =\"pDatenbank\"\n                    FontName =\"Tahoma\"\n                    GUID = Begin\n                        0x38615c7edcb2894cb10a60104356be35\n                    End\n\n                    Begin\n                        Begin Label\n                            OverlapFlags =85\n                            TextAlign =3\n                            Left =210\n                            Top =585\n                            Width =990\n                            Height =240\n                            Name =\"Bezeichnungsfeld17\"\n                            Caption =\"Datenbank:\"\n                            FontName =\"Tahoma\"\n                            GUID = Begin\n                                0xabec486f8f7a9c46abfdced2b6cd5d97\n                            End\n                        End\n                    End\n                End\n            End\n        End\n        Begin Section\n            Height =353\n            Name =\"Detailbereich\"\n            GUID = Begin\n                0xd3b489d4e99ee149a93a8eab44944fd1\n            End\n            Begin\n                Begin TextBox\n                    Enabled = NotDefault\n                    Locked = NotDefault\n                    SpecialEffect =0\n                    OverlapFlags =93\n                    TextAlign =2\n                    BackStyle =0\n                    Left =340\n                    Top =56\n                    Width =1926\n                    ColumnWidth =4635\n                    TabIndex =1\n                    Name =\"pGeaendertAm\"\n                    ControlSource =\"pGeaendertAm\"\n                    FontName =\"Tahoma\"\n                    GUID = Begin\n                        0xdfa3eb4d1e68d24ca1d4a6b0d13d275a\n                    End\n\n                End\n                Begin TextBox\n                    Enabled = NotDefault\n                    Locked = NotDefault\n                    SpecialEffect =0\n                    OverlapFlags =85\n                    BackStyle =0\n                    Left =2324\n                    Top =56\n                    Width =2166\n                    Height =225\n                    ColumnWidth =5070\n                    TabIndex =2\n                    Name =\"pGeaendertVon\"\n                    ControlSource =\"pGeaendertVon\"\n                    FontName =\"Tahoma\"\n                    GUID = Begin\n                        0x38d0e500ea89e0468188cb45fc6a0935\n                    End\n\n                End\n                Begin TextBox\n                    Enabled = NotDefault\n                    Locked = NotDefault\n                    SpecialEffect =0\n                    OverlapFlags =85\n                    TextAlign =1\n                    BackStyle =0\n                    Left =4535\n                    Top =56\n                    TabIndex =3\n                    Name =\"pFeldName\"\n                    ControlSource =\"pFeldName\"\n                    FontName =\"Tahoma\"\n                    GUID = Begin\n                        0xc967137ee0f78645a1bd90530714a173\n                    End\n\n                End\n                Begin TextBox\n                    Locked = NotDefault\n                    EnterKeyBehavior = NotDefault\n                    SpecialEffect =0\n                    OverlapFlags =85\n                    TextAlign =1\n                    BackStyle =0\n                    Left =6338\n                    Top =56\n                    Width =1656\n                    Height =243\n                    ColumnWidth =2055\n                    TabIndex =4\n                    Name =\"pAlterWert\"\n                    ControlSource =\"pAlterWert\"\n                    FontName =\"Tahoma\"\n                    GUID = Begin\n                        0x563f5f56b28a424e869aec2ba651ec26\n                    End\n\n                End\n                Begin TextBox\n                    Locked = NotDefault\n                    EnterKeyBehavior = NotDefault\n                    SpecialEffect =0\n                    OverlapFlags =85\n                    TextAlign =1\n                    BackStyle =0\n                    Left =8220\n                    Top =56\n                    Width =1656\n                    Height =228\n                    ColumnWidth =2730\n                    TabIndex =5\n                    Name =\"pNeuerWert\"\n                    ControlSource =\"pNeuerWert\"\n                    FontName =\"Tahoma\"\n                    GUID = Begin\n                        0xbd587233fb1dc94aa8409949327dc3d1\n                    End\n\n                End\n                Begin CheckBox\n                    OverlapFlags =247\n                    Left =113\n                    Top =113\n                    Name =\"pRueckgaengig\"\n                    ControlSource =\"pRueckgaengig\"\n                    DefaultValue =\"No\"\n                    GUID = Begin\n                        0xcb07d2dbfea81142af176367ee0712e6\n                    End\n\n                End\n            End\n        End\n        Begin FormFooter\n            Height =566\n            BackColor =-2147483633\n            Name =\"Formularfuß\"\n            GUID = Begin\n                0xd9f65b9937d8624994c4e0afbe9c69d3\n            End\n            Begin\n                Begin CommandButton\n                    OverlapFlags =85\n                    Left =8787\n                    Top =113\n                    Width =1369\n                    Height =400\n                    FontWeight =700\n                    Name =\"btnDone\"\n                    Caption =\"Schließen\"\n                    OnClick =\"[Event Procedure]\"\n                    FontName =\"Tahoma\"\n                    GUID = Begin\n                        0xd367cc75f320ff4591a95ba4ce5cd8b9\n                    End\n\n                    WebImagePaddingLeft =2\n                    WebImagePaddingTop =2\n                    WebImagePaddingRight =1\n                    WebImagePaddingBottom =1\n                End\n                Begin CommandButton\n                    OverlapFlags =85\n                    Left =7256\n                    Top =113\n                    Width =1417\n                    Height =400\n                    TabIndex =1\n                    Name =\"btnUndo\"\n                    Caption =\"Rückgängig!\"\n                    OnClick =\"[Event Procedure]\"\n                    FontName =\"Tahoma\"\n                    GUID = Begin\n                        0x9cc6c8d180a4b8418c524ca19e9791a2\n                    End\n\n                    WebImagePaddingLeft =2\n                    WebImagePaddingTop =2\n                    WebImagePaddingRight =1\n                    WebImagePaddingBottom =1\n                End\n                Begin CommandButton\n                    OverlapFlags =85\n                    Left =56\n                    Top =113\n                    Width =2092\n                    Height =400\n                    TabIndex =2\n                    Name =\"btnDSLöschungen\"\n                    Caption =\"Datensatzlöschungen\"\n                    OnClick =\"[Event Procedure]\"\n                    FontName =\"Tahoma\"\n                    GUID = Begin\n                        0xb88283bf4ad0a94182c691a7aa73c73d\n                    End\n\n                    WebImagePaddingLeft =2\n                    WebImagePaddingTop =2\n                    WebImagePaddingRight =1\n                    WebImagePaddingBottom =1\n                End\n            End\n        End\n    End\nEnd\nCodeBehindForm\nAttribute VB_GlobalNameSpace = False\nAttribute VB_Creatable = True\nAttribute VB_PredeclaredId = True\nAttribute VB_Exposed = False\nOption Compare Database\nOption Explicit\n\nDim f As Form\nDim rs As DAO.Recordset\n\n\nPrivate Sub btnDone_Click()\n\n  On Error Resume Next\n  DoCmd.Close acForm, Me.Name, acSavePrompt\n  \nEnd Sub\n\nPrivate Sub btnDSLöschungen_Click()\n\n  On Error Resume Next\n  DoCmd.OpenForm \"Datensatzlöschungen\", acNormal, , \"[pFormularName]= '\" & f.Name & \"'\", acFormReadOnly, acDialog\n  \nEnd Sub\n\nPrivate Sub btnUndo_Click()\n  Dim rs As DAO.Recordset\n  Dim lngAnz As Long, i As Long\n  Dim strField As String, varValue As Variant\n  \n  On Error Resume Next\n  DoCmd.RunCommand acCmdSaveRecord\n  Set rs = Me.RecordsetClone\n  rs.MoveLast\n  lngAnz = rs.RecordCount\n  rs.MoveFirst\n  For i = 1 To lngAnz\n    If rs(\"pRueckgaengig\") Then\n      strField = rs(\"pFeldName\")\n      varValue = rs(\"pAlterWert\")\n      f.controls(strField).Value = varValue\n    End If\n    rs.MoveNext\n  Next i\n  rs.Close\n  Set rs = Nothing\n  Beep\n  MsgBox \"Änderungen wurden rückgängig gemacht!\", _\n         vbOKOnly + vbInformation, \"Rückgängig:\"\n  DoCmd.Close acForm, Me.Name, acSavePrompt\n  \nEnd Sub\n\nPrivate Sub Form_Load()\n\n  Dim strSQL As String\n  Dim lngNumRecs As Long, i As Long\n  Dim strID As String, strDB As String\n  Dim ctl As control\n  \n  On Error Resume Next\n  Set f = Screen.ActiveForm 'Globale Variable\n  If err <> 0 Then\n    Beep\n    MsgBox \"Kein Formular geöffnet!\", _\n           vbOKOnly + vbExclamation, \"Änderungsprotokoll:\"\n    DoCmd.Close acForm, Me.Name, acSavePrompt\n    GoTo Exit_Proc\n  End If\n\n  strID = \"\"\n  For Each ctl In f.controls\n    If ctl.TAG = \"DSID\" Then\n      strID = strID & CStr(ctl.Value)\n    End If\n  Next ctl\n  If strID = \"\" Then\n    Beep\n    MsgBox \"Kein Feld als 'DSID' gekennzeichnet!\", _\n           vbOKOnly + vbExclamation, \"Änderungsprotokoll:\"\n    DoCmd.Close acForm, Me.Name, acSavePrompt\n    GoTo Exit_Proc\n  End If\n  \n  DoCmd.SetWarnings False\n  DoCmd.RunSQL \"UPDATE Protokoll SET Protokoll.pRueckgaengig = No;\", False\n  DoCmd.SetWarnings True\n  \n  strDB = CurrentDb.Name\n  strSQL = \"select * from [Protokoll] where [pDatenbank]= '\" & _\n           strDB & \"' and [pFormularName]= '\" & _\n           f.Name & \"' and [pDSID]= '\" & _\n           strID & \"' order by pGeaendertAm desc;\"\n  Me.recordSource = strSQL\n  \n  err = 0\n  Set rs = Me.RecordsetClone\n  rs.MoveLast\n  lngNumRecs = rs.RecordCount\n  If err <> 0 Or lngNumRecs = 0 Then\n    Beep\n    MsgBox \"Es sind keine Änderungen für diesen Datensatz protokolliert!\" & vbCrLf & vbCrLf & _\n           \"Datenbank: \" & strDB & vbCrLf & _\n           \"Formular: \" & f.Name, _\n           vbOKOnly + vbExclamation, \"Änderungsprotokoll:\"\n    rs.Close\n    Set rs = Nothing\n    DoCmd.Close acForm, Me.Name, acSavePrompt\n    GoTo Exit_Proc\n  End If\n  rs.MoveFirst\n  \nExit_Proc:\n  DoEvents\n  err.clear\n\nEnd Sub"}
