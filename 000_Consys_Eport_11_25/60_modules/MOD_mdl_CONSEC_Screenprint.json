{"id":"MOD_mdl_CONSEC_Screenprint","name":"mdl_CONSEC_Screenprint","kind":"standard","procedures":["Function Monatsdruck_Steuer()"],"calls":{"DoCmd.OpenForm":["frm_UE_Uebersicht"],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n\n'Public Function WoUmsch(iums As Long)  '' 1 = Tag    2 = Woche    3 = Monat\n'Public Function SetStartdatum(dt As Date)\n'Public Function Button_Next()\n'Public Function Button_Prev()\n'Public Function ScreenPrint()\n\nFunction Monatsdruck_Steuer()\nDim dt As Date\nDim strSQL As String\nDim Ueber_Pfad As String\n\nUeber_Pfad = Get_Priv_Property(\"prp_CONSYS_GrundPfad\") & Nz(TLookup(\"Pfad\", \"_tblEigeneFirma_Pfade\", \"ID = 8\"))\n\nSendKeys \"{F11}\"\nDoCmd.OpenForm \"frm_UE_Uebersicht\"\nDoEvents\nSleep 1000\nDoEvents\nForm_frm_UE_Uebersicht.ScreenPrint\nDoEvents\nSleep 1000\nDoEvents\nCall Form_frm_UE_Uebersicht.WoUmsch(1)  '' 1 = Tag    2 = Woche    3 = Monat\nDoEvents\nSleep 1000\nDoEvents\nForm_frm_UE_Uebersicht.ScreenPrint\nDoEvents\nSleep 1000\nDoEvents\nForm_frm_UE_Uebersicht.ScreenPrint\nDoEvents\nSleep 1000\nDoEvents\nCall Form_frm_UE_Uebersicht.WoUmsch(3)  '' 1 = Tag    2 = Woche    3 = Monat\nDoEvents\nSleep 1000\nDoEvents\nForm_frm_UE_Uebersicht.ScreenPrint\nDoEvents\nSleep 1000\nDoEvents\nDoCmd.Close acForm, \"frm_UE_Uebersicht\", acSaveNo\nDoEvents\nSleep 1000\nSendKeys \"{F11}\"\nDoEvents\nDBEngine.Idle dbRefreshCache\nDBEngine.Idle dbFreeLocks\nDoEvents\n'DoCmd.Quit acQuitSaveNone\n\nstrSQL = \"\"\nstrSQL = strSQL & \"SELECT tbl_VA_AnzTage.VADatum, tbl_VA_AnzTage.ID AS VADatum_ID, tbl_VA_Auftragstamm.*\"\nstrSQL = strSQL & \" FROM tbl_VA_Auftragstamm LEFT JOIN tbl_VA_AnzTage ON tbl_VA_Auftragstamm.ID = tbl_VA_AnzTage.VA_ID\"\nstrSQL = strSQL & \" WHERE  (((tbl_VA_AnzTage.VADatum) Between Date() And Date()+6))\"\nstrSQL = strSQL & \" ORDER BY tbl_VA_Auftragstamm.Dat_VA_Von, tbl_VA_Auftragstamm.Auftrag;\"\nCreateQuery strSQL, \"qry_Report_Auftrag_Sort\"\n\nDoCmd.OutputTo acOutputReport, \"rpt_Auftrag\", \"PDF\", Ueber_Pfad & \"W_\" & Date & \".pdf\"\nDoEvents\nSleep 1000\nDoEvents\nstrSQL = \"\"\nstrSQL = strSQL & \" SELECT tbl_VA_AnzTage.VADatum, tbl_VA_AnzTage.ID AS VADatum_ID, tbl_VA_Auftragstamm.*\"\nstrSQL = strSQL & \" FROM tbl_VA_Auftragstamm LEFT JOIN tbl_VA_AnzTage ON tbl_VA_Auftragstamm.ID = tbl_VA_AnzTage.VA_ID\"\nstrSQL = strSQL & \" ORDER BY tbl_VA_Auftragstamm.Dat_VA_Von, tbl_VA_Auftragstamm.Auftrag;\"\nCreateQuery strSQL, \"qry_Report_Auftrag_Sort\"\n\nDoEvents\nDBEngine.Idle dbRefreshCache\nDBEngine.Idle dbFreeLocks\nDoEvents\n\nEnd Function"}
