{"id":"MOD_mdlPrivProperty","name":"mdlPrivProperty","kind":"standard","procedures":["Function Set_Priv_Property(ByVal PropertyName As String, ByVal PropertyWert As String, Optional ByVal PropLogin As String = \"All\")","Sub CreateTabletblProperty()","Function Get_Priv_Property(ByVal PropertyName As String, Optional ByVal PropLogin As String = \"All\")","Function Del_Priv_Property(ByVal PropertyName As String, Optional ByVal PropLogin As String = \"All\")","Function Get_All_Priv_Property()","Private Function ObjectExists(strObjectType As String, strObjectName As String) As Boolean"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n\nFunction Set_Priv_Property(ByVal PropertyName As String, ByVal PropertyWert As String, Optional ByVal PropLogin As String = \"All\")\n' Ideal um Einzelwerte in der Datenbank zu speichern\n\nIf Len(Trim(Nz(PropLogin))) = 0 Then\n    PropLogin = \"All\"\nEnd If\n\nDim SQLStr As String\n               \nOn Error Resume Next\n\n'Nicht standardmäßig ausführen, da Tabelle in Backend ...\n'Call CreateTabletblProperty\n\nIf Len(Trim(Nz(PropertyName))) = 0 Then Exit Function\nPropertyWert = Nz(PropertyWert)\n\n    If TCount(\"PropName\", \"_tblProperty\", \"[PropName] = '\" & PropertyName & \"' AND [PropUser] = '\" & PropLogin & \"'\") > 0 Then\n        SQLStr = \"UPDATE _tblProperty SET [_tblProperty].PropUser = '\" & PropLogin & \"', [_tblProperty].PropName = '\" & PropertyName & \"', [_tblProperty].PropInhalt = '\" & fCnvQM(PropertyWert) & \"' WHERE ((([_tblProperty].PropName)='\" & PropertyName & \"' AND [PropUser] = '\" & PropLogin & \"'));\"\n    Else\n        SQLStr = \"INSERT INTO _tblProperty ( PropName, PropUser, PropInhalt ) SELECT '\" & PropertyName & \"' AS Ausdr1, '\" & PropLogin & \"' As Ausdr3, '\" & fCnvQM(PropertyWert) & \"' AS Ausdr2;\"\n    End If\n\n    CurrentDb.Execute (SQLStr)\nEnd Function\n\nSub CreateTabletblProperty()\n\nIf Not ObjectExists(\"Table\", \"_tblProperty\") Then\n    CurrentDb.Execute (\"CREATE TABLE _tblProperty (PropName TEXT(50), PropUser TEXT(50), CONSTRAINT PrimKey PRIMARY KEY (PropName ,PropUser), PropInhalt MEMO);\")\nEnd If\n\nEnd Sub\n\n\nFunction Get_Priv_Property(ByVal PropertyName As String, Optional ByVal PropLogin As String = \"All\")\n\nOn Error Resume Next\n\nIf Len(Trim(Nz(PropLogin))) = 0 Then\n    PropLogin = \"All\"\nEnd If\n\nIf Len(Trim(Nz(PropertyName))) = 0 Then Exit Function\nGet_Priv_Property = Nz(TLookup(\"PropInhalt\", \"_tblProperty\", \"[PropName] = '\" & PropertyName & \"' AND PropUser = '\" & PropLogin & \"'\"))\nEnd Function\n\n\nFunction Del_Priv_Property(ByVal PropertyName As String, Optional ByVal PropLogin As String = \"All\")\n\nDim SQLStr As String\n\nIf Len(Trim(Nz(PropLogin))) = 0 Then\n    PropLogin = \"All\"\nEnd If\n\nOn Error Resume Next\n\nIf Len(Trim(Nz(PropertyName))) = 0 Then Exit Function\n\nSQLStr = \"DELETE * FROM _tblProperty WHERE ((([_tblProperty].PropName)='\" & PropertyName & \"' AND PropUser = ' & PropLogin & \" '));\"\n\nCurrentDb.Execute (SQLStr)\n\nEnd Function\n\n\nFunction Get_All_Priv_Property()\nDim db As DAO.Database, i, Y As Integer\nSet db = DBEngine(0)(0)\nY = db.Properties.Count - 1\nOn Error Resume Next\n'ReDim X(Y)\n'ReDim XX(Y)\n    \nFor i = 0 To Y\n'    X(I) = db.Properties(I).Inherited\n'    XX(I) = db.Properties(I).Name\n    Debug.Print db.Properties(i).Name & \" = \" & db.Properties(i) '& \" \" & db.Properties(i).Inherited\nNext i\n\nEnd Function\n\nPrivate Function ObjectExists(strObjectType As String, strObjectName As String) As Boolean\n' Pass the Object type: Table, Query, Form, Report, Macro, or Module\n' Pass the Object Name\n     Dim db As DAO.Database\n     Dim tbl As TableDef\n     Dim QRY As QueryDef\n     Dim i As Integer\n     \n     Set db = CurrentDb()\n     ObjectExists = False\n     \n     If strObjectType = \"Table\" Then\n          For Each tbl In db.TableDefs\n               If tbl.Name = strObjectName Then\n                    ObjectExists = True\n                    Set db = Nothing\n                    Exit Function\n               End If\n          Next tbl\n     ElseIf strObjectType = \"Query\" Then\n          For Each QRY In db.QueryDefs\n               If QRY.Name = strObjectName Then\n                    ObjectExists = True\n                    Set db = Nothing\n                    Exit Function\n               End If\n          Next QRY\n     ElseIf strObjectType = \"Form\" Or strObjectType = \"Report\" Or strObjectType = \"Module\" Then\n          For i = 0 To db.Containers(strObjectType & \"s\").Documents.Count - 1\n               If db.Containers(strObjectType & \"s\").Documents(i).Name = strObjectName Then\n                    ObjectExists = True\n                    Set db = Nothing\n                    Exit Function\n               End If\n          Next i\n     ElseIf strObjectType = \"Macro\" Then\n          For i = 0 To db.Containers(\"Scripts\").Documents.Count - 1\n               If db.Containers(\"Scripts\").Documents(i).Name = strObjectName Then\n                    ObjectExists = True\n                    Set db = Nothing\n                    Exit Function\n               End If\n          Next i\n     Else\n          MsgBox \"Invalid Object Type passed, must be Table, Query, Form, Report, Macro, or Module\"\n     End If\n\nSet db = Nothing\n     \nEnd Function"}
