{"id":"MOD_mduATM","name":"mduATM","kind":"standard","procedures":["Public Function actLanguage() As Long","Public Function MsgTxt(TextunitID As Long, Language As Long, Sound As Byte, ParamArray varText()) As String","Public Sub objLabeling(Optional obj As Object, Optional Language As Byte)","Private Sub Labeling(obj As Object, Language As Byte, Optional subForm As Boolean)","Public Function GetOfficeLanguageID() As Long","Public Function GetOfficeLanguage() As Long","Private Sub ShowError(description As String, Number As Long)"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n\n'**********************************************************************************************************************************************\n'*  Module created by Jean Pierre Allain\n'*  Copyright (c) by ABISS GmbH, www.abiss.de\n'*  Code is allowed to be copied and distributed as long as there exist a legal key for the ATM\n'**********************************************************************************************************************************************\n\nPublic Function actLanguage() As Long\n    actLanguage = 1\n    On Error Resume Next\n    actLanguage = Forms![frmOptions]![Language]\n    err.clear\nEnd Function\n\nPublic Function MsgTxt(TextunitID As Long, Language As Long, Sound As Byte, ParamArray varText()) As String\n    Dim rs As Object, i As Integer, tmp As String\n    On Error GoTo ErrHandling\n    If Language = 0 Then Language = actLanguage()\n    Set rs = CodeDb.OpenRecordset(\"SELECT sysTextunit.ID, sysText.Wording FROM sysText INNER JOIN sysTextunit ON sysText.ID = sysTextunit.TextID WHERE sysTextunit.LanguageID = \" & Language & \" And sysTextunit.ID = \" & TextunitID, 4) 'dbOpenSnapshot)\n    If rs.EOF Then\n        Beep\n        MsgBox \"TextunitID \" & TextunitID & \" was not found!\", vbCritical, \"Message error\"\n        MsgTxt = \"!no text!\"\n    Else\n        tmp = rs(\"Wording\") & \"\"\n        For i = 0 To UBound(varText)\n            varText(i) = Replace(varText(i), \"|\", Chr(254), , 1)\n            tmp = Replace(tmp, \"|\", varText(i), , 1)\n        Next\n        tmp = Replace(tmp, \"|\", \"\")\n        tmp = Replace(tmp, Chr(254), \"|\")\n        MsgTxt = tmp\n    End If\n    For i = 1 To Sound\n        Beep\n    Next\n\nLeave:\n    On Error Resume Next\n    rs.Close\n    Set rs = Nothing\n    Exit Function\n    \nErrHandling:\n    ShowError err.description, err.Number\n    Resume Leave\nEnd Function\n\nPublic Sub objLabeling(Optional obj As Object, Optional Language As Byte)\n    If Language = 0 Then Language = actLanguage()\n    If obj Is Nothing Then\n        For Each obj In Forms\n            If Not obj.CurrentView = 0 Then Labeling obj, Language, True\n        Next\n        For Each obj In Reports\n            If Not obj.CurrentView = 0 Then Labeling obj, Language, True\n        Next\n    Else\n        Labeling obj, Language\n    End If\nEnd Sub\n\nPrivate Sub Labeling(obj As Object, Language As Byte, Optional subForm As Boolean)\n    Dim rs As Object, tmp As String, tmpOBJ As Object\n    If subForm Then\n        On Error Resume Next\n        obj.INI\n        For Each tmpOBJ In obj.controls\n            If TypeName(tmpOBJ) = \"SubForm\" Then Labeling tmpOBJ.Form, Language, True\n        Next\n    End If\n    On Error GoTo ErrHandling\n    Set rs = CodeDb.OpenRecordset(\"SELECT sysTextunitObject.*, sysText.Wording, sysTextunit.LanguageID FROM sysText RIGHT JOIN (sysTextunit RIGHT JOIN sysTextunitObject ON sysTextunit.ID = sysTextunitObject.TextunitID) ON sysText.ID = sysTextunit.TextID WHERE Not ObjecttypeID=6 AND (sysTextunit.LanguageID=\" & Language & \" OR sysTextunit.LanguageID Is Null) AND Formularname = \"\"\" & obj.Name & \"\"\"\", 8) 'dbOpenForwardOnly)\n    Do Until rs.EOF\n        If rs(\"ObjecttypeID\") < 100 Then\n            Set tmpOBJ = obj\n        Else\n            Set tmpOBJ = obj.controls(rs(\"Objectname\"))\n        End If\n        tmp = rs(\"Prefix\") & rs(\"Wording\") & rs(\"Suffix\") & \"\"\n        If IsNull(rs(\"textunitID\")) Then\n            If tmp = \"\" And Not tmpOBJ.Properties(rs(\"prpName\")) = \"\" Then tmp = \"***\" & tmpOBJ.Properties(rs(\"prpName\"))\n        Else\n            If IsNull(rs(\"Wording\")) And Not tmpOBJ.Properties(rs(\"prpName\")) = \"\" Then\n                tmp = \"***\" & tmpOBJ.Properties(rs(\"prpName\"))\n            End If\n        End If\n        tmpOBJ.Properties(rs(\"prpName\")) = tmp\nNextItem:\n        rs.MoveNext\n    Loop\n\nLeave:\n    On Error Resume Next\n    rs.Close\n    Set rs = Nothing\n    Exit Sub\n    \nErrHandling:\n    If err.Number = 2455 Or err.Number = 2465 Or err.Number = 2485 Or err.Number = 7794 Or err.Number = 438 Then Resume NextItem\n    ShowError err.description, err.Number\n    Resume Leave\nEnd Sub\n\nPublic Function GetOfficeLanguageID() As Long\n    Dim rs As Object\n    On Error GoTo ErrHandling\n    GetOfficeLanguageID = 1\n    Set rs = CodeDb.OpenRecordset(\"SELECT sysOfficeLanguage.*, sysLanguage.IsBasic FROM sysLanguage INNER JOIN sysOfficeLanguage ON sysLanguage.ID = sysOfficeLanguage.LanguageID\", 4) 'dbOpenSnapshot)\n    rs.FindFirst \"OfficeLanguageID=\" & GetOfficeLanguage()\n    If Not rs.NoMatch Then\n        If Not rs(\"LanguageID\") = 0 Then GetOfficeLanguageID = rs(\"LanguageID\")\n    Else\n        rs.FindFirst \"IsBasic=True\"\n        If Not rs.NoMatch Then GetOfficeLanguageID = rs(\"LanguageID\")\n    End If\n    \nLeave:\n    On Error Resume Next\n    rs.Close\n    Set rs = Nothing\n    Exit Function\n    \nErrHandling:\n    ShowError err.description, err.Number\n    Resume Leave\nEnd Function\n\nPublic Function GetOfficeLanguage() As Long\n    On Error Resume Next\n    GetOfficeLanguage = LanguageSettings.LanguageID(2)\nEnd Function\n    \nPrivate Sub ShowError(description As String, Number As Long)\n    Beep\n    MsgBox description, vbCritical, \"Error \" & Number\nEnd Sub\n"}
