{"id":"MOD_zmd_Barcode","name":"zmd_Barcode","kind":"standard","procedures":["Public Function utf16to8(ByVal Text As String) As String"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"' Barcode symbol creation in MS office Access reports by VBA\n' Author: alois zingl\n' Version: V1.2 feb 2016\n' Copyright: Free and open-source software\n' http://members.chello.at/~easyfilter/barcode.html\n'\n' Description: the indention of this library is a short and compact implementation to create barcodes\n'  of Code 128, Data Matrix, (micro) QR or Aztec symbols so it could be easily adapted for individual requirements.\n'  Each TextBox in reports containing 'Aztec','Code128', 'DataMatrix' or 'QRCode' in the name\n'  is replaced by the corresponding barcode image.\n'  Individual settings are possible but require adjustments in the Sub Detail_Format().\n'  The smallest bar code symbol fitting the data is automatically selected,\n'  but no size optimization for mixed data types in one code is done.\n' Functions:\n'   drawAztec(text as TextBox, Optional security as integer, Optional layers as integer)\n'   drawCode128(text As TextBox)\n'   drawDataMatrix(text As TextBox)\n'   drawQuickResponse(text As TextBox, Optional level As String, Optional version As Integer = 1)\n'\nOption Explicit\n\n' convert UTF-16 (Windows) to UTF-8\nPublic Function utf16to8(ByVal Text As String) As String\nDim i As Integer, c As Long\nutf16to8 = Text\nFor i = Len(Text) To 1 Step -1\n    c = AscW(Mid(Text, i, 1)) And 65535\n    If c > 127 Then\n        If c > 4095 Then\n            utf16to8 = Left(utf16to8, i - 1) + Chr(224 + c \\ 4096) + Chr(128 + (c \\ 64 And 63)) + Chr(128 + (c And 63)) & Mid(utf16to8, i + 1)\n        Else\n            utf16to8 = Left(utf16to8, i - 1) + Chr(192 + c \\ 64) + Chr(128 + (c And 63)) & Mid(utf16to8, i + 1)\n        End If\n    End If\nNext i\nEnd Function"}
