{"id":"MOD_zmd_MD5","name":"zmd_MD5","kind":"standard","procedures":["Sub Starten()","Private Function MD5Round(strRound As String, a As Long, b As Long, _","Private Function MD5Rotate(lngValue As Long, lngBits As Long) As Long","Private Function TRID() As String","Private Function MD564Split(lngLength As Long, bytBuffer() As Byte) As String","Private Function MD5StringArray(strInput As String) As Byte()","Private Sub MD5Conversion(bytBuffer() As Byte)","Private Function MD5LongAdd(lngVal1 As Long, lngVal2 As Long) As Long","Private Function MD5LongAdd4(lngVal1 As Long, lngVal2 As Long, _","Private Sub MD5Decode(intLength As Integer, lngOutBuffer() As Long, _","Private Function MD5LongConversion(dblValue As Double) As Long","Private Sub MD5Finish()","Private Function MD5StringChange(lngnum As Long) As String","Private Function MD5Value() As String","Public Function FnsCalculateMD5(strMessage As String) As String","Private Sub MD5Start()"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\n\nOption Explicit\n\nPrivate lngTrack As Long\nPrivate arrLongConversion(4) As Long\nPrivate arrSplit64(63) As Byte\n\nPrivate Const OFFSET_4 = 4294967296#\nPrivate Const MAXINT_4 = 2147483647\n\nPrivate Const S11 = 7\nPrivate Const S12 = 12\nPrivate Const S13 = 17\nPrivate Const S14 = 22\nPrivate Const S21 = 5\nPrivate Const S22 = 9\nPrivate Const S23 = 14\nPrivate Const S24 = 20\nPrivate Const S31 = 4\nPrivate Const S32 = 11\nPrivate Const S33 = 16\nPrivate Const S34 = 23\nPrivate Const S41 = 6\nPrivate Const S42 = 10\nPrivate Const S43 = 15\nPrivate Const S44 = 21\n\n\n'Funktionsaufruf\nSub Starten()\n\nDebug.Print FnsCalculateMD5(\"String\")\n\nEnd Sub\n\n\nPrivate Function MD5Round(strRound As String, a As Long, b As Long, _\n                          c As Long, d As Long, X As Long, s As Long, _\n                          ac As Long) As Long\n    Select Case strRound\n      Case Is = \"FF\"\n        a = MD5LongAdd4(a, (b And c) Or (Not (b) And d), X, ac)\n        a = MD5Rotate(a, s)\n        a = MD5LongAdd(a, b)\n      Case Is = \"GG\"\n        a = MD5LongAdd4(a, (b And d) Or (c And Not (d)), X, ac)\n        a = MD5Rotate(a, s)\n        a = MD5LongAdd(a, b)\n      Case Is = \"HH\"\n        a = MD5LongAdd4(a, b Xor c Xor d, X, ac)\n        a = MD5Rotate(a, s)\n        a = MD5LongAdd(a, b)\n      Case Is = \"II\"\n        a = MD5LongAdd4(a, c Xor (b Or Not (d)), X, ac)\n        a = MD5Rotate(a, s)\n        a = MD5LongAdd(a, b)\n    End Select\nEnd Function\n\nPrivate Function MD5Rotate(lngValue As Long, lngBits As Long) As Long\n    Dim lngSign As Long\n    Dim lngI As Long\n    \n    lngBits = (lngBits Mod 32)\n    If lngBits = 0 Then MD5Rotate = lngValue: Exit Function\n    For lngI = 1 To lngBits\n        lngSign = lngValue And &HC0000000\n        lngValue = (lngValue And &H3FFFFFFF) * 2\n        lngValue = lngValue Or ((lngSign < 0) And 1) Or _\n                   (CBool(lngSign And &H40000000) And &H80000000)\n    Next\n    MD5Rotate = lngValue\nEnd Function\n\nPrivate Function TRID() As String\n    Dim sngNum As Single, lngnum As Long\n    Dim strResult As String\n    \n    sngNum = Rnd(2147483648#)\n    strResult = CStr(sngNum)\n    strResult = Replace(strResult, \"0.\", \"\")\n    strResult = Replace(strResult, \".\", \"\")\n    strResult = Replace(strResult, \"E-\", \"\")\n    TRID = strResult\nEnd Function\n\nPrivate Function MD564Split(lngLength As Long, bytBuffer() As Byte) As String\n    Dim lngBytesTotal As Long, lngBytesToAdd As Long\n    Dim intLoop As Integer, intLoop2 As Integer, lngTrace As Long\n    Dim intInnerLoop As Integer, intLoop3 As Integer\n    \n    lngBytesTotal = lngTrack Mod 64\n    lngBytesToAdd = 64 - lngBytesTotal\n    lngTrack = (lngTrack + lngLength)\n    If lngLength >= lngBytesToAdd Then\n        For intLoop = 0 To lngBytesToAdd - 1\n            arrSplit64(lngBytesTotal + intLoop) = bytBuffer(intLoop)\n        Next intLoop\n        MD5Conversion arrSplit64\n        lngTrace = (lngLength) Mod 64\n        For intLoop2 = lngBytesToAdd To lngLength - intLoop - lngTrace Step 64\n            For intInnerLoop = 0 To 63\n                arrSplit64(intInnerLoop) = bytBuffer(intLoop2 + intInnerLoop)\n            Next intInnerLoop\n            MD5Conversion arrSplit64\n        Next intLoop2\n        lngBytesTotal = 0\n      Else\n        intLoop2 = 0\n    End If\n    For intLoop3 = 0 To lngLength - intLoop2 - 1\n        arrSplit64(lngBytesTotal + intLoop3) = bytBuffer(intLoop2 + intLoop3)\n    Next intLoop3\nEnd Function\n\nPrivate Function MD5StringArray(strInput As String) As Byte()\n    Dim intLoop As Integer\n    Dim bytBuffer() As Byte\n    ReDim bytBuffer(Len(strInput))\n    \n    For intLoop = 0 To Len(strInput) - 1\n        bytBuffer(intLoop) = Asc(Mid(strInput, intLoop + 1, 1))\n    Next intLoop\n    MD5StringArray = bytBuffer\nEnd Function\n\nPrivate Sub MD5Conversion(bytBuffer() As Byte)\n    Dim X(16) As Long, a As Long\n    Dim b As Long, c As Long\n    Dim d As Long\n    \n    a = arrLongConversion(1)\n    b = arrLongConversion(2)\n    c = arrLongConversion(3)\n    d = arrLongConversion(4)\n    MD5Decode 64, X, bytBuffer\n    MD5Round \"FF\", a, b, c, d, X(0), S11, -680876936\n    MD5Round \"FF\", d, a, b, c, X(1), S12, -389564586\n    MD5Round \"FF\", c, d, a, b, X(2), S13, 606105819\n    MD5Round \"FF\", b, c, d, a, X(3), S14, -1044525330\n    MD5Round \"FF\", a, b, c, d, X(4), S11, -176418897\n    MD5Round \"FF\", d, a, b, c, X(5), S12, 1200080426\n    MD5Round \"FF\", c, d, a, b, X(6), S13, -1473231341\n    MD5Round \"FF\", b, c, d, a, X(7), S14, -45705983\n    MD5Round \"FF\", a, b, c, d, X(8), S11, 1770035416\n    MD5Round \"FF\", d, a, b, c, X(9), S12, -1958414417\n    MD5Round \"FF\", c, d, a, b, X(10), S13, -42063\n    MD5Round \"FF\", b, c, d, a, X(11), S14, -1990404162\n    MD5Round \"FF\", a, b, c, d, X(12), S11, 1804603682\n    MD5Round \"FF\", d, a, b, c, X(13), S12, -40341101\n    MD5Round \"FF\", c, d, a, b, X(14), S13, -1502002290\n    MD5Round \"FF\", b, c, d, a, X(15), S14, 1236535329\n    MD5Round \"GG\", a, b, c, d, X(1), S21, -165796510\n    MD5Round \"GG\", d, a, b, c, X(6), S22, -1069501632\n    MD5Round \"GG\", c, d, a, b, X(11), S23, 643717713\n    MD5Round \"GG\", b, c, d, a, X(0), S24, -373897302\n    MD5Round \"GG\", a, b, c, d, X(5), S21, -701558691\n    MD5Round \"GG\", d, a, b, c, X(10), S22, 38016083\n    MD5Round \"GG\", c, d, a, b, X(15), S23, -660478335\n    MD5Round \"GG\", b, c, d, a, X(4), S24, -405537848\n    MD5Round \"GG\", a, b, c, d, X(9), S21, 568446438\n    MD5Round \"GG\", d, a, b, c, X(14), S22, -1019803690\n    MD5Round \"GG\", c, d, a, b, X(3), S23, -187363961\n    MD5Round \"GG\", b, c, d, a, X(8), S24, 1163531501\n    MD5Round \"GG\", a, b, c, d, X(13), S21, -1444681467\n    MD5Round \"GG\", d, a, b, c, X(2), S22, -51403784\n    MD5Round \"GG\", c, d, a, b, X(7), S23, 1735328473\n    MD5Round \"GG\", b, c, d, a, X(12), S24, -1926607734\n    MD5Round \"HH\", a, b, c, d, X(5), S31, -378558\n    MD5Round \"HH\", d, a, b, c, X(8), S32, -2022574463\n    MD5Round \"HH\", c, d, a, b, X(11), S33, 1839030562\n    MD5Round \"HH\", b, c, d, a, X(14), S34, -35309556\n    MD5Round \"HH\", a, b, c, d, X(1), S31, -1530992060\n    MD5Round \"HH\", d, a, b, c, X(4), S32, 1272893353\n    MD5Round \"HH\", c, d, a, b, X(7), S33, -155497632\n    MD5Round \"HH\", b, c, d, a, X(10), S34, -1094730640\n    MD5Round \"HH\", a, b, c, d, X(13), S31, 681279174\n    MD5Round \"HH\", d, a, b, c, X(0), S32, -358537222\n    MD5Round \"HH\", c, d, a, b, X(3), S33, -722521979\n    MD5Round \"HH\", b, c, d, a, X(6), S34, 76029189\n    MD5Round \"HH\", a, b, c, d, X(9), S31, -640364487\n    MD5Round \"HH\", d, a, b, c, X(12), S32, -421815835\n    MD5Round \"HH\", c, d, a, b, X(15), S33, 530742520\n    MD5Round \"HH\", b, c, d, a, X(2), S34, -995338651\n    MD5Round \"II\", a, b, c, d, X(0), S41, -198630844\n    MD5Round \"II\", d, a, b, c, X(7), S42, 1126891415\n    MD5Round \"II\", c, d, a, b, X(14), S43, -1416354905\n    MD5Round \"II\", b, c, d, a, X(5), S44, -57434055\n    MD5Round \"II\", a, b, c, d, X(12), S41, 1700485571\n    MD5Round \"II\", d, a, b, c, X(3), S42, -1894986606\n    MD5Round \"II\", c, d, a, b, X(10), S43, -1051523\n    MD5Round \"II\", b, c, d, a, X(1), S44, -2054922799\n    MD5Round \"II\", a, b, c, d, X(8), S41, 1873313359\n    MD5Round \"II\", d, a, b, c, X(15), S42, -30611744\n    MD5Round \"II\", c, d, a, b, X(6), S43, -1560198380\n    MD5Round \"II\", b, c, d, a, X(13), S44, 1309151649\n    MD5Round \"II\", a, b, c, d, X(4), S41, -145523070\n    MD5Round \"II\", d, a, b, c, X(11), S42, -1120210379\n    MD5Round \"II\", c, d, a, b, X(2), S43, 718787259\n    MD5Round \"II\", b, c, d, a, X(9), S44, -343485551\n    arrLongConversion(1) = MD5LongAdd(arrLongConversion(1), a)\n    arrLongConversion(2) = MD5LongAdd(arrLongConversion(2), b)\n    arrLongConversion(3) = MD5LongAdd(arrLongConversion(3), c)\n    arrLongConversion(4) = MD5LongAdd(arrLongConversion(4), d)\nEnd Sub\n\nPrivate Function MD5LongAdd(lngVal1 As Long, lngVal2 As Long) As Long\n    Dim lngHighWord As Long\n    Dim lngLowWord As Long\n    Dim lngOverflow As Long\n\n    lngLowWord = (lngVal1 And &HFFFF&) + (lngVal2 And &HFFFF&)\n    lngOverflow = lngLowWord \\ 65536\n    lngHighWord = (((lngVal1 And &HFFFF0000) \\ 65536) + _\n                   ((lngVal2 And &HFFFF0000) \\ 65536) + _\n                   lngOverflow) And &HFFFF&\n    MD5LongAdd = MD5LongConversion((lngHighWord * 65536#) + _\n                                   (lngLowWord And &HFFFF&))\nEnd Function\n\nPrivate Function MD5LongAdd4(lngVal1 As Long, lngVal2 As Long, _\n                             lngVal3 As Long, lngVal4 As Long) As Long\n    Dim lngHighWord As Long\n    Dim lngLowWord As Long\n    Dim lngOverflow As Long\n\n    lngLowWord = (lngVal1 And &HFFFF&) + (lngVal2 And &HFFFF&) + _\n                 (lngVal3 And &HFFFF&) + (lngVal4 And &HFFFF&)\n    lngOverflow = lngLowWord \\ 65536\n    lngHighWord = (((lngVal1 And &HFFFF0000) \\ 65536) + _\n                   ((lngVal2 And &HFFFF0000) \\ 65536) + _\n                   ((lngVal3 And &HFFFF0000) \\ 65536) + _\n                   ((lngVal4 And &HFFFF0000) \\ 65536) + _\n                   lngOverflow) And &HFFFF&\n    MD5LongAdd4 = MD5LongConversion((lngHighWord * 65536#) + _\n                                    (lngLowWord And &HFFFF&))\nEnd Function\n\nPrivate Sub MD5Decode(intLength As Integer, lngOutBuffer() As Long, _\n                      bytInBuffer() As Byte)\n    Dim intDblIndex As Integer\n    Dim intByteIndex As Integer\n    Dim dblSum As Double\n    \n    intDblIndex = 0\n    For intByteIndex = 0 To intLength - 1 Step 4\n        dblSum = bytInBuffer(intByteIndex) + _\n                 bytInBuffer(intByteIndex + 1) * 256# + _\n                 bytInBuffer(intByteIndex + 2) * 65536# + _\n                 bytInBuffer(intByteIndex + 3) * 16777216#\n        lngOutBuffer(intDblIndex) = MD5LongConversion(dblSum)\n        intDblIndex = (intDblIndex + 1)\n    Next intByteIndex\nEnd Sub\n\nPrivate Function MD5LongConversion(dblValue As Double) As Long\n    If dblValue < 0 Or dblValue >= OFFSET_4 Then Error 6\n    If dblValue <= MAXINT_4 Then\n        MD5LongConversion = dblValue\n      Else\n        MD5LongConversion = dblValue - OFFSET_4\n    End If\nEnd Function\n\nPrivate Sub MD5Finish()\n    Dim dblBits As Double\n    Dim arrPadding(72) As Byte\n    Dim lngBytesBuffered As Long\n    \n    arrPadding(0) = &H80\n    dblBits = lngTrack * 8\n    lngBytesBuffered = lngTrack Mod 64\n    If lngBytesBuffered <= 56 Then\n        MD564Split (56 - lngBytesBuffered), arrPadding\n      Else\n        MD564Split (120 - lngTrack), arrPadding\n    End If\n    arrPadding(0) = MD5LongConversion(dblBits) And &HFF&\n    arrPadding(1) = MD5LongConversion(dblBits) \\ 256 And &HFF&\n    arrPadding(2) = MD5LongConversion(dblBits) \\ 65536 And &HFF&\n    arrPadding(3) = MD5LongConversion(dblBits) \\ 16777216 And &HFF&\n    arrPadding(4) = 0\n    arrPadding(5) = 0\n    arrPadding(6) = 0\n    arrPadding(7) = 0\n    MD564Split 8, arrPadding\nEnd Sub\n\nPrivate Function MD5StringChange(lngnum As Long) As String\n        Dim bytA As Byte\n        Dim bytB As Byte\n        Dim bytC As Byte\n        Dim bytD As Byte\n        \n        bytA = lngnum And &HFF&\n        If bytA < 16 Then\n            MD5StringChange = \"0\" & Hex(bytA)\n          Else\n            MD5StringChange = Hex(bytA)\n        End If\n        bytB = (lngnum And &HFF00&) \\ 256\n        If bytB < 16 Then\n            MD5StringChange = MD5StringChange & \"0\" & Hex(bytB)\n          Else\n            MD5StringChange = MD5StringChange & Hex(bytB)\n        End If\n        bytC = (lngnum And &HFF0000) \\ 65536\n        If bytC < 16 Then\n            MD5StringChange = MD5StringChange & \"0\" & Hex(bytC)\n          Else\n            MD5StringChange = MD5StringChange & Hex(bytC)\n        End If\n        If lngnum < 0 Then\n            bytD = ((lngnum And &H7F000000) \\ 16777216) Or &H80&\n          Else\n            bytD = (lngnum And &HFF000000) \\ 16777216\n        End If\n        If bytD < 16 Then\n            MD5StringChange = MD5StringChange & \"0\" & Hex(bytD)\n          Else\n            MD5StringChange = MD5StringChange & Hex(bytD)\n        End If\nEnd Function\n\nPrivate Function MD5Value() As String\n    MD5Value = LCase(MD5StringChange(arrLongConversion(1)) & _\n                     MD5StringChange(arrLongConversion(2)) & _\n                     MD5StringChange(arrLongConversion(3)) & _\n                     MD5StringChange(arrLongConversion(4)))\nEnd Function\n\nPublic Function FnsCalculateMD5(strMessage As String) As String\n    Dim bytBuffer() As Byte\n    \n    bytBuffer = MD5StringArray(strMessage)\n    MD5Start\n    MD564Split Len(strMessage), bytBuffer\n    MD5Finish\n    FnsCalculateMD5 = MD5Value 'Korrigiert by Willi Wipp\nEnd Function\n\nPrivate Sub MD5Start()\n    lngTrack = 0\n    arrLongConversion(1) = MD5LongConversion(1732584193#)\n    arrLongConversion(2) = MD5LongConversion(4023233417#)\n    arrLongConversion(3) = MD5LongConversion(2562383102#)\n    arrLongConversion(4) = MD5LongConversion(271733878#)\nEnd Sub\n\n"}
