{"id":"MOD_mdlGetTimeZone","name":"mdlGetTimeZone","kind":"standard","procedures":["Function GetDaylightTimeBias() As String","Function GetStandardTimeBias() As String","Function GetCurrentTimeBias() As String","Function GetCurrentGMTDate() As String","Function GetCurrentTimeZone() As String","Private Function TrimNull(item As String)"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n' Copyright ©1996-2011 VBnet/Randy Birch, All Rights Reserved.\n' Some pages may also contain other copyrights by the author.\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n' Distribution: You can freely use this code in your own\n'               applications, but you may not reproduce\n'               or publish this code on any web site,\n'               online service, or distribute as source\n'               on any media without express permission.\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\nPrivate Const TIME_ZONE_ID_UNKNOWN As Long = 1\nPrivate Const TIME_ZONE_ID_STANDARD As Long = 1\nPrivate Const TIME_ZONE_ID_DAYLIGHT As Long = 2\nPrivate Const TIME_ZONE_ID_INVALID As Long = &HFFFFFFFF\n\nPrivate Type SYSTEMTIME\n   wYear         As Integer\n   wMonth        As Integer\n   wDayOfWeek    As Integer\n   wDay          As Integer\n   wHour         As Integer\n   wMinute       As Integer\n   wSecond       As Integer\n   wMilliseconds As Integer\nEnd Type\n\nPrivate Type TIME_ZONE_INFORMATION\n   Bias As Long\n   StandardName(0 To 63) As Byte  'unicode (0-based)\n   StandardDate As SYSTEMTIME\n   StandardBias As Long\n   DaylightName(0 To 63) As Byte  'unicode (0-based)\n   DaylightDate As SYSTEMTIME\n   DaylightBias As Long\nEnd Type\n\nPrivate Declare PtrSafe Function GetTimeZoneInformation Lib \"kernel32\" _\n    (lpTimeZoneInformation As TIME_ZONE_INFORMATION) As Long\n\n\n\n'Private Sub Form_Load()\n'\n'   Command1.Caption = \"Get Time Zone Bias\"\n'\n'End Sub\n\n'\n'Private Sub Command1_Click()\n'\n'   Label1.Caption = Format$(Now, \"dddd mmm dd, yyyy hh:mm:ss am/pm\")\n'\n'   Text1.Text = GetCurrentTimeZone()\n'   Text2.Text = GetCurrentTimeBias()\n'   Text3.Text = GetCurrentGMTDate()\n'\n'   Text4.Text = GetStandardTimeBias()\n'   Text5.Text = GetDaylightTimeBias()\n'\n'End Sub\n'\n\nFunction GetDaylightTimeBias() As String\n\n   Dim tzi As TIME_ZONE_INFORMATION\n   Dim dwBias As Long\n   Dim tmp As String\n\n   Call GetTimeZoneInformation(tzi)\n   \n   dwBias = tzi.Bias + tzi.DaylightBias\n   tmp = CStr(dwBias \\ 60) & \" hours, \" & CStr(dwBias Mod 60) & \" minutes\"\n\n   GetDaylightTimeBias = tmp\n\nEnd Function\n\n\nFunction GetStandardTimeBias() As String\n\n   Dim tzi As TIME_ZONE_INFORMATION\n   Dim dwBias As Long\n   Dim tmp As String\n\n   Call GetTimeZoneInformation(tzi)\n\n   dwBias = tzi.Bias + tzi.StandardBias\n   tmp = CStr(dwBias \\ 60) & \" hours, \" & CStr(dwBias Mod 60) & \" minutes\"\n   \n   GetStandardTimeBias = tmp\n\nEnd Function\n\n\nFunction GetCurrentTimeBias() As String\n\n   Dim tzi As TIME_ZONE_INFORMATION\n   Dim dwBias As Long\n   Dim tmp As String\n\n   Select Case GetTimeZoneInformation(tzi)\n   Case TIME_ZONE_ID_DAYLIGHT\n      dwBias = tzi.Bias + tzi.DaylightBias\n   Case Else\n      dwBias = tzi.Bias + tzi.StandardBias\n   End Select\n\n   tmp = CStr(dwBias \\ 60) & \" hours, \" & CStr(dwBias Mod 60) & \" minutes\"\n\n   GetCurrentTimeBias = tmp\n   \nEnd Function\n\n\nFunction GetCurrentGMTDate() As String\n\n   Dim tzi As TIME_ZONE_INFORMATION\n   Dim gmt As Date\n   Dim dwBias As Long\n   Dim tmp As String\n\n   Select Case GetTimeZoneInformation(tzi)\n   Case TIME_ZONE_ID_DAYLIGHT\n      dwBias = tzi.Bias + tzi.DaylightBias\n   Case Else\n      dwBias = tzi.Bias + tzi.StandardBias\n   End Select\n\n   gmt = DateAdd(\"n\", dwBias, Now)\n   tmp = Format$(gmt, \"dddd mmm dd, yyyy hh:mm:ss am/pm\")\n\n   GetCurrentGMTDate = tmp\n\nEnd Function\n\n\nFunction GetCurrentTimeZone() As String\n\n   Dim tzi As TIME_ZONE_INFORMATION\n   Dim tmp As String\n\n   Select Case GetTimeZoneInformation(tzi)\n      Case 0:  tmp = \"Cannot determine current time zone\"\n      Case 1:  tmp = tzi.StandardName\n      Case 2:  tmp = tzi.DaylightName\n   End Select\n   \n   GetCurrentTimeZone = TrimNull(tmp)\n   \nEnd Function\n\n\nPrivate Function TrimNull(item As String)\n\n    Dim pos As Integer\n   \n   'double check that there is a chr$(0) in the string\n    pos = InStr(item, Chr$(0))\n    If pos Then\n       TrimNull = Left$(item, pos - 1)\n    Else\n       TrimNull = item\n    End If\n  \nEnd Function\n"}
