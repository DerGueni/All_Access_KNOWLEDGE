{"id":"MOD_mdl_CONSEC_PREFERENCES","name":"mdl_CONSEC_PREFERENCES","kind":"standard","procedures":["Public Sub InitializePreferences()","Private Sub SavePreferencesToDatabase()","Private Sub SavePref(key As String, Value As String, description As String)","Public Function ApplyPreferences(codeModule As String) As String","Private Function RemoveErrorHandlers(code As String) As String","Private Function AddDebugStatements(code As String) As String","Private Function AddDebugOutput(code As String) As String","Private Function MaximizeAutomation(code As String) As String","Public Function CheckPreference(prefName As String) As Boolean","Public Function GenerateCodeWithPreferences(moduleName As String, moduleType As String) As String","Private Function TableExists(tableName As String) As Boolean","Public Sub ShowPreferences()","Private Sub AutoInitialize()"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":["CREATE TABLE tbl_CONSEC_Preferences (","DELETE FROM tbl_CONSEC_Preferences WHERE PREF_Key = '","INSERT INTO tbl_CONSEC_Preferences (PREF_Key, PREF_Value, PREF_Description) "],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"' ================================================\n' CONSEC ENTWICKLER-PRÄFERENZEN\n' ================================================\n' Diese Präferenzen gelten für ALLE CONSEC-Module\n' und werden bei jeder Code-Generierung beachtet\n' ================================================\n\nOption Compare Database\nOption Explicit\n\n' ================================================\n' ENTWICKLER-PRÄFERENZEN (PERSISTENT)\n' ================================================\n\nPublic Type DeveloperPreferences\n    ' DEBUGGING\n    UseErrorHandlers As Boolean          ' FALSE - Nutze VBA-Debugger statt Error Handler\n    DebugMode As Boolean                 ' TRUE - Ausführliche Debug.Print Ausgaben\n    StopOnErrors As Boolean              ' TRUE - Code stoppt bei Fehlern für Debugging\n    \n    ' AUTOMATISIERUNG\n    MaximizeAutomation As Boolean        ' TRUE - Alles soweit wie möglich automatisieren\n    AutoFixProblems As Boolean           ' TRUE - Probleme automatisch beheben\n    AutoCreateBackups As Boolean         ' TRUE - Vor Änderungen Backups erstellen\n    SelfHealingMode As Boolean           ' TRUE - System repariert sich selbst\n    \n    ' CODE-STIL\n    PreferSimpleCode As Boolean          ' TRUE - Einfacher, lesbarer Code\n    IncludeComments As Boolean           ' TRUE - Ausführliche Kommentare\n    UseGermanComments As Boolean         ' TRUE - Deutsche Kommentare\n    \n    ' INSTALLATION\n    OneClickInstall As Boolean           ' TRUE - Ein-Klick-Installation\n    AutoDetectEnvironment As Boolean     ' TRUE - Umgebung automatisch erkennen\n    AutoConfigureAll As Boolean          ' TRUE - Alles automatisch konfigurieren\nEnd Type\n\n' Globale Präferenzen\nPublic g_Prefs As DeveloperPreferences\n\n' ================================================\n' PRÄFERENZEN INITIALISIEREN\n' ================================================\n\nPublic Sub InitializePreferences()\n    ' Diese Funktion setzt die Standard-Präferenzen\n    ' basierend auf den Wünschen des Entwicklers\n    \n    With g_Prefs\n        ' DEBUGGING - WIE GEWÜNSCHT\n        .UseErrorHandlers = False        ' ← KEIN Error Handler, VBA Debugger verwenden!\n        .DebugMode = True                ' ← Debug-Ausgaben aktiviert\n        .StopOnErrors = True             ' ← Bei Fehlern stoppen für Debugging\n        \n        ' AUTOMATISIERUNG - WIE GEWÜNSCHT\n        .MaximizeAutomation = True      ' ← ALLES automatisieren was geht!\n        .AutoFixProblems = True          ' ← Probleme automatisch lösen\n        .AutoCreateBackups = True        ' ← Immer Backups erstellen\n        .SelfHealingMode = True          ' ← Selbstheilung aktiviert\n        \n        ' CODE-STIL\n        .PreferSimpleCode = True         ' ← Einfacher Code\n        .IncludeComments = True          ' ← Mit Kommentaren\n        .UseGermanComments = True        ' ← Deutsche Kommentare\n        \n        ' INSTALLATION\n        .OneClickInstall = True          ' ← Ein-Klick-Installation\n        .AutoDetectEnvironment = True    ' ← Automatische Erkennung\n        .AutoConfigureAll = True         ' ← Alles automatisch\n    End With\n    \n    ' Präferenzen in Tabelle speichern\n    Call SavePreferencesToDatabase\n    \n    Debug.Print \"================================================\"\n    Debug.Print \"ENTWICKLER-PRÄFERENZEN AKTIVIERT:\"\n    Debug.Print \"================================================\"\n    Debug.Print \"✅ VBA-Debugger statt Error Handler\"\n    Debug.Print \"✅ Maximale Automatisierung\"\n    Debug.Print \"✅ Selbstheilung aktiviert\"\n    Debug.Print \"✅ Auto-Fix für alle Probleme\"\n    Debug.Print \"================================================\"\nEnd Sub\n\n' ================================================\n' PRÄFERENZEN IN DATENBANK SPEICHERN\n' ================================================\n\nPrivate Sub SavePreferencesToDatabase()\n    On Error Resume Next\n    \n    ' Tabelle erstellen falls nicht vorhanden\n    If Not TableExists(\"tbl_CONSEC_Preferences\") Then\n        CurrentDb.Execute \"CREATE TABLE tbl_CONSEC_Preferences (\" & _\n                         \"PREF_Key TEXT(50) PRIMARY KEY, \" & _\n                         \"PREF_Value TEXT(10), \" & _\n                         \"PREF_Description TEXT(255), \" & _\n                         \"PREF_LastUpdate DATETIME DEFAULT Now())\"\n    End If\n    \n    ' Präferenzen speichern\n    SavePref \"UseErrorHandlers\", \"FALSE\", \"NIEMALS Error Handler verwenden - immer VBA Debugger\"\n    SavePref \"DebugMode\", \"TRUE\", \"Debug-Modus immer aktiviert\"\n    SavePref \"MaximizeAutomation\", \"TRUE\", \"ALLES automatisieren was möglich ist\"\n    SavePref \"AutoFixProblems\", \"TRUE\", \"Probleme IMMER automatisch beheben\"\n    SavePref \"SelfHealingMode\", \"TRUE\", \"System heilt sich selbst\"\n    SavePref \"OneClickInstall\", \"TRUE\", \"Installation mit einem Klick\"\nEnd Sub\n\nPrivate Sub SavePref(key As String, Value As String, description As String)\n    On Error Resume Next\n    \n    ' Erst löschen falls vorhanden\n    CurrentDb.Execute \"DELETE FROM tbl_CONSEC_Preferences WHERE PREF_Key = '\" & key & \"'\"\n    \n    ' Dann neu einfügen\n    CurrentDb.Execute \"INSERT INTO tbl_CONSEC_Preferences (PREF_Key, PREF_Value, PREF_Description) \" & _\n                     \"VALUES ('\" & key & \"', '\" & Value & \"', '\" & description & \"')\"\nEnd Sub\n\n' ================================================\n' PRÄFERENZEN ANWENDEN\n' ================================================\n\nPublic Function ApplyPreferences(codeModule As String) As String\n    ' Diese Funktion modifiziert generierten Code\n    ' basierend auf den Präferenzen\n    \n    Dim modifiedCode As String\n    modifiedCode = codeModule\n    \n    ' Error Handler entfernen wenn gewünscht\n    If Not g_Prefs.UseErrorHandlers Then\n        modifiedCode = RemoveErrorHandlers(modifiedCode)\n        modifiedCode = AddDebugStatements(modifiedCode)\n    End If\n    \n    ' Debug-Ausgaben hinzufügen\n    If g_Prefs.DebugMode Then\n        modifiedCode = AddDebugOutput(modifiedCode)\n    End If\n    \n    ' Automatisierung maximieren\n    If g_Prefs.MaximizeAutomation Then\n        modifiedCode = MaximizeAutomation(modifiedCode)\n    End If\n    \n    ApplyPreferences = modifiedCode\nEnd Function\n\n' ================================================\n' CODE-MODIFIKATIONS-FUNKTIONEN\n' ================================================\n\nPrivate Function RemoveErrorHandlers(code As String) As String\n    ' Entfernt alle Error Handler aus dem Code\n    Dim lines() As String\n    Dim i As Long\n    Dim result As String\n    \n    lines = Split(code, vbCrLf)\n    \n    For i = 0 To UBound(lines)\n        ' Error Handler Zeilen überspringen\n        If InStr(lines(i), \"On Error\") = 0 And _\n           InStr(lines(i), \"ErrorHandler:\") = 0 And _\n           InStr(lines(i), \"Error GoTo\") = 0 And _\n           InStr(lines(i), \"Err.\") = 0 Then\n            result = result & lines(i) & vbCrLf\n        Else\n            ' Ersetze mit Debug-Statement\n            result = result & \"' \" & lines(i) & \" ' ← Error Handler entfernt (Präferenz: VBA Debugger)\" & vbCrLf\n        End If\n    Next i\n    \n    RemoveErrorHandlers = result\nEnd Function\n\nPrivate Function AddDebugStatements(code As String) As String\n    ' Fügt Debug-Statements hinzu\n    Dim lines() As String\n    Dim i As Long\n    Dim result As String\n    \n    lines = Split(code, vbCrLf)\n    \n    For i = 0 To UBound(lines)\n        result = result & lines(i) & vbCrLf\n        \n        ' Nach jeder Sub/Function Debug-Ausgabe\n        If InStr(lines(i), \"Sub \") > 0 Or InStr(lines(i), \"Function \") > 0 Then\n            If InStr(lines(i), \"Private\") = 0 And InStr(lines(i), \"Public\") = 0 Then\n                result = result & \"    Debug.Print \"\"→ Entering: \"\" & \"\"\" & Trim(lines(i)) & \"\"\"\" & vbCrLf\n            End If\n        End If\n    Next i\n    \n    AddDebugStatements = result\nEnd Function\n\nPrivate Function AddDebugOutput(code As String) As String\n    ' Erweiterte Debug-Ausgaben\n    AddDebugOutput = code ' Hier würde weitere Logik erfolgen\nEnd Function\n\nPrivate Function MaximizeAutomation(code As String) As String\n    ' Maximiert Automatisierung im Code\n    MaximizeAutomation = code ' Hier würde weitere Logik erfolgen\nEnd Function\n\n' ================================================\n' PRÄFERENZ-CHECKER\n' ================================================\n\nPublic Function CheckPreference(prefName As String) As Boolean\n    ' Prüft eine spezifische Präferenz\n    \n    Select Case prefName\n        Case \"UseErrorHandlers\"\n            CheckPreference = g_Prefs.UseErrorHandlers\n        Case \"DebugMode\"\n            CheckPreference = g_Prefs.DebugMode\n        Case \"MaximizeAutomation\"\n            CheckPreference = g_Prefs.MaximizeAutomation\n        Case \"AutoFixProblems\"\n            CheckPreference = g_Prefs.AutoFixProblems\n        Case Else\n            CheckPreference = True\n    End Select\nEnd Function\n\n' ================================================\n' AUTOMATISCHER CODE-GENERATOR MIT PRÄFERENZEN\n' ================================================\n\nPublic Function GenerateCodeWithPreferences(moduleName As String, moduleType As String) As String\n    ' Generiert Code unter Berücksichtigung der Präferenzen\n    \n    Dim code As String\n    \n    ' Header\n    code = \"Attribute VB_Name = \"\"\" & moduleName & \"\"\"\" & vbCrLf\n    code = code & \"' ================================================\" & vbCrLf\n    code = code & \"' Automatisch generiert mit Entwickler-Präferenzen\" & vbCrLf\n    code = code & \"' Präferenz: KEIN Error Handler (VBA Debugger)\" & vbCrLf\n    code = code & \"' Präferenz: MAXIMALE Automatisierung\" & vbCrLf\n    code = code & \"' ================================================\" & vbCrLf & vbCrLf\n    code = code & \"Option Compare Database\" & vbCrLf\n    code = code & \"Option Explicit\" & vbCrLf & vbCrLf\n    \n    ' Hauptfunktion OHNE Error Handler\n    code = code & \"Public Sub Main()\" & vbCrLf\n    code = code & \"    ' KEIN Error Handler - VBA Debugger wird verwendet\" & vbCrLf\n    code = code & \"    Debug.Print \"\"Start: \"\" & Now()\" & vbCrLf\n    code = code & \"    \" & vbCrLf\n    code = code & \"    ' Automatische Ausführung\" & vbCrLf\n    code = code & \"    Call AutoExecuteAll()\" & vbCrLf\n    code = code & \"    \" & vbCrLf\n    code = code & \"    Debug.Print \"\"Ende: \"\" & Now()\" & vbCrLf\n    code = code & \"End Sub\" & vbCrLf & vbCrLf\n    \n    ' Auto-Funktion\n    code = code & \"Private Sub AutoExecuteAll()\" & vbCrLf\n    code = code & \"    ' Vollautomatische Ausführung - keine manuellen Schritte\" & vbCrLf\n    code = code & \"    Debug.Print \"\"Automatische Ausführung...\"\"\" & vbCrLf\n    code = code & \"    \" & vbCrLf\n    code = code & \"    ' Hier würde die automatische Logik stehen\" & vbCrLf\n    code = code & \"End Sub\"\n    \n    GenerateCodeWithPreferences = code\nEnd Function\n\n' ================================================\n' HILFS-FUNKTIONEN\n' ================================================\n\nPrivate Function TableExists(tableName As String) As Boolean\n    On Error Resume Next\n    Dim tdf As DAO.TableDef\n    Set tdf = CurrentDb.TableDefs(tableName)\n    TableExists = (err.Number = 0)\n    Set tdf = Nothing\n    err.clear\nEnd Function\n\n' ================================================\n' PRÄFERENZ-ANZEIGE\n' ================================================\n\nPublic Sub ShowPreferences()\n    ' Zeigt aktuelle Präferenzen an\n    \n    Dim msg As String\n    msg = \"CONSEC ENTWICKLER-PRÄFERENZEN\" & vbCrLf\n    msg = msg & \"==============================\" & vbCrLf & vbCrLf\n    msg = msg & \"DEBUGGING:\" & vbCrLf\n    msg = msg & \"• Error Handler: \" & IIf(g_Prefs.UseErrorHandlers, \"JA\", \"NEIN (VBA Debugger)\") & vbCrLf\n    msg = msg & \"• Debug-Modus: \" & IIf(g_Prefs.DebugMode, \"JA\", \"NEIN\") & vbCrLf & vbCrLf\n    msg = msg & \"AUTOMATISIERUNG:\" & vbCrLf\n    msg = msg & \"• Max. Automatisierung: \" & IIf(g_Prefs.MaximizeAutomation, \"JA\", \"NEIN\") & vbCrLf\n    msg = msg & \"• Auto-Fix: \" & IIf(g_Prefs.AutoFixProblems, \"JA\", \"NEIN\") & vbCrLf\n    msg = msg & \"• Selbstheilung: \" & IIf(g_Prefs.SelfHealingMode, \"JA\", \"NEIN\") & vbCrLf & vbCrLf\n    msg = msg & \"Diese Präferenzen werden bei JEDER\" & vbCrLf\n    msg = msg & \"Code-Generierung angewendet!\"\n    \n    MsgBox msg, vbInformation, \"Entwickler-Präferenzen\"\nEnd Sub\n\n' ================================================\n' INITIALISIERUNG BEI MODUL-LADEN\n' ================================================\n\nPrivate Sub AutoInitialize()\n    ' Wird beim Laden des Moduls ausgeführt\n    Call InitializePreferences\nEnd Sub"}
