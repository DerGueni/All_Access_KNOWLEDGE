{"id":"MOD_mdl_TM_AccessSecurity","name":"mdl_TM-AccessSecurity","kind":"standard","procedures":["Public Sub TM_ShowAllGroups()","Public Sub TM_ShowAllUsers()","Public Sub TM_ShowAllUsersWithGroups()","Public Sub TM_ShowAllGroupsWithUsers()","Public Function fTM_AddUser(UserName As String, PID As String, Passwort As String) As Boolean","Public Function fTM_AddGroup(GroupName As String, PID As String) As Boolean","Public Function fTM_DeleteUser(UserName As String) As Boolean","Public Function fTM_DeleteGroup(GroupName As String) As Boolean","Public Function fTM_AddUserToGroup(UserName As String, GroupName As String) As Boolean","Public Function fTM_AddGroupToUser(UserName As String, GroupName As String) As Boolean","Public Function fTM_DelteUserFromGroup(UserName As String, GroupName As String) As Boolean","Public Function fTM_DelteGroupFromUser(UserName As String, GroupName As String) As Boolean","Public Function fTM_GroupExist(GroupName As String) As Boolean","Public Function fTM_UserExist(UserName As String) As Boolean","Public Function fTM_UserInGroupExist(UserName As String, GroupName As String) As Boolean","Public Function fTM_ChangeUserPwd(UserName As String, AltesKennwort As String, NeuesKennwort As String) As Boolean","Function TM_ListAllGroups(Feld As control, ID As Variant, zeile As Variant, spalte As Variant, code As Variant) As Variant","Function ListAllUsers(Feld As control, ID As Variant, zeile As Variant, spalte As Variant, code As Variant) As Variant","Function ListUsersOfaGroup(Feld As control, ID As Variant, zeile As Variant, spalte As Variant, code As Variant) As Variant","Function ListGroupsOfaUser(Feld As control, ID As Variant, zeile As Variant, spalte As Variant, code As Variant) As Variant"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n\nPublic Sub TM_ShowAllGroups()\n'\n'    Name: TM_ShowAllGroups\n'   Zweck: Zeigt alle Gruppen im Direktfenster an\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: -\n'\n'  Output: Die Namen aller Gruppen (im Direktfenster)\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_TM_ShowAllGroups\n\n    'Variablen deklarieren\n    Dim wrk As DAO.Workspace\n    Dim grp As DAO.Group\n    \n    Set wrk = DBEngine.Workspaces(0)\n    \n    For Each grp In wrk.Groups\n        Debug.Print grp.Name\n    Next grp\n\n'Ende\nExit_TM_ShowAllGroups:\n    On Error Resume Next\n    wrk.Close\n    Set wrk = Nothing\n    Exit Sub\n\n'Fehlerbehandlung\nErr_TM_ShowAllGroups:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_TM_ShowAllGroups\n    End Select\n        \nEnd Sub\n\nPublic Sub TM_ShowAllUsers()\n'\n'    Name: TM_ShowAllUsers\n'   Zweck: Zeigt die Namen aller User im Direktfenster an\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: -\n'\n'  Output: Alle Usewr (im Direktfenster)\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_TM_ShowAllUsers\n\n    'Variablen deklarieren\n    Dim wrk As DAO.Workspace\n    Dim usr As DAO.User\n    \n    Set wrk = DBEngine.Workspaces(0)\n    \n    For Each usr In wrk.Users\n        Debug.Print usr.Name\n    Next usr\n\n'Ende\nExit_TM_ShowAllUsers:\n    On Error Resume Next\n    wrk.Close\n    Set wrk = Nothing\n    Exit Sub\n\n'Fehlerbehandlung\nErr_TM_ShowAllUsers:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_TM_ShowAllUsers\n    End Select\n        \nEnd Sub\n\nPublic Sub TM_ShowAllUsersWithGroups()\n'\n'    Name: TM_ShowAllUsersWithGroups\n'   Zweck: Zeigt alle User und deren Gruppen im Direktfenster an\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: -\n'\n'  Output: Alle User und deren Gruppen (im Direktfenster)\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_TM_ShowAllUsersWithGroups\n\n    'Variablen deklarieren\n    Dim wrk As DAO.Workspace\n    Dim usr As DAO.User\n    Dim i As Integer\n    \n    Set wrk = DBEngine.Workspaces(0)\n    \n    For Each usr In wrk.Users\n        Debug.Print usr.Name\n        For i = 0 To usr.Groups.Count - 1\n            Debug.Print \"   \" & usr.Groups(i).Name\n        Next i\n    Next usr\n\n'Ende\nExit_TM_ShowAllUsersWithGroups:\n    On Error Resume Next\n    wrk.Close\n    Set wrk = Nothing\n    Exit Sub\n\n'Fehlerbehandlung\nErr_TM_ShowAllUsersWithGroups:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_TM_ShowAllUsersWithGroups\n    End Select\n        \nEnd Sub\n\nPublic Sub TM_ShowAllGroupsWithUsers()\n'\n'    Name: TM_ShowAllGroupsWithUsers\n'   Zweck: Zeigt alle Gruppen und deren User im Direktfenster an\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: -\n'\n'  Output: Alle Gruppen und deren User (im Direktfenster)\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_TM_ShowAllGroupsWithUsers\n\n    'Variablen deklarieren\n    Dim wrk As DAO.Workspace\n    Dim grp As DAO.Group\n    Dim i As Integer\n    \n    Set wrk = DBEngine.Workspaces(0)\n    \n    For Each grp In wrk.Groups\n        Debug.Print grp.Name\n        For i = 0 To grp.Users.Count - 1\n            Debug.Print \"   \" & grp.Users(i).Name\n        Next i\n    Next grp\n\n'Ende\nExit_TM_ShowAllGroupsWithUsers:\n    On Error Resume Next\n    wrk.Close\n    Set wrk = Nothing\n    Exit Sub\n\n'Fehlerbehandlung\nErr_TM_ShowAllGroupsWithUsers:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_TM_ShowAllGroupsWithUsers\n    End Select\n        \nEnd Sub\n\nPublic Function fTM_AddUser(UserName As String, PID As String, Passwort As String) As Boolean\n'\n'    Name: fTM_AddUser\n'   Zweck: Fügt einen neuen Benutzer hinzu\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: - UserName\n'          - PID\n'          - Passwort\n'\n'  Output: - True, wenn Aktion erfolgreich\n'          - False, wenn Aktion fehlgeschlagen\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_fTM_AddUser\n\n    'Variablen deklarieren\n    Dim wrk As DAO.Workspace\n    Dim usr As DAO.User\n    \n    fTM_AddUser = False\n    \n    Set wrk = DBEngine.Workspaces(0)\n    Set usr = wrk.CreateUser(UserName, PID, Passwort)\n    wrk.Users.append usr\n    \n    fTM_AddUser = True\n\n'Ende\nExit_fTM_AddUser:\n    On Error Resume Next\n    Set usr = Nothing\n    wrk.Close\n    Set wrk = Nothing\n    Exit Function\n\n'Fehlerbehandlung\nErr_fTM_AddUser:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_fTM_AddUser\n    End Select\n        \nEnd Function\n\nPublic Function fTM_AddGroup(GroupName As String, PID As String) As Boolean\n'\n'    Name: fTM_AddGroup\n'   Zweck: Fügt einen neue Gruppe hinzu\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: - Gruppenname\n'          - PID\n'\n'  Output: - True, wenn Aktion erfolgreich\n'          - False, wenn Aktion fehlgeschlagen\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_fTM_AddGroup\n\n    'Variablen deklarieren\n    Dim wrk As DAO.Workspace\n    Dim grp As DAO.Group\n    \n    fTM_AddGroup = False\n    \n    Set wrk = DBEngine.Workspaces(0)\n    Set grp = wrk.CreateGroup(GroupName, PID)\n    wrk.Groups.append grp\n    \n    fTM_AddGroup = True\n\n'Ende\nExit_fTM_AddGroup:\n    On Error Resume Next\n    Set grp = Nothing\n    wrk.Close\n    Set wrk = Nothing\n    Exit Function\n\n'Fehlerbehandlung\nErr_fTM_AddGroup:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_fTM_AddGroup\n    End Select\n        \nEnd Function\n\nPublic Function fTM_DeleteUser(UserName As String) As Boolean\n'\n'    Name: fTM_DeleteUser\n'   Zweck: Löscht einen vorhandenen Benutzer\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: - UserName\n'\n'  Output: - True, wenn Aktion erfolgreich\n'          - False, wenn Aktion fehlgeschlagen\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_fTM_DeleteUser\n\n    'Variablen deklarieren\n    Dim wrk As DAO.Workspace\n    \n    fTM_DeleteUser = False\n    \n    Set wrk = DBEngine.Workspaces(0)\n    wrk.Users.Delete (UserName)\n    wrk.Users.Refresh\n    \n    fTM_DeleteUser = True\n\n'Ende\nExit_fTM_DeleteUser:\n    On Error Resume Next\n    wrk.Close\n    Set wrk = Nothing\n    Exit Function\n\n'Fehlerbehandlung\nErr_fTM_DeleteUser:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_fTM_DeleteUser\n    End Select\n        \nEnd Function\n\nPublic Function fTM_DeleteGroup(GroupName As String) As Boolean\n'\n'    Name: fTM_DeleteGroup\n'   Zweck: Löscht eine vorhandene Gruppe\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: - Benutzername\n'\n'  Output: - True, wenn Aktion erfolgreich\n'          - False, wenn Aktion fehlgeschlagen\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_fTM_DeleteGroup\n\n    'Variablen deklarieren\n    Dim wrk As DAO.Workspace\n    \n    fTM_DeleteGroup = False\n    \n    Set wrk = DBEngine.Workspaces(0)\n    wrk.Groups.Delete GroupName\n    wrk.Groups.Refresh\n    \n    fTM_DeleteGroup = True\n\n'Ende\nExit_fTM_DeleteGroup:\n    On Error Resume Next\n    wrk.Close\n    Set wrk = Nothing\n    Exit Function\n\n'Fehlerbehandlung\nErr_fTM_DeleteGroup:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_fTM_DeleteGroup\n    End Select\n        \nEnd Function\n\nPublic Function fTM_AddUserToGroup(UserName As String, GroupName As String) As Boolean\n'\n'    Name: fTM_AddUserToGroup\n'   Zweck: Fügt einen Benutzer zu einer Gruppe hinzu\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: - Benutzername\n'          - Gruppenname\n'\n'  Output: - True, wenn Aktion erfolgreich\n'          - False, wenn Aktion fehlgeschlagen\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_fTM_AddUserToGroup\n\n    'Variablen deklarieren\n    Dim wrk As DAO.Workspace\n    Dim grp As DAO.Group\n    Dim usr As DAO.User\n    \n    fTM_AddUserToGroup = False\n    \n    Set wrk = DBEngine.Workspaces(0)\n    Set usr = wrk.Users(UserName)\n    Set grp = usr.CreateGroup(GroupName)\n    usr.Groups.append grp\n    usr.Groups.Refresh\n    \n    fTM_AddUserToGroup = True\n\n'Ende\nExit_fTM_AddUserToGroup:\n    On Error Resume Next\n    Set usr = Nothing\n    Set grp = Nothing\n    wrk.Close\n    Set wrk = Nothing\n    Exit Function\n\n'Fehlerbehandlung\nErr_fTM_AddUserToGroup:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_fTM_AddUserToGroup\n    End Select\n        \nEnd Function\n\nPublic Function fTM_AddGroupToUser(UserName As String, GroupName As String) As Boolean\n'\n'    Name: fTM_AddGroupToUser\n'   Zweck: Fügt eine Gruppe zu einem Benutzer hinzu\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: - Benutzername\n'          - Gruppenname\n'\n'  Output: - True, wenn Aktion erfolgreich\n'          - False, wenn Aktion fehlgeschlagen\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_fTM_AddGroupToUser\n\n    'Variablen deklarieren\n    Dim wrk As DAO.Workspace\n    Dim grp As DAO.Group\n    Dim usr As DAO.User\n    \n    fTM_AddGroupToUser = False\n    \n    Set wrk = DBEngine.Workspaces(0)\n    Set grp = wrk.Groups(GroupName)\n    Set usr = grp.CreateUser(UserName)\n    grp.Users.append usr\n    grp.Users.Refresh\n    \n    fTM_AddGroupToUser = True\n\n'Ende\nExit_fTM_AddGroupToUser:\n    On Error Resume Next\n    Set usr = Nothing\n    Set grp = Nothing\n    wrk.Close\n    Set wrk = Nothing\n    Exit Function\n\n'Fehlerbehandlung\nErr_fTM_AddGroupToUser:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_fTM_AddGroupToUser\n    End Select\n        \nEnd Function\n\nPublic Function fTM_DelteUserFromGroup(UserName As String, GroupName As String) As Boolean\n'\n'    Name: fTM_DelteUserFromGroup\n'   Zweck: Löscht einen Benutzer aus einer Gruppe\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: - Benutzername\n'          - Gruppenname\n'\n'  Output: - True, wenn Aktion erfolgreich\n'          - False, wenn Aktion fehlgeschlagen\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_fTM_DelteUserFromGroup\n\n    'Variablen deklarieren\n    Dim wrk As DAO.Workspace\n    Dim grp As DAO.Group\n    \n    fTM_DelteUserFromGroup = False\n    \n    Set wrk = DBEngine.Workspaces(0)\n    Set grp = wrk.Groups(GroupName)\n    grp.Users.Delete UserName\n    grp.Users.Refresh\n    \n    fTM_DelteUserFromGroup = True\n\n'Ende\nExit_fTM_DelteUserFromGroup:\n    On Error Resume Next\n    Set grp = Nothing\n    wrk.Close\n    Set wrk = Nothing\n    Exit Function\n\n'Fehlerbehandlung\nErr_fTM_DelteUserFromGroup:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_fTM_DelteUserFromGroup\n    End Select\n        \nEnd Function\n\nPublic Function fTM_DelteGroupFromUser(UserName As String, GroupName As String) As Boolean\n'\n'    Name: fTM_DelteGroupFromUser\n'   Zweck: Löscht eine Gruppe von einem User\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: - Benutzername\n'          - Gruppenname\n'\n'  Output: - True, wenn Aktion erfolgreich\n'          - False, wenn Aktion fehlgeschlagen\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_fTM_DelteGroupFromUser\n\n    'Variablen deklarieren\n    Dim wrk As DAO.Workspace\n    Dim usr As DAO.User\n    \n    fTM_DelteGroupFromUser = False\n    \n    Set wrk = DBEngine.Workspaces(0)\n    Set usr = wrk.Users(UserName)\n    usr.Groups.Delete GroupName\n    usr.Groups.Refresh\n    \n    fTM_DelteGroupFromUser = True\n\n'Ende\nExit_fTM_DelteGroupFromUser:\n    On Error Resume Next\n    Set usr = Nothing\n    wrk.Close\n    Set wrk = Nothing\n    Exit Function\n\n'Fehlerbehandlung\nErr_fTM_DelteGroupFromUser:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_fTM_DelteGroupFromUser\n    End Select\n        \nEnd Function\n\nPublic Function fTM_GroupExist(GroupName As String) As Boolean\n'\n'    Name: fTM_GroupExist\n'   Zweck: Prüft, ob eine Gruppe existiert\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: - Gruppenname\n'\n'  Output: - True, wenn Gruppe existiert\n'          - False, wenn Gruppe nicht existiert\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_fTM_GroupExist\n\n    'Variablen deklarieren\n    Dim wrk As DAO.Workspace\n    Dim grp As DAO.Group\n    \n    fTM_GroupExist = False\n    \n    Set wrk = DBEngine.Workspaces(0)\n    wrk.Groups.Refresh\n    \n    For Each grp In wrk.Groups\n        If grp.Name = GroupName Then\n            fTM_GroupExist = True\n            Exit For\n        End If\n    Next grp\n\n'Ende\nExit_fTM_GroupExist:\n    On Error Resume Next\n    Set grp = Nothing\n    wrk.Close\n    Set wrk = Nothing\n    Exit Function\n\n'Fehlerbehandlung\nErr_fTM_GroupExist:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_fTM_GroupExist\n    End Select\n        \nEnd Function\n\nPublic Function fTM_UserExist(UserName As String) As Boolean\n'\n'    Name: fTM_UserExist\n'   Zweck: Prüft, ob ein User existiert\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: - Username\n'\n'  Output: - True, wenn User existiert\n'          - False, wenn User nicht existiert\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_fTM_UserExist\n\n    'Variablen deklarieren\n    Dim wrk As DAO.Workspace\n    Dim usr As DAO.User\n    \n    fTM_UserExist = False\n    \n    Set wrk = DBEngine.Workspaces(0)\n    wrk.Users.Refresh\n    \n    For Each usr In wrk.Users\n        If usr.Name = UserName Then\n            fTM_UserExist = True\n            Exit For\n        End If\n    Next usr\n\n'Ende\nExit_fTM_UserExist:\n    On Error Resume Next\n    Set usr = Nothing\n    wrk.Close\n    Set wrk = Nothing\n    Exit Function\n\n'Fehlerbehandlung\nErr_fTM_UserExist:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_fTM_UserExist\n    End Select\n        \nEnd Function\n\nPublic Function fTM_UserInGroupExist(UserName As String, GroupName As String) As Boolean\n'\n'    Name: fTM_UserInGroupExist\n'   Zweck: Prüft, ob ein User zu einer Gruppe gehört\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: - Username\n'          - Gruppenname\n'\n'  Output: - True, wenn User zu Gruppe gehört\n'          - False, wenn User nicht zu Gruppe gehört\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_fTM_UserInGroupExist\n\n    'Variablen deklarieren\n    Dim wrk As DAO.Workspace\n    Dim usr As DAO.User\n    Dim i As Integer\n    \n    fTM_UserInGroupExist = False\n    \n    Set wrk = DBEngine.Workspaces(0)\n    Set usr = wrk.Users(UserName)\n    \n    For i = 0 To usr.Groups.Count - 1\n        If usr.Groups(i).Name = GroupName Then\n            fTM_UserInGroupExist = True\n            Exit For\n        End If\n    Next i\n\n'Ende\nExit_fTM_UserInGroupExist:\n    On Error Resume Next\n    Set usr = Nothing\n    wrk.Close\n    Set wrk = Nothing\n    Exit Function\n\n'Fehlerbehandlung\nErr_fTM_UserInGroupExist:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_fTM_UserInGroupExist\n    End Select\n        \nEnd Function\n\nPublic Function fTM_ChangeUserPwd(UserName As String, AltesKennwort As String, NeuesKennwort As String) As Boolean\n'\n'    Name: fTM_ChangeUserPwd\n'   Zweck: Das Kennwort eines Users ändern\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: - Username\n'          - Bisheriges Kennwort\n'          - Neues Kennwort\n'\n'  Output: - True, wenn Aktion erfolgreich\n'          - False, wenn Aktion fehlgeschlagen\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_fTM_ChangeUserPwd\n\n    'Variablen deklarieren\n    Dim wrk As DAO.Workspace\n    Dim usr As DAO.User\n    \n    fTM_ChangeUserPwd = False\n    \n    Set wrk = DBEngine.Workspaces(0)\n    Set usr = wrk.Users(UserName)\n    usr.NewPassword AltesKennwort, NeuesKennwort\n    \n    fTM_ChangeUserPwd = True\n\n'Ende\nExit_fTM_ChangeUserPwd:\n    On Error Resume Next\n    Set usr = Nothing\n    wrk.Close\n    Set wrk = Nothing\n    Exit Function\n\n'Fehlerbehandlung\nErr_fTM_ChangeUserPwd:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_fTM_ChangeUserPwd\n    End Select\n        \nEnd Function\n\nFunction TM_ListAllGroups(Feld As control, ID As Variant, zeile As Variant, spalte As Variant, code As Variant) As Variant\n'\n'    Name: TM_ListAllGroups\n'   Zweck: Callback-Funktion als Datenquelle für Listen- oder Kombinationsfelder\n'          Liefert alle Gruppen\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: - Wert für Callback-Funktion\n'\n'  Output: - Wert für Callback-Funktion\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_TM_ListAllGroups\n\n    'Variablen deklarieren\n    Static i As Integer\n    Dim Rueckgabewert As Variant\n    Dim wrk As DAO.Workspace\n    \n    Set wrk = DBEngine.Workspaces(0)\n    \n    Select Case code\n        Case acLBInitialize\n            i = wrk.Groups.Count\n            Rueckgabewert = i\n        Case acLBOpen\n            Rueckgabewert = Timer\n        Case acLBGetRowCount\n            Rueckgabewert = i\n        Case acLBGetColumnCount\n            Rueckgabewert = 1\n        Case acLBGetColumnWidth\n            Rueckgabewert = -1\n        Case acLBGetValue\n            Rueckgabewert = wrk.Groups(zeile).Name\n        Case acLBGetFormat\n        Case acLBEnd\n    End Select\n    TM_ListAllGroups = Rueckgabewert\n\n'Ende\nExit_TM_ListAllGroups:\n    On Error Resume Next\n    wrk.Close\n    Set wrk = Nothing\n    Exit Function\n\n'Fehlerbehandlung\nErr_TM_ListAllGroups:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_TM_ListAllGroups\n    End Select\n        \nEnd Function\n\nFunction ListAllUsers(Feld As control, ID As Variant, zeile As Variant, spalte As Variant, code As Variant) As Variant\n'\n'    Name: ListAllUsers\n'   Zweck: Callback-Funktion als Datenquelle für Listen- oder Kombinationsfelder\n'          Liefert alle Benutzer\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 19.07.2003\n' Version: 1.0\n'\n'   Input: - Wert für Callback-Funktion\n'\n'  Output: - Wert für Callback-Funktion\n'\n'Benötigt: Verweis auf DAO 3.6\n'\n'Komment.: -\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_ListAllUsers\n\n    'Variablen deklarieren\n    Static i As Integer\n    Dim Rueckgabewert As Variant\n    Dim wrk As DAO.Workspace\n    \n    Set wrk = DBEngine.Workspaces(0)\n    \n    Select Case code\n        Case acLBInitialize\n            i = wrk.Users.Count\n            Rueckgabewert = i\n        Case acLBOpen\n            Rueckgabewert = Timer\n        Case acLBGetRowCount\n            Rueckgabewert = i\n        Case acLBGetColumnCount\n            Rueckgabewert = 1\n        Case acLBGetColumnWidth\n            Rueckgabewert = -1\n        Case acLBGetValue\n            Rueckgabewert = wrk.Users(zeile).Name\n        Case acLBGetFormat\n        Case acLBEnd\n    End Select\n    ListAllUsers = Rueckgabewert\n\n'Ende\nExit_ListAllUsers:\n    On Error Resume Next\n    wrk.Close\n    Set wrk = Nothing\n    Exit Function\n\n'Fehlerbehandlung\nErr_ListAllUsers:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_ListAllUsers\n    End Select\n        \nEnd Function\n\nFunction ListUsersOfaGroup(Feld As control, ID As Variant, zeile As Variant, spalte As Variant, code As Variant) As Variant\n'\n'    Name: ListUsersOfaGroup\n'   Zweck: Callback-Funktion als Datenquelle für Listen- oder Kombinationsfelder\n'          Liefert alle Benutzer einer Gruppe\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 26.02.2004\n' Version: 1.1\n'\n'   Input: - Wert für Callback-Funktion\n'\n'  Output: - Wert für Callback-Funktion\n'\n'Benötigt: Verweis auf DAO 3.6\n'          Formular mit Kombinationsfeld \"cboGruppen\"\n'\n'Komment.: Diese Funktion in den Quellcode eines Formulars\n'          kopieren das ein Feld mit der Gruppe enthält\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_ListUsersOfaGroup\n\n    'Variablen deklarieren\n    Static i As Integer\n    Dim Rueckgabewert As Variant\n    Dim wrk As DAO.Workspace\n    Dim gruppen As String\n    'gruppen = Me!cboGruppen\n    Set wrk = DBEngine.Workspaces(0)\n    \n    Select Case code\n        Case acLBInitialize\n            wrk.Groups(gruppen).Users.Refresh\n            i = wrk.Groups(gruppen).Users.Count\n            Rueckgabewert = i\n        Case acLBOpen\n            Rueckgabewert = Timer\n        Case acLBGetRowCount\n            Rueckgabewert = i\n        Case acLBGetColumnCount\n            Rueckgabewert = 1\n        Case acLBGetColumnWidth\n            Rueckgabewert = -1\n        Case acLBGetValue\n            Rueckgabewert = wrk.Groups(gruppen).Users(zeile).Name\n        Case acLBGetFormat\n        Case acLBEnd\n    End Select\n    ListUsersOfaGroup = Rueckgabewert\n\n'Ende\nExit_ListUsersOfaGroup:\n    On Error Resume Next\n    wrk.Close\n    Set wrk = Nothing\n    Exit Function\n\n'Fehlerbehandlung\nErr_ListUsersOfaGroup:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_ListUsersOfaGroup\n    End Select\n        \nEnd Function\n\nFunction ListGroupsOfaUser(Feld As control, ID As Variant, zeile As Variant, spalte As Variant, code As Variant) As Variant\n'\n'    Name: ListGroupsOfaUser\n'   Zweck: Callback-Funktion als Datenquelle für Listen- oder Kombinationsfelder\n'          Liefert alle Gruppen eines Users\n'\n'   Autor: Thomas Möller\n'          Access@Team-Moeller.de\n'\n'Erstellt: 19.07.2003\n'  Update: 26.02.2004\n' Version: 1.1\n'\n'   Input: - Wert für Callback-Funktion\n'\n'  Output: - Wert für Callback-Funktion\n'\n'Benötigt: Verweis auf DAO 3.6\n'          Formular mit Kombinationsfeld \"cboGruppen\"\n'\n'Komment.: Diese Funktion in den Quellcode eines Formulars\n'          kopieren das ein Feld mit dem Benutzer enthält\n'\n'Fehlerbehandlung definieren\nOn Error GoTo Err_ListGroupsOfaUser\n\n    'Variablen deklarieren\n    Static i As Integer\n    Dim Rueckgabewert As Variant\n    Dim wrk As DAO.Workspace\n    Dim benutzer As String\n    'benutzer = Me!cboBenutzer\n    Set wrk = DBEngine.Workspaces(0)\n    \n    Select Case code\n        Case acLBInitialize\n            i = wrk.Users(benutzer).Groups.Count\n            Rueckgabewert = i\n        Case acLBOpen\n            Rueckgabewert = Timer\n        Case acLBGetRowCount\n            Rueckgabewert = i\n        Case acLBGetColumnCount\n            Rueckgabewert = 1\n        Case acLBGetColumnWidth\n            Rueckgabewert = -1\n        Case acLBGetValue\n            Rueckgabewert = wrk.Users(benutzer).Groups(zeile).Name\n        Case acLBGetFormat\n        Case acLBEnd\n    End Select\n    ListGroupsOfaUser = Rueckgabewert\n\n'Ende\nExit_ListGroupsOfaUser:\n    On Error Resume Next\n    wrk.Close\n    Set wrk = Nothing\n    Exit Function\n\n'Fehlerbehandlung\nErr_ListGroupsOfaUser:\n    Select Case err.Number\n        Case 0    'Wenn's kein Fehler war\n            Resume Next\n        Case Else 'Fehlermeldung anzeigen\n            MsgBox err.description, vbCritical, err.Number\n            Resume Exit_ListGroupsOfaUser\n    End Select\n        \nEnd Function\n\n"}
