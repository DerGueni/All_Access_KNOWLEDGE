{"id":"MOD_mdlCreateTextFromMDB_CL","name":"mdlCreateTextFromMDB_CL","kind":"standard","procedures":["Public Function DocDatabaseCrea_CL(Optional DaBaPath As String = \"\")","Private Function Path_erzeugen(ByVal Pathnamen As String, Optional IsWarnBeforeCreate As Boolean = False, Optional IsWarnOnErr As Boolean = True) As Boolean","Private Function Dir_Exist(ByVal pPfad As String) As Boolean"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n\n' Author Arvin Meyer\n' Enhancements: Klaus Oberdalhoff\n\n'################## IMPORTANT - WICHTIG ##############\n' On recreation of the mdb, the processs would stop if you would\n' try to override the module which is currently used\n\n' This (the own) modulename must be named like this\n\nPrivate Const CONST_mdlCreateTxtFromMDB As String = \"mdlCreateTxtFromMDB\"\n'#####################################################\n\n'Private Const Const_DaBaPath As String = \"C:\\dabadoc\\\"\n\nPublic gl_DaBaPath As String\n\nPrivate Declare PtrSafe Function MakePath Lib \"imagehlp.dll\" Alias _\n    \"MakeSureDirectoryPathExists\" (ByVal lpPath As String) As Long\n\nPublic Function DocDatabaseCrea_CL(Optional DaBaPath As String = \"\")\n '====================================================================\n ' Name:    DocDatabase\n ' Purpose: Documents the database to a series of text files\n '\n ' Author:  Arvin Meyer\n ' Date:    June 02, 1999\n ' Comment: Uses the undocumented [Application.SaveAsText] syntax\n '          To reload use the syntax [Application.LoadFromText]\n '====================================================================\nOn Error GoTo Err_DocDatabase\nDim dbs As DAO.Database\nDim cnt As Container\nDim doc As Document\nDim i As Integer\n\nIf Len(Trim(Nz(DaBaPath))) = 0 Then\n    DaBaPath = Left(CurrentDb.Name, Len(CurrentDb.Name) - Len(Dir(CurrentDb.Name))) & \"DaBaDoc\\\"\nEnd If\n\nIf Right(DaBaPath, 1) <> \"\\\" Then DaBaPath = DaBaPath & \"\\\"\n\ngl_DaBaPath = DaBaPath\n\nCall Path_erzeugen(DaBaPath & \"frm\\\", , True)\nCall Path_erzeugen(DaBaPath & \"rpt\\\", , True)\n'Call Path_erzeugen(DaBaPath & \"mac\\\", , True)\nCall Path_erzeugen(DaBaPath & \"mdl\\\", , True)\n'Call Path_erzeugen(DaBaPath & \"qry\\\", , True)\n\nOn Error Resume Next\nKill DaBaPath & \"frm\\*.*\"\nKill DaBaPath & \"rpt\\*.*\"\nKill DaBaPath & \"mdl\\*.*\"\nOn Error GoTo 0\n\nSet dbs = CurrentDb() ' use CurrentDb() to refresh Collections\n\nSet cnt = dbs.Containers(\"Forms\")\nFor Each doc In cnt.Documents\n    Application.SaveAsText acForm, doc.Name, DaBaPath & \"frm\\\" & doc.Name & \".txt\"\nNext doc\n\nSet cnt = dbs.Containers(\"Reports\")\nFor Each doc In cnt.Documents\n    Application.SaveAsText acReport, doc.Name, DaBaPath & \"rpt\\\" & doc.Name & \".txt\"\nNext doc\n\n'Set cnt = Dbs.Containers(\"Scripts\")\n'For Each doc In cnt.Documents\n'    Application.SaveAsText acMacro, doc.Name, DaBaPath & \"mac\\\" & doc.Name & \".txt\"\n'Next doc\n\nSet cnt = dbs.Containers(\"Modules\")\nFor Each doc In cnt.Documents\n    If Not doc.Name = CONST_mdlCreateTxtFromMDB Then\n        Application.SaveAsText acModule, doc.Name, DaBaPath & \"mdl\\\" & doc.Name & \".txt\"\n    Else\n        Application.SaveAsText acModule, doc.Name, DaBaPath & \"mdl\\\" & doc.Name & \".txx\"\n    End If\nNext doc\n\n'For I = 0 To Dbs.QueryDefs.Count - 1\n'    Application.SaveAsText acQuery, Dbs.QueryDefs(I).Name, DaBaPath & \"qry\\\" & Dbs.QueryDefs(I).Name & \".txt\"\n'Next I\n\nSet doc = Nothing\nSet cnt = Nothing\nSet dbs = Nothing\n\nExit_DocDatabase:\n    Exit Function\n\n\nErr_DocDatabase:\n    Select Case err\n\n    Case Else\n        MsgBox err.description\n        Resume Exit_DocDatabase\n    End Select\n\nEnd Function\n\n\n\nPrivate Function Path_erzeugen(ByVal Pathnamen As String, Optional IsWarnBeforeCreate As Boolean = False, Optional IsWarnOnErr As Boolean = True) As Boolean\n' Path mit mehreren Subs auf einmal erzeugen\n' Idee aus VB-Tips & Tricks in der BasicWorld\n' www.basicworld.com\n' Der optionale Parameter NoIsWarnOnErr wird als \"False\" interpretiert, wenn nicht vorhanden.\n' Wenn IsWarnOnErr = False, dann wird keine Fehlermeldungs-Messagebox ausgegeben\n' Wenn IsWarnBeforeCreate = True, dann wird gefragt, ob das Directory erzeugt werden soll, wenn es nicht existiert.\n' Wenn versucht wird, ein Directory anzulegen, das bereits existiert, so erfolgt keine Fehlermeldung\n\n' Declare PtrSafe Function MakePath Lib \"imagehlp.dll\" Alias _\n'    \"MakeSureDirectoryPathExists\" (ByVal lpPath As String) As Long\n\n  \nDim nix\n  \n'Pfadnamen muß immer mit einem \"\\\" enden\nIf Right(Pathnamen, 1) <> \"\\\" Then\n    Pathnamen = Pathnamen & \"\\\"\nEnd If\n\nnix = Dir(Pathnamen, vbDirectory)\n\nIf IsWarnBeforeCreate And Len(Nz(nix)) = 0 Then ' Pfad existiert nicht und Warnungs-MsgBox on\n    nix = MsgBox(\"Verzeichnis existiert nicht, soll es erstellt werden ?\", vbQuestion + vbOKCancel, _\n                  \"Verzeichnis erstellen\")\n    If nix = vbCancel Then 'Abbruch der Funktion\n        Path_erzeugen = False\n        Exit Function\n    End If\nEnd If\n        \n'Pfad erstellen\nIf MakePath(Pathnamen) = 0 Then\n    If IsWarnOnErr Then\n        Path_erzeugen = False\n        MsgBox \"Verzeichnis konnte nicht erstellt werden.\", vbCritical\n    End If\nElse\n    Path_erzeugen = True\nEnd If\n\n    \nEnd Function\n\n'**********************************************************************************\n'Function Dir_Exist ()\n'\n'   Überprüft, ob das Directory vorhanden ist\n'   Rückgabe:  True, Directory vorhanden\n'              False, Directory nicht vorhanden\n'   Autor: Thomas Schremser\n'**********************************************************************************\nPrivate Function Dir_Exist(ByVal pPfad As String) As Boolean\n   On Error Resume Next\n   Dir_Exist = GetAttr(pPfad) And vbDirectory\nEnd Function\n"}
