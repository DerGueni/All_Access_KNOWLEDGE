{"id":"MOD_mdlSonstigesJaNein","name":"mdlSonstigesJaNein","kind":"standard","procedures":["Function Is64Bit() As Boolean","Function fIsCreated(strMenuName) As Boolean","Function IsReplica(dbs As DAO.Database) As Boolean","Function IsMDE(dbs As DAO.Database) As Boolean","Function IsRuntime()","Public Function IsSubForm(Optional frm) As Boolean","Function isFormLoad(frm As String) As Boolean","Function IsReportLoad(RName As String) As Boolean","Function isTableLoad(tbl As String) As Boolean","Function IsRunning() As Boolean","Private Function TestDDELink(ByVal strAppName$) As Integer","Function IsOffice97PgmLoad(Programm As String) As Boolean","Function ControlExist(obj As Object, tstname As String) As Boolean","Function table_exist(tableName As String) As Boolean","Function File_exist(ByVal sFile As String) As Boolean","Function Dir_Exist(ByVal pPfad As String) As Boolean","Function RecordsExist(RecSourceName As String, Optional XMdb As String) As Boolean","Function ObjectExists(strObjectType As String, strObjectName As String) As Boolean","Function File_Lock(ByVal file As String) As Integer","Public Function Check_Email_Adress(sEMailAdr As String) As Boolean","Function IsDateBetween2Dates(VglDate As Date, StartDate As Date, EndDate As Date) As Boolean","Function Test_IsDateBetween2Dates()"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":["DLookUp(\"AnzDatum\", strSQL)"],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n\n' Funktionen, die nur True oder False / Ja oder Nein zurückgeben\n\n'#########################################################################################################\n\n'   IsSounddriverOK    - Ist der Sounddriver installiert ?\n'   Is64Bit            - True wennn 64 bit\n'   fIsCreated         - Gibt´s die Menüleiste (Buttonleiste) ?\n'   IsReplica          - Ist die Datenbank ein Replikat ?\n'   IsMDE              - Ist die Datenbank eine (echte) MDE\n'   IsRuntime          - Ist Access als Runtime gestartet oder nicht ?\n'   IsSubForm          - Bestimmt, ob das angegebene bzw. aktive Formular momentan ein Unterformular ist.\n'   isFormLoad         - Ist die Form geladen ?\n'   isTableLoad        - Ist die Tabelle geladen ? (Nur nicht eingebundene Tabellen, keine Queries)\n'   IsReportLoad       - Ist der Report geladen ?\n'   IsRunning          - Ist Access bereits gestartet ?\n'   IsOffice97PgmLoad  - Ist ein anderes Office 97 Programm geladen ?\n'\n'   ControlExist       - Existiert das Control\n'   Table_Exist        - Gibt´s die Tabelle ? (Auch eingebundene Tabellen und Queries)\n'   File_Exist         - Gibt´s die Datei ?\n'   Dir_Exist          - Existiert das Directory\n'   RecordsExist       - Enthält der RecordSet Daten ?\n'   ObjectExists       - Existiert das Objekt (Table, Query, Makro, Report, Modul)\n'   File_Lock          - Kann die Datei gelockt werden ?\n'   IsQry              - Ist die übergebene Tabelle eine Abfrage ? True = Es ist eine Abfrage\n'   IsDateBetween2Dates - Liegt ein Datum zwischen zwei Datumswerten ?\n\n'#########################################################################################################\n\n'**********************************************************************************\n' Deklaration: Ist Soundtreiber installiert ?\n' 1 = Ja, 0 = Nein\n' Aber auch ein installierter Soundtreiber funktioniert nur, wenn auch\n' Boxen angeschlossen sind. Dies kann (natürlich) nicht geprüft werden.\n' Usage: ... If IsSounddriverOK() Then\n' aus www.basicworld.com\n'**********************************************************************************\nDeclare PtrSafe Function IsSounddriverOK Lib \"winmm.dll\" Alias \"waveOutGetNumDevs\" () As Long\n\nFunction Is64Bit() As Boolean\n\nIs64Bit = False\n#If Win64 Then\n    Is64Bit = True\n#End If\n\nEnd Function\n\nFunction fIsCreated(strMenuName) As Boolean\n'gefunden in der CRSOFT MDB\nOn Error GoTo fIsCreated_Err '8/23/98 8:19:54 PM\nDim intNumberMenus As Integer\nDim i As Integer\nintNumberMenus = Application.CommandBars.Count\nfIsCreated = False\nFor i = 1 To intNumberMenus\n    If Application.CommandBars(i).Name = strMenuName Then\n        fIsCreated = True\n        i = intNumberMenus\n    End If\nNext\nExitfIsCreated:\n    Exit Function\nfIsCreated_Err:\n    MsgBox \"fIsCreated: \" & err.Number & vbCrLf _\n    & err.description, vbInformation, \"CRSOFT\"\n    Resume ExitfIsCreated\nEnd Function\n\n\nFunction IsReplica(dbs As DAO.Database) As Boolean\n'gefunden in der CRSOFT MDB\n    On Error Resume Next\nIf dbs.Properties(\"Replicable\") = \"T\" Then\n    If err = 3270 Then\n    ' This is not a replica. Let startup form display.\n    IsReplica = False\n    Else\n    ' This database is a Design Master or a replica so\n    ' close the splash screen before it displays.\n    IsReplica = True\n    End If\nEnd If\nEnd Function\n\n\nFunction IsMDE(dbs As DAO.Database) As Boolean\n    Dim strMDE As String\n    On Error Resume Next\n    strMDE = dbs.Properties(\"MDE\")\n    If err = 0 And strMDE = \"T\" Then\n        ' This is an MDE database.\n        IsMDE = True\n    Else\n        IsMDE = False\n    End If\nEnd Function\n\n\nFunction IsRuntime()\n'The following example demonstrates how to create a function called\n'IsRunTime() that you can use to prevent an application from being run\n'in the retail version of Microsoft Access.\n' aus MSKB Q103182\n'\n         On Error GoTo ErrIsRuntime\n         IsRuntime = SysCmd(6)\n \nByeIsRuntime:\n         Exit Function\n \nErrIsRuntime:\n         If (err = 5) Then\n            IsRuntime = False\n         Else\n            Error err\n         End If\n         Resume ByeIsRuntime\n      \nEnd Function\n\n\n'------------------------------------------------------------------------\n' FUNKTION  : IsSubForm(...)\n' ZWECK     : Bestimmt, ob das angegebene bzw. aktive Formular momentan ein Unterformular ist.\n' ARGUMENTE : (frm) = zu überprüfendes Formularobjekt\n' ERGEBNIS  : true = das Formular ist ein Unterformular, false = sonst\n'------------------------------------------------------------------------\nPublic Function IsSubForm(Optional frm) As Boolean\n    Dim StrName As String\n    IsSubForm = False\n    On Error GoTo err_IsSubform\n    If IsMissing(frm) Then Set frm = Screen.ActiveForm\n    StrName = frm.Name        ' Liefert Fehler, falls Fenster kein Formular ist\n    StrName = frm.Parent.Name ' Liefert Fehler, falls Formular kein 'Parent'-Formular hat\n    IsSubForm = True\nerr_IsSubform:\n    On Error GoTo 0\nEnd Function\n\n\n\n'**********************************************************************************\n'Prüft, ob das Formular frm geladen ist\n'\n'Rückgabe: TRUE, Formular ist geladen\n'          FALSE, Formular ist nicht geladen\n'**********************************************************************************\nFunction isFormLoad(frm As String) As Boolean\n    isFormLoad = SysCmd(SYSCMD_GETOBJECTSTATE, acForm, frm)\nEnd Function\n\n\n'**********************************************************************************\n'Prüft, ob der Report RName geladen ist\n'\n'Rückgabe: TRUE, Report ist geladen\n'          FALSE, Report ist nicht geladen\n'**********************************************************************************\nFunction IsReportLoad(RName As String) As Boolean\n    IsReportLoad = SysCmd(SYSCMD_GETOBJECTSTATE, acReport, RName)\nEnd Function\n\n'**********************************************************************************\n'Function isTableLoad ()\n'Prüft, ob die Tabelle in der MDB vorhanden und geladen (geöffnet) ist - nicht für eingebundene Tabellen\n'\n'Rückgabe: TRUE, tbl ist vorhanden und geladen\n'          FALSE, tbl ist nicht vorhanden oder nur eingebunden\n'**********************************************************************************\nFunction isTableLoad(tbl As String) As Boolean\n    isTableLoad = SysCmd(SYSCMD_GETOBJECTSTATE, acTable, tbl)\nEnd Function\n\n\n'**********************************************************************************\n' Diese Funktion ermittelt, ob ACCESS bereits aktiv ist\n' Sofern IsRunning in einer ZWEITEN Instanz von ACCESS aufgerufen wird\n' gibt IsRunning -1 (True) zurück\n' Sofern nur eine Instanz von ACCESS geladen ist, wird 0 (False) zurückgegeben\n'**********************************************************************************\nFunction IsRunning() As Boolean\n    Dim db As DAO.Database\n    Set db = CurrentDb()\n    If TestDDELink(db.Name) Then\n        IsRunning = -1\n    Else\n        IsRunning = 0\n    End If\nEnd Function\n\n' Helper Function\nPrivate Function TestDDELink(ByVal strAppName$) As Integer\n    \n    Dim varDDEChannel\n    On Error Resume Next\n    Application.SetOption (\"Ignore DDE Requests\"), True\n    varDDEChannel = DDEInitiate(\"MSAccess\", strAppName)\n    \n   ' When the app isn't already running this will error\n    If err Then\n       TestDDELink = False\n    Else\n        TestDDELink = True\n        DDETerminate varDDEChannel\n        DDETerminateAll\n    End If\n    Application.SetOption (\"Ignore DDE Requests\"), False\n\nEnd Function\n\n\nFunction IsOffice97PgmLoad(Programm As String) As Boolean\n'*********************\n' Stellt fest, ob eines der Office 97 Programme geladen ist\n' Programm = Access, OfficeBinder, Excel, Graph, PowerPoint, Office, Outlook, Word\n' Aufruf z.B: If IsOffice97PgmLoad(\"Word\") Then ...\n' Derivat aus Auto97.hlp von KObd\n'*********************\n'\n'                         Eingebund.    Programm\n'Programmname        Vers Referenz      Class         Class Name\n'------------------------------------------------------------------------------\n'Microsoft Access     97  MSACC8.OLB    Access        Access 8.0 Object Library\n'Microsoft Binder     97  MSBDR8.OLB    OfficeBinder  Binder 8.0 Object Library\n'Microsoft Excel      97  EXCEL8.OLB    Excel         Excel 8.0 Object Library\n'Microsoft Graph      97  GRAPH8.OLB    Graph         Graph 8.0 Object Library\n'Microsoft PowerPoint 97  MSPPT8.OLB    PowerPoint    PowerPoint 8.0 Object Library\n'Microsoft Office     97  MSO97.DLL     Office        Office 8.0 Object Library\n'Microsoft Outlook    97  MSOUTL8.OLB   Outlook       Outlook 8.0 Object Library\n'Microsoft Outlook    98  MSOUTL85.OLB  Outlook       Outlook 98 - Objekt Modell\n'Microsoft Word       97  MSWORD8.OLB   Word          Word 8.0 Object Library\n   \n    Dim obj As Object\n    \n    On Error Resume Next\n\n    IsOffice97PgmLoad = False\n    Set obj = GetObject(, Programm & \".Application.8\")  ' nach \"Programm\" suchen\n    IsOffice97PgmLoad = (err.Number = 0)\n    Set obj = Nothing\n    \nEnd Function\n\n\nFunction ControlExist(obj As Object, tstname As String) As Boolean\n'Abgewandelte Funktion aus der Access-Hilfe\n'Kobd@gmx.de\n    Dim ctl As control\n    ControlExist = False\n\n    ' Controls-Auflistung durchlaufen.\n    For Each ctl In obj.controls\n        ' Prüfen, ob das Steuerelement ein Textfeld ist.\n        If ctl.Name = tstname Then\n            ControlExist = True\n            Exit Function\n        End If\n    Next ctl\nEnd Function\n\n\nFunction table_exist(tableName As String) As Boolean\n'**********************************************************************************\n'Function Table_Exist()\n'Prüft, ob die Tabelle in der MDB vorhanden ist\n'auch für eingebundene Tabellen oder Queries\n'\n'Rückgabe: TRUE, tbl ist vorhanden oder eingebunden\n'          FALSE, tbl ist nicht vorhanden\n'**********************************************************************************\n\nDim db As DAO.Database\nDim tbl As DAO.Recordset\nDim nix\n\nOn Error GoTo table_exist_error\n\n    Set db = CurrentDb\n    Set tbl = db.OpenRecordset(tableName)\n    table_exist = True\n    Set tbl = Nothing\n    Exit Function\n\ntable_exist_error:\n    table_exist = False\n    Set tbl = Nothing\n    Exit Function\n\nEnd Function\n\n\n'**********************************************************************************\n'Function File_Exist ()\n'\n'   Überprüft, ob die Datei vorhanden ist\n'   Rückgabe:  True, Datei vorhanden\n'              False, Datei nicht vorhanden\n'**********************************************************************************\nFunction File_exist(ByVal sFile As String) As Boolean\n\n  Dim Size As Long\n  On Error Resume Next\n  Size = fileLen(sFile)\n  File_exist = (err = 0)\n  On Error GoTo 0\n\n'\n'Dim F\n'\n'F = FreeFile\n'On Error GoTo File_existError\n'Open file For Input Access Read As #F\n'Close #F\n'File_exist = True\n'Exit Function\n'\n'File_existError:\n'File_exist = False\n'Exit Function\n'\nEnd Function\n\n\n'**********************************************************************************\n'Function Dir_Exist ()\n'\n'   Überprüft, ob das Directory vorhanden ist\n'   Rückgabe:  True, Directory vorhanden\n'              False, Directory nicht vorhanden\n'   Autor: Thomas Schremser\n'**********************************************************************************\nFunction Dir_Exist(ByVal pPfad As String) As Boolean\n   On Error Resume Next\n   Dir_Exist = GetAttr(pPfad) And vbDirectory\nEnd Function\n\n\nFunction RecordsExist(RecSourceName As String, Optional XMdb As String) As Boolean\n\n' Abgewandeltes Beispiel aus AUTO97.HLP\n' Enthält der RecordSet Daten ?\n'Determining if a RecordSet Contains Any Records\n'\n'This example demonstrates how to determine if a RecordSet contains any records.\n'The function accepts a string argument as the name of a table, query, or\n'SQL statement to open a RecordSet with.  Then, the function examines the BOF\n'and EOF properties to determine if any records exist.  The function returns a\n'True value if records exist, and a False value if no records exist.\n\n    Dim ws As DAO.Workspace\n    Dim db As DAO.Database\n    Dim rs As DAO.Recordset\n    Dim OpenOwn As Boolean\n    \n    On Error Resume Next\n    OpenOwn = False\n    \n    If Len(Trim(Nz(XMdb))) = 0 Then     ' 0 = Eigene MDB verwenden\n        Set db = CurrentDb\n        OpenOwn = True\n    Else\n        If File_exist(XMdb) Then    ' Function aus mdlSonstiges\n            Set ws = DBEngine(0)\n            Set db = ws.OpenDatabase(XMdb)\n        Else\n            MsgBox \"Die Datenbank existiert nicht\", vbCritical, \"Falsche Übergabe\"\n            Exit Function\n        End If\n    End If\n    \n    On Error GoTo Err_RecordsExist\n    \n    Set rs = db.OpenRecordset(RecSourceName, dbOpenDynaset)\n    RecordsExist = Not ((rs.BOF) And (rs.EOF))\n    rs.Close\n    If Not OpenOwn Then\n        Set ws = Nothing\n        db.Close\n    End If\n\nExit_RecordsExist:\n    Exit Function\n\nErr_RecordsExist:\n    If err.Number = \"3078\" Then       ' - Recordset nicht gefunden\n        MsgBox \"Der Recordset existiert nicht\", vbCritical, \"Falsche Übergabe\"\n    Else\n        MsgBox \"Unerwartete Reaktion des Programms, \" & err.Number, vbCritical, \"Falsche Übergabe\"\n    End If\n    GoTo Exit_RecordsExist\n\nEnd Function\n\n\nFunction ObjectExists(strObjectType As String, strObjectName As String) As Boolean\n' Pass the Object type: Table, Query, Form, Report, Macro, or Module\n' Pass the Object Name\n     Dim db As DAO.Database\n     Dim tbl As DAO.TableDef\n     Dim QRY As DAO.QueryDef\n     Dim i As Integer\n     \n     Set db = CurrentDb()\n     ObjectExists = False\n     \n     If strObjectType = \"Table\" Then\n          For Each tbl In db.TableDefs\n               If tbl.Name = strObjectName Then\n                    ObjectExists = True\n                    Set db = Nothing\n                    Exit Function\n               End If\n          Next tbl\n     ElseIf strObjectType = \"Query\" Then\n          For Each QRY In db.QueryDefs\n               If QRY.Name = strObjectName Then\n                    ObjectExists = True\n                    Set db = Nothing\n                    Exit Function\n               End If\n          Next QRY\n     ElseIf strObjectType = \"Form\" Or strObjectType = \"Report\" Or strObjectType = \"Module\" Then\n          For i = 0 To db.Containers(strObjectType & \"s\").Documents.Count - 1\n               If db.Containers(strObjectType & \"s\").Documents(i).Name = strObjectName Then\n                    ObjectExists = True\n                    Set db = Nothing\n                    Exit Function\n               End If\n          Next i\n     ElseIf strObjectType = \"Macro\" Then\n          For i = 0 To db.Containers(\"Scripts\").Documents.Count - 1\n               If db.Containers(\"Scripts\").Documents(i).Name = strObjectName Then\n                    ObjectExists = True\n                    Set db = Nothing\n                    Exit Function\n               End If\n          Next i\n     Else\n          MsgBox \"Invalid Object Type passed, must be Table, Query, Form, Report, Macro, or Module\"\n     End If\n\nSet db = Nothing\n     \nEnd Function\n\n\n'**********************************************************************************'\n'Function File_Lock ()\n'\n'   Überprüft, ob die Datei zum schreiben geöffnet werden kann\n'   Rückgabe: True, Datei kann zum schreiben geöffnet werden\n'             False, Datei kann nicht zum schreiben geöffnet werden\n'**********************************************************************************\nFunction File_Lock(ByVal file As String) As Integer\nDim f\n\nf = FreeFile\nOn Error GoTo File_lockError\nOpen file For Append Access Write Lock Read Write As #f\nClose #f\nFile_Lock = False\nExit Function\n\nFile_lockError:\nFile_Lock = True\nExit Function\n\nEnd Function\n\nPublic Function Check_Email_Adress(sEMailAdr As String) As Boolean\n'Autor:  Matthias Zirngibl\n'Beschreibung\n'Dieser Tipp prüft eine EMail-Adresse auf Gütligkeit.\n'Zunächst wird geprüft, ob das @-Zeichen und mindestens 1 Punkt\n'vorhanden sind. Dann wird geprüft, ob es sich bei der angegebenen\n'TopLevel-Domain um eine gültige Domain handelt (z.B. de, com, at, org).\n'Ist die Domain in der Liste vorhanden, handelt es sich zumindest der\n'Syntax nach um eine gültige EMail-Adresse.\n\n'Prüft eine EMail-Adresse auf Gültigkeit\n    \n  Dim bGoodAdress As Boolean\n  Dim sTopLevelDomainsArray() As String\n  Dim sTopLevelDomains As String\n  Dim eMailSplices() As String\n  Dim i As Long\n    \n  bGoodAdress = False\n  sEMailAdr = LCase(sEMailAdr)\n    \n  sTopLevelDomains = \"com,net,edu,arpa,org,gov,museum,\" + _\n    \"biz,info,pro,name,aero,coop,ac,ad,ae,af,ag,ai,al,\" + _\n    \"am,an,ao,aq,ar,as,at,au,aw,az,ba,bb,bd,be,bf,bg,\" + _\n    \"bh,bi,bj,bm,bn,bo,br,bs,bt,bv,bw,by,bz,ca,cc,cd,\" + _\n    \"cf,cg,ch,ci,ck,cl,cm,cn,co,cr,cu,cv,cx,cy,cz,de,\" + _\n    \"dj,dk,dm,do,dz,ec,ee,eg,eh,er,es,et,fi,fj,fk,fm,\" + _\n    \"fo,fr,ga,gd,ge,gf,gg,gh,gi,gl,gm,gn,gp,gq,gr,gs,\" + _\n    \"gt,gu,gw,gy,hk,hm,hn,hr,ht,hu,id,ie,il,im,in,io,\" + _\n    \"iq,ir,is,it,je,jm,jo,jp,ke,kg,kh,ki,km,kn,kp,kr,\" + _\n    \"kw,ky,kz,la,lb,lc,li,lk,lr,ls,lt,lu,lv,ly,ma,mc,\" + _\n    \"md,mg,mh,mk,ml,mm,mn,mo,mp,mq,mr,ms,mt,mu,mv,mw,\" + _\n    \"mx,my,mz,na,nc,ne,nf,ng,ni,nl,no,np,nr,nu,nz,om,\" + _\n    \"pa,pe,pf,pg,ph,pk,pl,pm,pn,pr,ps,pt,pw,py,qa,re,\" + _\n    \"ro,ru,rw,sa,sb,sc,sd,se,sg,sh,si,sj,sk,sl,sm,sn,\" + _\n    \"so,sr,st,sv,sy,sz,tc,td,tf,tg,th,tj,tk,tm,tn,to,\" + _\n    \"tp,tr,tt,tv,tw,tz,ua,ug,uk,um,us,uy,uz,va,vc,ve,\" + _\n    \"vg,vi,vn,vu,wf,ws,ye,yt,yu,za,zm,zr,zw\"\n  \n  sTopLevelDomainsArray = Split(sTopLevelDomains, \",\")\n\n  '@-Zeichen prüfen\n  eMailSplices = Split(sEMailAdr, \"@\")\n  If UBound(eMailSplices) <> 1 Then\n    Check_Email_Adress = False\n    Exit Function\n  End If\n\n  '. prüfen\n  eMailSplices = Split(eMailSplices(1), \".\")\n  If UBound(eMailSplices) < 1 Then\n    Check_Email_Adress = False\n    Exit Function\n  End If\n\n  'TopLevel-Domain prüfen\n  For i = 0 To UBound(sTopLevelDomainsArray)\n    If eMailSplices(UBound(eMailSplices)) = _\n     sTopLevelDomainsArray(i) Then\n      bGoodAdress = True\n      Exit For\n    End If\n  Next\n  \n  Check_Email_Adress = bGoodAdress\nEnd Function\n \nFunction IsDateBetween2Dates(VglDate As Date, StartDate As Date, EndDate As Date) As Boolean\n\nDim strSQL As String\nDim i As Long\n\nstrSQL = \"\"\nstrSQL = \"SELECT Count([_tblAlleTage].[dtDatum]) AS AnzDatum FROM [_tblAlleTage] WHERE dtDatum Between \" & SQLDatum(StartDate) & \" AND \" & SQLDatum(EndDate) & \" AND dtdatum = \" & SQLDatum(VglDate)\n\ni = Nz(rstDLookUp(\"AnzDatum\", strSQL), 0) * -1\nIsDateBetween2Dates = i\nEnd Function\n\nFunction Test_IsDateBetween2Dates()\nDim dtVgl As Date\nDim dtStart As Date\nDim dtend As Date\n\ndtStart = DateSerial(2015, 2, 1)\ndtend = DateSerial(2015, 2, 28)\n\ndtVgl = DateSerial(2015, 2, 15)\n\nDebug.Print IsDateBetween2Dates(dtVgl, dtStart, dtend)\n\ndtVgl = DateSerial(2015, 3, 1)\n\nDebug.Print IsDateBetween2Dates(dtVgl, dtStart, dtend)\n\nEnd Function\n"}
