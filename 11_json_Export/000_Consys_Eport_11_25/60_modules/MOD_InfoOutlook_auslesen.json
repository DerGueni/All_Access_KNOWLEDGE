{"id":"MOD_InfoOutlook_auslesen","name":"InfoOutlook_auslesen","kind":"standard","procedures":[],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"'    Option Explicit\n'\n'On the next line edit the path to the Access database you want to import to\n'Const ACCESS_FILE_PATH = \"C:\\Kunden\\CONSEC (Siegert)\\PGM\\eMail_Import.accdb\"\n'Const ACCESS_FILE_PATH = \"\\\\Consecpc5\\e\\CONSYS_Backend\\eMail_Import.accdb\"\n'\n'  In Outlook eine Regel erzeugen, die die Betreffzeile, die den Voting-Text enthält, bedient:\n'    Als Regel muss sie folgende Bedingung beinhalten:\n'\n'    '  In Outlook eine Regel erzeugen, die die Betreffzeile, die den Voting-Text enthält, bedient:\n'    '    Als Regel muss sie folgende Bedingung beinhalten:\n'    '\n'    '    Nach Erhalt einer Nachricht\n'    '    die an consec-auftragsplanung@gmx.de gesendet wurde\n'    '    Projekt1.ImportToAccess ausführen\n'    '      und keine weiteren Regeln anwenden\n'    '\n'    '    ----------------------\n'    '\n'    '    Natürlich muss die Tabelle existieren und die korrekten Werte aufweisen, um diesen Insert bedienen zu können  ...\n'    '\n'    '    Ausser ZuAbsage sind alles andere Standard-eMail Felder aus Outlook\n'    '    INSERT INTO tbl_eMail_Import (EntryID, ZuAbsage, Sender, Sendername, Betreff, Body, HTMLBody, CreationTime, ReceivedTime )\n'    '    Mehr Felder braucht man normalerweise nicht .- EntryID und Sender... = String 255, ZuAbsage = Long, ...Body = Memo, ...Time = Date/Time\n'\n'    Sub ImportToAccess(oF As Outlook.mailitem)\n'\n'    'oF ist die aktive eMail, die importiert werden soll...\n'\n'        Dim adoCon As Object\n'        Dim strSQL As String\n'    '    Dim oF As Outlook.Items\n'        Dim iZuAb As Long\n'    '    Dim iVAStart_ID As Long\n'\n'        Dim strBetreff As String\n'\n'    '   Jeglichen Fehler ignorieren und einfach doe Prozedur beenden\n'        On Error GoTo Ende_Sub\n'\n'        Set adoCon = CreateObject(\"ADODB.Connection\")\n'        adoCon.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" & ACCESS_FILE_PATH & \";Persist Security Info=False;\"\n'\n'        adoCon.Execute \"INSERT INTO tbl_eMail_Import (EntryID, Sender, Sendername, Betreff, Body, HTMLBody, CreationTime, ReceivedTime ) VALUES ('\" & oF.EntryID & \"', '\" & oF.SenderEmailAddress & \"', '\" & oF.Sendername & \"', '\" & fCnvQM(oF.Subject) & \"', '\" & fCnvQM(oF.Body) & \"', '\" & fCnvQM(oF.HTMLBody) & \"', \" & DateTimeForSQL(oF.CreationTime) & \", \" & DateTimeForSQL(oF.ReceivedTime) & \")\"\n'    '    oF.Delete\n'\n'        Set adoCon = Nothing\n'\n'    Ende_Sub:\n'\n'    End Sub\n'\n'\n'    Private Function fCnvQM(ByVal strString As String) As String\n'        'Funktion, die Hochkommata - Chr(39) - innerhalb eines Strings verdoppelt,\n'        'um Strings, die Hochkommata beinhalten an SQL-Syntax übergeben zu können\n'\n'        Dim i As Integer\n'        Dim strStringNew As String\n'\n'        For i = 1 To Len(strString)\n'            If Mid(strString, i, 1) = Chr(39) Then\n'                strStringNew = strStringNew & Chr(39) & Chr(39)\n'            Else\n'                strStringNew = strStringNew & Mid(strString, i, 1)\n'            End If\n'        Next i\n'\n'        'Return Value\n'        fCnvQM = strStringNew\n'    End Function\n'\n'    Private Function DateTimeForSQL(dteDate) As String\n'    'Datum incl. Uhrzeit für SQL und INI-Files als String\n'\n'    '  DateTimeForSQL = Format(CDate(dteDate), \"\\#yyyy\\-mm\\-dd h:nn:ss AM/PM \\#\", vbMonday, vbFirstFourDays)\n'      DateTimeForSQL = Format(CDate(dteDate), \"\\#yyyy\\-mm\\-dd hh:nn:ss\\#\", vbMonday, vbFirstFourDays)\n'\n'    End Function\n'\n'\n'"}
