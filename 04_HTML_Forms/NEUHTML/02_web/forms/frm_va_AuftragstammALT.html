<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auftragsverwaltung</title>
    <link rel="stylesheet" href="frm_va_Auftragstamm.css">
    <link rel="stylesheet" href="../theme/consys_theme.css">
</head>
<body>
    <div class="access-form" id="frm_va_Auftragstamm">
        <!-- ========== HEADER SECTION ========== -->
        <header class="form-header">
            <div class="header-left">
                <!-- Menü-Subform Placeholder -->
                <div class="subform-placeholder" id="frm_Menüführung" data-source="Form.frm_Menüführung">
                    <!-- TODO: frm_Menüführung - kein LinkMaster/LinkChild definiert -->
                    <span class="placeholder-label">Menüführung</span>
                </div>
            </div>

            <div class="header-main">
                <!-- Titel und Navigation -->
                <div class="title-row">
                    <label class="form-title" id="Auto_Kopfzeile0">Auftragsverwaltung</label>

                    <div class="nav-buttons">
                        <button type="button" class="btn-nav" id="Befehl43" title="Erster Datensatz">⏮</button>
                        <button type="button" class="btn-nav" id="Befehl41" title="Zurück">◀</button>
                        <button type="button" class="btn-nav" id="Befehl40" title="Vor">▶</button>
                        <button type="button" class="btn-nav" id="btn_letzer_Datensatz" title="Letzter Datensatz">⏭</button>
                        <button type="button" class="btn-nav" id="btn_rueck" title="Rückgängig">↩</button>
                    </div>

                    <button type="button" class="btn-action" id="btnReq">Aktualisieren</button>
                </div>

                <!-- Toolbar Zeile 1 -->
                <div class="toolbar-row">
                    <button type="button" class="btn-action" id="btnSchnellPlan">Mitarbeiterauswahl</button>
                    <button type="button" class="btn-action" id="btn_N_HTMLAnsicht">HTML Ansicht</button>
                    <button type="button" class="btn-action" id="btn_Posliste_öffnen">Positionen</button>
                    <button type="button" class="btn-action" id="Befehl640">Auftrag kopieren</button>
                    <button type="button" class="btn-action" id="btnneuveranst">Neuer Auftrag</button>
                    <button type="button" class="btn-action" id="mcobtnDelete">Auftrag löschen</button>
                </div>

                <!-- Toolbar Zeile 2 -->
                <div class="toolbar-row">
                    <button type="button" class="btn-action" id="btnMailEins">Einsatzliste senden MA</button>
                    <button type="button" class="btn-action" id="btn_Autosend_BOS">Einsatzliste senden BOS</button>
                    <button type="button" class="btn-action" id="btnMailSub">Einsatzliste senden SUB</button>
                    <button type="button" class="btn-action" id="btnDruckZusage">Einsatzliste drucken</button>
                    <button type="button" class="btn-action" id="btn_ListeStd">Namensliste ESS</button>
                </div>

                <!-- Info-Zeile -->
                <div class="info-row">
                    <button type="button" class="btn-small" id="btn_Rueckmeld">Rückmelde-Statistik</button>
                    <button type="button" class="btn-small" id="btnSyncErr">Syncfehler checken</button>

                    <label class="lbl-inline" id="lbl_EL_Autosend">EL Autosend</label>
                    <input type="checkbox" id="cbAutosendEL" data-control-source="Autosend_EL">
                    <button type="button" class="btn-small" id="Befehl709">EL gesendet</button>
                </div>
            </div>

            <div class="header-right">
                <label class="version-label" id="lbl_Version">GPT | TEST</label>
                <label class="date-label" id="lbl_Datum">16.12.2025</label>

                <div class="status-row">
                    <label>Auftragsstatus:</label>
                    <select class="cbo-control" id="Veranst_Status_ID" data-control-source="Veranst_Status_ID">
                        <option value="">-- Status --</option>
                    </select>
                </div>

                <button type="button" class="btn-close" id="Befehl38" title="Schließen">✕</button>
            </div>
        </header>

        <!-- ========== STAMMDATEN SECTION ========== -->
        <section class="stammdaten-section">
            <div class="stammdaten-grid">
                <!-- Zeile 1: Datum, Nr -->
                <div class="field-group">
                    <label>Datum:</label>
                    <input type="text" class="txt-control" id="Dat_VA_Von" data-control-source="Dat_VA_Von" placeholder="Von">
                    <input type="text" class="txt-control" id="Dat_VA_Bis" data-control-source="Dat_VA_Bis" placeholder="Bis">
                </div>
                <div class="field-group">
                    <label>Nr.</label>
                    <input type="text" class="txt-control txt-readonly" id="ID" data-control-source="ID" readonly disabled>
                </div>

                <!-- Zeile 2: Auftrag -->
                <div class="field-group field-wide">
                    <label>Auftrag:</label>
                    <select class="cbo-control cbo-wide" id="Kombinationsfeld656" data-control-source="Auftrag">
                        <option value="">-- Auftrag wählen --</option>
                    </select>
                </div>

                <!-- Zeile 3: Ort -->
                <div class="field-group field-wide">
                    <label>Ort:</label>
                    <select class="cbo-control cbo-wide" id="Ort" data-control-source="Ort">
                        <option value="">-- Ort wählen --</option>
                    </select>
                </div>

                <!-- Zeile 4: Objekt + Datum-Navigation -->
                <div class="field-group field-wide">
                    <label>Objekt:</label>
                    <select class="cbo-control" id="Objekt" data-control-source="Objekt">
                        <option value="">-- Objekt wählen --</option>
                    </select>
                    <select class="cbo-control cbo-small" id="Objekt_ID" data-control-source="Objekt_ID">
                        <option value="">ID</option>
                    </select>
                    <button type="button" class="btn-nav" id="btnDatumLeft">◀</button>
                    <select class="cbo-control" id="cboVADatum">
                        <option value="">-- Datum wählen --</option>
                    </select>
                    <button type="button" class="btn-nav" id="btnDatumRight">▶</button>
                </div>

                <!-- Zeile 5: Treffpunkt, PKW, Fahrtkosten -->
                <div class="field-group">
                    <label>Treffpunkt:</label>
                    <input type="text" class="txt-control txt-time" id="Treffp_Zeit" data-control-source="Treffp_Zeit" placeholder="Zeit">
                    <input type="text" class="txt-control" id="Treffpunkt" data-control-source="Treffpunkt">
                </div>
                <div class="field-group">
                    <label>PKW Anzahl:</label>
                    <input type="text" class="txt-control txt-small" id="PKW_Anzahl" data-control-source="Dummy">
                </div>
                <div class="field-group">
                    <label>Fahrtkosten pro PKW:</label>
                    <input type="text" class="txt-control txt-small" id="Fahrtkosten" data-control-source="Fahrtkosten">
                </div>

                <!-- Zeile 6: Dienstkleidung -->
                <div class="field-group field-wide">
                    <label>Dienstkleidung:</label>
                    <select class="cbo-control cbo-wide" id="Dienstkleidung" data-control-source="Dienstkleidung">
                        <option value="">-- Dienstkleidung wählen --</option>
                    </select>
                </div>

                <!-- Zeile 7: Ansprechpartner -->
                <div class="field-group field-wide">
                    <label>Ansprechpartner:</label>
                    <input type="text" class="txt-control txt-wide" id="Ansprechpartner" data-control-source="Ansprechpartner">
                </div>

                <!-- Zeile 8: Auftraggeber -->
                <div class="field-group field-wide">
                    <label>Auftraggeber:</label>
                    <select class="cbo-control cbo-wide" id="veranstalter_id" data-control-source="Veranstalter_ID">
                        <option value="">-- Auftraggeber wählen --</option>
                    </select>
                </div>
            </div>
        </section>

        <!-- ========== MAIN CONTENT (Tabs + Auftragsliste) ========== -->
        <div class="main-content">
            <!-- Tab-Bereich -->
            <div class="tab-container">
                <!-- Tab-Buttons -->
                <div class="tab-buttons">
                    <button type="button" class="tab-btn active" data-tab="pgMA_Zusage">Einsatzliste</button>
                    <button type="button" class="tab-btn" data-tab="pgMA_Plan">Antworten ausstehend</button>
                    <button type="button" class="tab-btn" data-tab="pgAttach">Zusatzdateien</button>
                    <button type="button" class="tab-btn" data-tab="pgRechnung">Rechnung</button>
                    <button type="button" class="tab-btn" data-tab="pgBemerk" style="display:none;">Bemerkungen</button>
                </div>

                <!-- Tab-Inhalte -->
                <div class="tab-content">
                    <!-- ===== Tab: Einsatzliste ===== -->
                    <div class="tab-pane active" id="pgMA_Zusage">
                        <div class="tab-toolbar">
                            <button type="button" class="btn-action" id="btn_BWN_Druck">BWN drucken</button>
                            <!-- TODO: cmd_Messezettel_NameEintragen, cmd_BWN_send sind hidden -->
                        </div>

                        <div class="einsatzliste-layout">
                            <!-- Linke Spalte: Schichten + Absagen -->
                            <div class="einsatzliste-left">
                                <!-- sub_VA_Start -->
                                <div class="subform-placeholder" id="sub_VA_Start" data-source="Form.sub_VA_Start">
                                    <span class="placeholder-label">Schichten (sub_VA_Start)</span>
                                    <span class="placeholder-link">LinkMaster: ID;cboVADatum</span>
                                </div>

                                <label class="section-label">Absagen:</label>
                                <!-- sub_MA_VA_Planung_Absage -->
                                <div class="subform-placeholder" id="sub_MA_VA_Planung_Absage" data-source="Form.sub_MA_VA_Planung_Absage">
                                    <span class="placeholder-label">Absagen (sub_MA_VA_Planung_Absage)</span>
                                    <span class="placeholder-link">LinkMaster: ID;cboVADatum</span>
                                </div>
                            </div>

                            <!-- Rechte Spalte: MA-Zuordnung -->
                            <div class="einsatzliste-right">
                                <!-- Filter-Bereich (hidden controls) -->
                                <div class="filter-row" style="display:none;">
                                    <label>Filter:</label>
                                    <label>Anstellungsart:</label>
                                    <select class="cbo-control" id="cboAnstArt"></select>
                                    <select class="cbo-control" id="cboQuali"></select>
                                    <input type="checkbox" id="IstVerfügbar">
                                    <label>Nur freie anzeigen</label>
                                </div>

                                <!-- sub_MA_VA_Zuordnung -->
                                <div class="subform-placeholder subform-large" id="sub_MA_VA_Zuordnung" data-source="Form.sub_MA_VA_Zuordnung">
                                    <span class="placeholder-label">MA-Zuordnung (sub_MA_VA_Zuordnung)</span>
                                    <span class="placeholder-link">LinkMaster: ID;cboVADatum</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ===== Tab: Antworten ausstehend ===== -->
                    <div class="tab-pane" id="pgMA_Plan">
                        <label class="section-label">Mitarbeiter geplant:</label>
                        <!-- sub_MA_VA_Zuordnung_Status -->
                        <div class="subform-placeholder subform-full" id="sub_MA_VA_Zuordnung_Status" data-source="Form.sub_MA_VA_Planung_Status">
                            <span class="placeholder-label">MA-Planung Status (sub_MA_VA_Zuordnung_Status)</span>
                            <span class="placeholder-link">LinkMaster: ID;cboVADatum</span>
                        </div>
                    </div>

                    <!-- ===== Tab: Zusatzdateien ===== -->
                    <div class="tab-pane" id="pgAttach">
                        <div class="tab-toolbar">
                            <label class="info-text">Doppelklick auf Dateinamen zeigt Inhalt an bzw. öffnet Office-Pgm</label>
                            <button type="button" class="btn-action" id="btnNeuAttach">Neuen Attach hinzufügen</button>
                        </div>
                        <!-- sub_ZusatzDateien -->
                        <div class="subform-placeholder subform-full" id="sub_ZusatzDateien" data-source="Form.sub_ZusatzDateien">
                            <span class="placeholder-label">Zusatzdateien (sub_ZusatzDateien)</span>
                            <span class="placeholder-link">LinkMaster: Objekt_ID;TabellenNr</span>
                        </div>
                    </div>

                    <!-- ===== Tab: Rechnung ===== -->
                    <div class="tab-pane" id="pgRechnung">
                        <div class="tab-toolbar">
                            <button type="button" class="btn-action" id="btnPDFKopf">Rechnung PDF</button>
                            <button type="button" class="btn-action" id="btnPDFPos">Berechnungsliste PDF</button>
                            <button type="button" class="btn-action" id="btnLoad">Daten laden</button>
                            <button type="button" class="btn-action" id="btnRchLex">Rechnung in Lexware erstellen</button>
                        </div>

                        <label class="section-label">Rechnungspositionen:</label>
                        <!-- sub_rch_Pos -->
                        <div class="subform-placeholder" id="sub_rch_Pos" data-source="Query.zqry_Rch_Pos" style="height: 120px;">
                            <span class="placeholder-label">Rechnungspositionen (sub_rch_Pos)</span>
                            <span class="placeholder-link">LinkMaster: ID</span>
                        </div>

                        <div class="summe-row">
                            <label>Gesamtsumme Netto:</label>
                            <input type="text" class="txt-control txt-readonly" id="PosGesamtsumme" readonly>
                        </div>

                        <label class="section-label">Berechnungsliste:</label>
                        <!-- sub_Berechnungsliste -->
                        <div class="subform-placeholder subform-large" id="sub_Berechnungsliste" data-source="Form.zsub_rch_Berechnungsliste">
                            <span class="placeholder-label">Berechnungsliste (sub_Berechnungsliste)</span>
                            <span class="placeholder-link">LinkMaster: ID</span>
                        </div>
                    </div>

                    <!-- ===== Tab: Bemerkungen (hidden) ===== -->
                    <div class="tab-pane" id="pgBemerk">
                        <textarea class="txt-multiline" id="Bemerkungen" data-control-source="Bemerkungen"></textarea>
                    </div>
                </div>
            </div>

            <!-- Rechte Spalte: Auftragsliste -->
            <aside class="auftragsliste-sidebar">
                <!-- sub_VA_Anzeige -->
                <div class="subform-placeholder" id="sub_VA_Anzeige" data-source="Form.sub_VA_Anzeige" style="height: 80px;">
                    <!-- TODO: sub_VA_Anzeige - kein LinkMaster/LinkChild definiert -->
                    <span class="placeholder-label">VA-Anzeige (sub_VA_Anzeige)</span>
                </div>

                <!-- Filter für Auftragsliste -->
                <div class="filter-bar">
                    <label>Aufträge ab:</label>
                    <input type="text" class="txt-control txt-date" id="Aufträge_ab">
                    <button type="button" class="btn-small" id="btn_AbWann">Go</button>
                    <button type="button" class="btn-small" id="btnTgBack">&lt;&lt;</button>
                    <button type="button" class="btn-small" id="btnTgVor">&gt;&gt;</button>
                    <button type="button" class="btn-small" id="btnHeute">Ab Heute</button>
                    <select class="cbo-control cbo-small" id="cboID">
                        <option value="">ID</option>
                    </select>
                </div>

                <!-- zsub_lstAuftrag -->
                <div class="subform-placeholder subform-full" id="zsub_lstAuftrag" data-source="Form.frm_lst_row_auftrag">
                    <!-- TODO: zsub_lstAuftrag - kein LinkMaster/LinkChild definiert -->
                    <span class="placeholder-label">Auftragsliste (zsub_lstAuftrag)</span>
                </div>
            </aside>
        </div>

        <!-- ========== FOOTER SECTION ========== -->
        <footer class="form-footer">
            <div class="footer-left">
                <label>Erstellt</label>
                <input type="text" class="txt-control txt-small" id="Text416" data-control-source="Erst_von">
                <input type="text" class="txt-control txt-small txt-readonly" id="Text418" data-control-source="Erst_am" readonly disabled>
            </div>
            <div class="footer-right">
                <label>Geändert</label>
                <input type="text" class="txt-control txt-small" id="Text419" data-control-source="Aend_von">
                <input type="text" class="txt-control txt-small txt-readonly" id="Text422" data-control-source="Aend_am" readonly disabled>
            </div>

            <!-- Hidden controls (visible=false in spec) -->
            <div style="display:none;">
                <input type="text" id="Rech_NR" data-control-source="Rech_NR">
                <input type="text" id="PLZ" data-control-source="PLZ">
                <input type="text" id="VerrSatz" data-control-source="Dummy">
                <input type="text" id="TabellenNr" data-control-source="=42">
                <select id="IstStatus"></select>
                <select id="cboEinsatzliste"></select>
                <button id="btnAuftrBerech">Auftrag berechnen</button>
                <button id="btn_änderungsprotokoll">Änderungsprotokoll</button>
                <button id="btnmailpos">Positionsliste senden</button>
                <button id="btnCheck">Aufträge prüfen</button>
                <button id="btnDruckZusage1">Mehrtagesliste drucken</button>
                <button id="btnPlan_Kopie">Daten in Folgetag kopieren</button>
                <button id="btnVAPlanCrea">Liste aktualisieren</button>
                <button id="btn_VA_Abwesenheiten">Abwesenheiten</button>
                <button id="btn_sortieren">sortieren</button>
                <button id="cmd_Messezettel_NameEintragen">BWN Namen</button>
                <button id="cmd_BWN_send">BWN senden</button>
                <button id="btn_Tag_löschen">Tag löschen</button>
            </div>
        </footer>

        <!-- Kleine Utility-Buttons (Ribbon/DaBa) -->
        <div class="utility-buttons">
            <button type="button" class="btn-tiny" id="btnRibbonAus" title="Ribbon aus">R-</button>
            <button type="button" class="btn-tiny" id="btnRibbonEin" title="Ribbon ein">R+</button>
            <button type="button" class="btn-tiny" id="btnDaBaAus" title="DaBa aus">D-</button>
            <button type="button" class="btn-tiny" id="btnDaBaEin" title="DaBa ein">D+</button>
        </div>
    </div>

    <!-- Tab-Wechsel Script -->
    <script>
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                // Deactivate all
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-pane').forEach(p => p.classList.remove('active'));
                // Activate clicked
                this.classList.add('active');
                document.getElementById(this.dataset.tab).classList.add('active');
            });
        });
    </script>
<!-- WebView2 Bridge -->
<script type="module" src="../js/webview2-bridge.js"></script>
</body>
</html>

