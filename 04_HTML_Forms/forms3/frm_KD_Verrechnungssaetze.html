<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verrechnungssaetze - CONSYS</title>
    <link rel="stylesheet" href="consys-common.css">
    <link rel="stylesheet" href="css/fonts_override.css">
    <link rel="stylesheet" href="css/unified-header.css">
    <link rel="stylesheet" href="css/form-titles.css">
    <style>
        :root {
            --base-font-size: 11px;
            --small-font-size: 10px;
            --header-font-size: 12px;
            --title-font-size: 16px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: var(--base-font-size);
        }

        body {
            background-color: #8080c0;
            overflow: hidden;
            height: 100vh;
        }

        .window-frame {
            background-color: #8080c0;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header - Styles werden durch unified-header.css definiert */

        /* Zusaetzliche Button-Styles fuer dieses Formular */
        .btn-green {
            background: linear-gradient(to bottom, #60c060, #308030);
            color: white;
        }

        .btn-green:hover {
            background: linear-gradient(to bottom, #70d070, #409040);
        }

        /* Filter-Bereich */
        .filter-row {
            background-color: #b8b8d8;
            border: 1px solid #606090;
            padding: 8px 12px;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-shrink: 0;
        }

        .filter-row label {
            font-weight: 500;
        }

        .filter-row input[type="text"] {
            border: 1px solid #808080;
            padding: 3px 6px;
            width: 250px;
        }

        /* Content Area */
        .content-area {
            flex: 1;
            padding: 8px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .grid-wrapper {
            flex: 1;
            overflow: auto;
            border: 1px solid #808080;
            background: white;
        }

        /* Data Grid */
        .data-grid {
            width: 100%;
            border-collapse: collapse;
            font-size: var(--base-font-size);
        }

        .data-grid th {
            background: linear-gradient(to bottom, #e0e0e0, #c0c0c0);
            border: 1px solid #808080;
            padding: 6px 8px;
            text-align: left;
            font-weight: bold;
            position: sticky;
            top: 0;
            white-space: nowrap;
            cursor: pointer;
        }

        .data-grid th:hover {
            background: linear-gradient(to bottom, #e8e8e8, #d0d0d0);
        }

        /* Sortier-Indikator */
        .data-grid th.sort-asc::after {
            content: ' â–²';
            font-size: 9px;
        }

        .data-grid th.sort-desc::after {
            content: ' â–¼';
            font-size: 9px;
        }

        .data-grid td {
            border: 1px solid #c0c0c0;
            padding: 4px 8px;
            height: 24px;
        }

        /* Firma-Spalte breiter */
        .data-grid th:first-child,
        .data-grid td:first-child {
            min-width: 250px;
        }

        /* Preis-Spalten rechtsbuendig */
        .data-grid td.price {
            text-align: right;
            font-family: 'Consolas', monospace;
        }

        .data-grid tr:nth-child(even) {
            background: #f8f8ff;
        }

        .data-grid tr:hover {
            background: #e0e0ff;
        }

        .data-grid tr.selected {
            background: #000080;
            color: white;
        }

        /* Status Bar */
        .status-bar {
            background: #c0c0c0;
            border-top: 1px solid #808080;
            padding: 4px 8px;
            display: flex;
            gap: 15px;
            font-size: var(--base-font-size);
            flex-shrink: 0;
        }

        .status-section {
            border: 1px inset #808080;
            padding: 2px 10px;
            background: #e0e0e0;
        }

        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(128, 128, 192, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #fff;
            border-top-color: #000080;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 30px;
            right: 10px;
            z-index: 10000;
        }

        .toast {
            background: #333;
            color: white;
            padding: 10px 20px;
            margin-bottom: 5px;
            border-radius: 4px;
            animation: slideIn 0.3s ease;
        }

        .toast.success { background: #2e7d32; }
        .toast.error { background: #c62828; }
        .toast.warning { background: #f57f17; }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 16px;
            height: 16px;
        }

        ::-webkit-scrollbar-track {
            background: #c0c0c0;
        }

        ::-webkit-scrollbar-thumb {
            background: #a0a0a0;
            border: 1px solid;
            border-color: #e0e0e0 #606060 #606060 #e0e0e0;
        }
    </style>
<link rel="stylesheet" href="css/visbug_overrides.css">
</head>
<body data-form="frm_KD_Verrechnungssaetze">
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <div class="window-frame">
        <!-- Header -->
        <div class="header-row-wrapper">
            <div class="header-row combined-buttons">
                <div class="logo-box">C</div>
                <span class="title-text" style="font-size: 16px; font-weight: bold;">Verrechnungssaetze</span>
                <div class="buttons-grid">
                    <button class="btn unified-btn" onclick="exportToExcel()">Excel Export</button>
                    <button class="btn unified-btn" onclick="printTable()">Drucken</button>
                    <button class="btn unified-btn" onclick="refreshData()">Aktualisieren</button>
                    <button class="btn unified-btn" onclick="closeForm()">Schliessen</button>
                </div>
            </div>
            <div class="gpt-box">CONSYS<span>Web</span></div>
        </div>

        <!-- Filter -->
        <div class="filter-row">
            <label>Kunde:</label>
            <select id="kundenFilter" onchange="filterByKunde()">
                <option value="">-- Alle Kunden --</option>
            </select>
            <label>Suche:</label>
            <input type="text" id="searchInput" placeholder="Firma suchen..." oninput="filterTable()">
            <span id="recordCount">0 Kunden</span>
            <button class="btn unified-btn btn-green" onclick="editSelected()" title="Preise bearbeiten">Bearbeiten</button>
            <button class="btn unified-btn" onclick="deleteSelected()" title="Preise loeschen" style="background: linear-gradient(to bottom, #c06060, #803030); color: white;">Loeschen</button>
        </div>

        <!-- Content -->
        <div class="content-area">
            <div class="grid-wrapper">
                <table class="data-grid" id="preisTable">
                    <thead>
                        <tr>
                            <th data-sort="firma" onclick="sortTable('firma')">Firma</th>
                            <th data-sort="Sicherheitspersonal" onclick="sortTable('Sicherheitspersonal')">SVS</th>
                            <th data-sort="Leitungspersonal" onclick="sortTable('Leitungspersonal')">EL</th>
                            <th data-sort="Nachtzuschlag" onclick="sortTable('Nachtzuschlag')">NZ</th>
                            <th data-sort="Sonntagszuschlag" onclick="sortTable('Sonntagszuschlag')">SZ</th>
                            <th data-sort="Feiertagszuschlag" onclick="sortTable('Feiertagszuschlag')">FZ</th>
                            <th data-sort="Fahrtkosten" onclick="sortTable('Fahrtkosten')">Fahrtkosten</th>
                            <th data-sort="Sonstiges" onclick="sortTable('Sonstiges')">Div.</th>
                        </tr>
                    </thead>
                    <tbody id="preisBody">
                        <!-- Wird dynamisch gefuellt -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Status Bar -->
        <div class="status-bar">
            <span class="status-section" id="statusText">Bereit</span>
            <span class="status-section" id="lastUpdate">-</span>
        </div>
    </div>

    <script src="js/webview2-bridge.js"></script>
    <script src="logic/frm_KD_Verrechnungssaetze.logic.js"></script>
</body>
</html>


