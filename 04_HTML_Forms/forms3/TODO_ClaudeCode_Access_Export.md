# Access-Formulare Export – Nur für vorhandene HTML-Pendants

**Version:** 2.1 (Fokussiert auf existierende HTML-Formulare)  
**Erstellt:** 2026-01-12  
**Scope:** NUR Access-Formulare exportieren, die bereits als HTML in forms3 existieren

---

## Projektübersicht

**Ziel:** Export aller Access-Formular-Eigenschaften, Controls und Events – **NUR für Formulare mit HTML-Pendant**

**Scope:** 
- **37 Hauptformulare** (frm_*, frmTop_*, frmOff_*, zfrm_*)
- **15 Unterformulare** (sub_*)
- **Gesamt: 52 Formulare**

---

## KOMPLETTE LISTE DER ZU EXPORTIERENDEN FORMULARE

### Hauptformulare (37 Stück)

| # | Access-Formularname | HTML-Datei | Kategorie |
|---|---------------------|------------|-----------|
| 1 | frm_va_Auftragstamm | frm_va_Auftragstamm.html | Aufträge |
| 2 | frm_VA_Planungsuebersicht | frm_VA_Planungsuebersicht.html | Aufträge |
| 3 | frm_MA_Mitarbeiterstamm | frm_MA_Mitarbeiterstamm.html | Mitarbeiter |
| 4 | frm_MA_VA_Schnellauswahl | frm_MA_VA_Schnellauswahl.html | Mitarbeiter |
| 5 | frm_MA_VA_Positionszuordnung | frm_MA_VA_Positionszuordnung.html | Mitarbeiter |
| 6 | frm_MA_Offene_Anfragen | frm_MA_Offene_Anfragen.html | Mitarbeiter |
| 7 | frm_MA_Serien_eMail_Auftrag | frm_MA_Serien_eMail_Auftrag.html | Mitarbeiter |
| 8 | frm_MA_Serien_eMail_dienstplan | frm_MA_Serien_eMail_dienstplan.html | Mitarbeiter |
| 9 | frm_MA_Tabelle | frm_MA_Tabelle.html | Mitarbeiter |
| 10 | frm_MA_Adressen | frm_MA_Adressen.html | Mitarbeiter |
| 11 | frm_MA_Abwesenheit | frm_MA_Abwesenheit.html | Mitarbeiter |
| 12 | frm_MA_Zeitkonten | frm_MA_Zeitkonten.html | Mitarbeiter |
| 13 | frm_KD_Kundenstamm | frm_KD_Kundenstamm.html | Kunden |
| 14 | frm_KD_Umsatzauswertung | frm_KD_Umsatzauswertung.html | Kunden |
| 15 | frm_KD_Verrechnungssaetze | frm_KD_Verrechnungssaetze.html | Kunden |
| 16 | frm_Kundenpreise_gueni | frm_Kundenpreise_gueni.html | Kunden |
| 17 | frm_OB_Objekt | frm_OB_Objekt.html | Objekte |
| 18 | frm_DP_Dienstplan_MA | frm_DP_Dienstplan_MA.html | Dienstplan |
| 19 | frm_DP_Dienstplan_Objekt | frm_DP_Dienstplan_Objekt.html | Dienstplan |
| 20 | frm_DP_Einzeldienstplaene | frm_DP_Einzeldienstplaene.html | Dienstplan |
| 21 | frm_Einsatzuebersicht | frm_Einsatzuebersicht.html | Dienstplan |
| 22 | frm_Abwesenheiten | frm_Abwesenheiten.html | Abwesenheit |
| 23 | frm_abwesenheitsuebersicht | frm_abwesenheitsuebersicht.html | Abwesenheit |
| 24 | frm_Angebot | frm_Angebot.html | Dokumente |
| 25 | frm_Rechnung | frm_Rechnung.html | Dokumente |
| 26 | frm_Ausweis_Create | frm_Ausweis_Create.html | Dokumente |
| 27 | frm_N_Bewerber | frm_N_Bewerber.html | Bewerber |
| 28 | frm_Rueckmeldestatistik | frm_Rueckmeldestatistik.html | Statistik |
| 29 | frm_Systeminfo | frm_Systeminfo.html | System |
| 30 | frm_Menuefuehrung1 | frm_Menuefuehrung1.html | Navigation |
| 31 | frmTop_DP_MA_Auftrag_Zuo | frmTop_DP_MA_Auftrag_Zuo.html | Popup |
| 32 | frmTop_Geo_Verwaltung | frmTop_Geo_Verwaltung.html | Popup |
| 33 | frmTop_KD_Adressart | frmTop_KD_Adressart.html | Popup |
| 34 | frmTop_MA_Abwesenheitsplanung | frmTop_MA_Abwesenheitsplanung.html | Popup |
| 35 | frmTop_VA_Akt_Objekt_Kopf | frmTop_VA_Akt_Objekt_Kopf.html | Popup |
| 36 | frmOff_Outlook_aufrufen | frmOff_Outlook_aufrufen.html | Office |
| 37 | frmOff_WinWord_aufrufen | frmOff_WinWord_aufrufen.html | Office |

### Z-Formulare (Zusatz) (3 Stück)

| # | Access-Formularname | HTML-Datei | Kategorie |
|---|---------------------|------------|-----------|
| 38 | zfrm_MA_Stunden_Lexware | zfrm_MA_Stunden_Lexware.html | Lexware |
| 39 | zfrm_Rueckmeldungen | zfrm_Rueckmeldungen.html | Rückmeldung |
| 40 | zfrm_SyncError | zfrm_SyncError.html | System |

### Unterformulare (12 Stück)

| # | Access-Formularname | HTML-Datei | Eingebettet in |
|---|---------------------|------------|----------------|
| 41 | sub_DP_Grund | sub_DP_Grund.html | Dienstplan |
| 42 | sub_DP_Grund_MA | sub_DP_Grund_MA.html | Dienstplan |
| 43 | sub_MA_Dienstplan | sub_MA_Dienstplan.html | MA_Mitarbeiterstamm |
| 44 | sub_MA_Jahresuebersicht | sub_MA_Jahresuebersicht.html | MA_Mitarbeiterstamm |
| 45 | sub_MA_Offene_Anfragen | sub_MA_Offene_Anfragen.html | MA_Offene_Anfragen |
| 46 | sub_MA_Rechnungen | sub_MA_Rechnungen.html | MA_Mitarbeiterstamm |
| 47 | sub_MA_Stundenuebersicht | sub_MA_Stundenuebersicht.html | MA_Mitarbeiterstamm |
| 48 | sub_MA_VA_Planung_Absage | sub_MA_VA_Planung_Absage.html | VA_Schnellauswahl |
| 49 | sub_MA_VA_Planung_Status | sub_MA_VA_Planung_Status.html | VA_Schnellauswahl |
| 50 | sub_MA_VA_Zuordnung | sub_MA_VA_Zuordnung.html | Auftragstamm |
| 51 | sub_MA_Zeitkonto | sub_MA_Zeitkonto.html | MA_Zeitkonten |
| 52 | sub_OB_Objekt_Positionen | sub_OB_Objekt_Positionen.html | OB_Objekt |
| 53 | sub_rch_Pos | sub_rch_Pos.html | Rechnung |
| 54 | sub_VA_Einsatztage | sub_VA_Einsatztage.html | Auftragstamm |
| 55 | sub_VA_Schichten | sub_VA_Schichten.html | Auftragstamm |
| 56 | sub_ZusatzDateien | sub_ZusatzDateien.html | Diverse |

---

## PHASE 0: VORBEREITUNG

### 0.1 Pfade
```
Access-FE:     C:\Users\guenther.siegert\Documents\0006_All_Access_KNOWLEDGE\0_Consys_FE_Test.accdb
HTML-Ordner:   C:\Users\guenther.siegert\Documents\0006_All_Access_KNOWLEDGE\04_HTML_Forms\forms3\
VBA-Module:    C:\Users\guenther.siegert\Documents\0006_All_Access_KNOWLEDGE\01_VBA\
```

### 0.2 Export-Zielordner
```
forms3\Access_Abgleich\
  ├── forms\              # Ein MD-File pro Formular
  ├── subforms\           # Ein MD-File pro Unterformular  
  ├── vba_code\           # Extrahierter VBA-Code
  └── MASTER_INVENTORY.md # Gesamtübersicht
```

---

## PHASE 1: ACCESS-FORMULAR EXPORT (Hauptaufgabe)

### 1.1 Pro Formular zu exportieren

Für **jedes der 56 Formulare** folgende Eigenschaften auslesen:

#### A) Formular-Eigenschaften
```
- Name
- RecordSource (Tabelle/Abfrage)
- Filter, FilterOn, OrderBy, OrderByOn
- DefaultView (Einzelformular, Endlosformular, Datenblatt)
- AllowEdits, AllowAdditions, AllowDeletions, DataEntry
- NavigationButtons, ScrollBars, RecordSelectors
- Cycle, KeyPreview
- PopUp, Modal, BorderStyle
- Width, Height (für Layout-Vergleich)
```

#### B) Formular-Events
```
- OnOpen, OnLoad, OnCurrent, OnClose, OnUnload
- OnActivate, OnDeactivate, OnResize
- BeforeInsert, AfterInsert
- BeforeUpdate, AfterUpdate
- BeforeDelConfirm, AfterDelConfirm
- OnDirty, OnUndo, OnError
- OnTimer, TimerInterval
- OnGotFocus, OnLostFocus
- OnClick, OnDblClick
- OnKeyDown, OnKeyUp, OnKeyPress
- OnMouseDown, OnMouseUp, OnMouseMove
```

#### C) Alle Controls mit Eigenschaften

**Für jeden Control-Typ:**

| Control-Typ | Relevante Eigenschaften |
|-------------|------------------------|
| **CommandButton** | Name, Caption, OnClick, OnDblClick, Enabled, Visible, TabIndex |
| **TextBox** | Name, ControlSource, DefaultValue, Format, InputMask, ValidationRule, ValidationText, Enabled, Locked, Visible, TabIndex, TabStop, BeforeUpdate, AfterUpdate, OnChange, OnEnter, OnExit, OnGotFocus, OnLostFocus, OnKeyDown, OnDblClick |
| **ComboBox** | Name, ControlSource, RowSource, RowSourceType, BoundColumn, ColumnCount, ColumnWidths, LimitToList, DefaultValue, Enabled, Locked, Visible, BeforeUpdate, AfterUpdate, OnChange, OnNotInList, OnEnter, OnExit, OnDblClick |
| **ListBox** | Name, ControlSource, RowSource, RowSourceType, BoundColumn, ColumnCount, ColumnWidths, MultiSelect, Enabled, Visible, OnClick, OnDblClick, BeforeUpdate, AfterUpdate |
| **CheckBox** | Name, ControlSource, DefaultValue, TripleState, Enabled, Locked, Visible, BeforeUpdate, AfterUpdate, OnClick |
| **OptionGroup** | Name, ControlSource, DefaultValue, Enabled, Visible, BeforeUpdate, AfterUpdate |
| **TabControl** | Name, Pages (Liste), OnChange, Enabled, Visible |
| **TabPage** | Name, Caption, PageIndex, Visible, OnClick |
| **SubForm** | Name, SourceObject, LinkMasterFields, LinkChildFields, Enabled, Visible, OnEnter, OnExit |
| **Label** | Name, Caption, Visible |
| **Image** | Name, Picture, Visible, OnClick, OnDblClick |

#### D) VBA-Code extrahieren

Für jeden Event mit `[Event Procedure]`:
1. Vollständigen Event-Handler-Code exportieren
2. Aufgerufene Sub/Functions identifizieren
3. Externe Module notieren

### 1.2 Export-Format pro Formular

**Datei:** `Access_Abgleich/forms/{FormName}.md`

```markdown
# Access-Export: {FormName}

## Formular-Eigenschaften
| Eigenschaft | Wert |
|-------------|------|
| RecordSource | qry_VA_Auftragstamm |
| DefaultView | Einzelformular |
| AllowEdits | Ja |
| ... | ... |

## Formular-Events
| Event | Typ | Handler |
|-------|-----|---------|
| OnLoad | [Event Procedure] | Form_Load() |
| OnCurrent | [Event Procedure] | Form_Current() |
| OnTimer | [Event Procedure] | Form_Timer() |

## Controls ({Anzahl} Stück)

### Buttons ({Anzahl})
| Name | Caption | OnClick | Enabled | Visible |
|------|---------|---------|---------|---------|
| btnSpeichern | Speichern | btnSpeichern_Click() | Ja | Ja |
| btnNeu | Neu | btnNeu_Click() | Ja | Ja |

### TextBoxen ({Anzahl})
| Name | ControlSource | Format | AfterUpdate | Enabled |
|------|---------------|--------|-------------|---------|
| txtAuftragNr | VA_ID | | | Nein |
| txtDatum | VA_Datum | dd.mm.yyyy | txtDatum_AfterUpdate() | Ja |

### ComboBoxen ({Anzahl})
| Name | ControlSource | RowSource | AfterUpdate | LimitToList |
|------|---------------|-----------|-------------|-------------|
| cboKunde | KD_ID | qry_KD_Lookup | cboKunde_AfterUpdate() | Ja |

### Unterformulare ({Anzahl})
| Name | SourceObject | LinkMasterFields | LinkChildFields |
|------|--------------|------------------|-----------------|
| sub_VA_Einsatztage | sub_VA_Einsatztage | VA_ID | VA_ID |

### Tabs ({Anzahl})
| TabControl | Pages |
|------------|-------|
| TabCtl_Main | Stammdaten, Einsatztage, Schichten, Personal |

## VBA-Code

### Form_Load()
```vba
Private Sub Form_Load()
    ' Code hier
End Sub
```

### btnSpeichern_Click()
```vba
Private Sub btnSpeichern_Click()
    ' Code hier
End Sub
```

## Aufgerufene externe Funktionen
| Funktion | Modul | Aufgerufen von |
|----------|-------|----------------|
| SetFilter() | mdl_Filter | Form_Load, cboKunde_AfterUpdate |
| SaveRecord() | mdl_Data | btnSpeichern_Click |
```

### 1.3 Unterformulare separat dokumentieren

**Datei:** `Access_Abgleich/subforms/{SubFormName}.md`

Gleiches Format wie Hauptformulare, zusätzlich:
```markdown
## Einbettungs-Kontext
| Eigenschaft | Wert |
|-------------|------|
| Eingebettet in | frm_va_Auftragstamm |
| Als Control | sub_VA_Einsatztage |
| LinkMasterFields | VA_ID |
| LinkChildFields | VA_ID |
```

---

## PHASE 2: MASTER-INVENTAR ERSTELLEN

### 2.1 Gesamtübersicht

**Datei:** `Access_Abgleich/MASTER_INVENTORY.md`

```markdown
# Access-Formulare Master-Inventar

**Exportiert:** {Datum}
**Anzahl Formulare:** 56 (40 Haupt + 16 Sub)
**Anzahl Controls gesamt:** {Summe}
**Anzahl Events gesamt:** {Summe}

## Übersicht nach Kategorie

### Aufträge (2 Formulare)
| Formular | Controls | Events | Subforms |
|----------|----------|--------|----------|
| frm_va_Auftragstamm | 45 | 127 | 4 |
| frm_VA_Planungsuebersicht | 12 | 18 | 0 |

### Mitarbeiter (12 Formulare)
...

## Control-Statistik
| Control-Typ | Anzahl | Mit Events |
|-------------|--------|------------|
| CommandButton | 234 | 198 |
| TextBox | 456 | 89 |
| ComboBox | 123 | 78 |
| SubForm | 45 | 12 |
| TabControl | 18 | 18 |

## Event-Statistik
| Event-Typ | Anzahl | Häufigste Formulare |
|-----------|--------|---------------------|
| OnClick | 198 | frm_va_Auftragstamm (45) |
| AfterUpdate | 89 | frm_MA_Mitarbeiterstamm (23) |
| OnLoad | 40 | alle |
| OnCurrent | 35 | diverse |

## Externe VBA-Module (referenziert)
| Modul | Aufrufe | Wichtigste Funktionen |
|-------|---------|----------------------|
| mdl_Filter | 45 | SetFilter, ClearFilter |
| mdl_Data | 38 | SaveRecord, DeleteRecord |
| zmd_Mail | 28 | SendMail, CreateAnfrage |
```

---

## PHASE 3: EXPORT-METHODIK

### 3.1 Zugriff auf Access-Datenbank

**Option A: Direkt via VBA (empfohlen)**
```vba
' In Access ausführen - exportiert alle Formular-Infos
Sub ExportFormularInfos()
    Dim frm As Form
    Dim ctl As Control
    ' ... Export-Logik
End Sub
```

**Option B: Via bestehende JSON-Exporte**
```
Pfad: 11_json_Export\000_Consys_Eport_11_25\30_forms\
Dateien: FRM_{FormName}.json, FRM_{FormName}__subcontrols.json
```

**Option C: Via VBA-Module**
```
Pfad: 01_VBA\forms\{FormName}.bas
Enthält: Alle Event-Handler als Code
```

### 3.2 Abarbeitungsreihenfolge

**Batch 1: Kernformulare (Prio 1)**
1. frm_va_Auftragstamm
2. frm_MA_Mitarbeiterstamm
3. frm_KD_Kundenstamm
4. frm_OB_Objekt

**Batch 2: Kritische Formulare (Prio 2)**
5. frm_MA_VA_Schnellauswahl
6. frm_DP_Dienstplan_Objekt
7. frm_DP_Dienstplan_MA
8. frm_Einsatzuebersicht

**Batch 3: Mitarbeiter-Formulare**
9-17. Alle frm_MA_* Formulare

**Batch 4: Kunden/Objekt-Formulare**
18-21. Alle frm_KD_*, frm_OB_* Formulare

**Batch 5: Restliche Hauptformulare**
22-40. Alle übrigen frm_*, frmTop_*, frmOff_*, zfrm_*

**Batch 6: Unterformulare**
41-56. Alle sub_* Formulare

---

## PHASE 4: QUALITÄTSPRÜFUNG

### 4.1 Vollständigkeits-Check

Nach Export jedes Formulars prüfen:

- [ ] Alle Form-Properties erfasst?
- [ ] Alle Controls gelistet?
- [ ] Alle Events mit Handler dokumentiert?
- [ ] VBA-Code für [Event Procedure] extrahiert?
- [ ] Externe Modul-Referenzen notiert?
- [ ] Unterformulare verlinkt?

### 4.2 Validierung gegen HTML

Optional (für späteren Abgleich):
```markdown
## Quick-Check: {FormName}

| Metrik | Access | HTML | Status |
|--------|--------|------|--------|
| Buttons | 45 | 53 | HTML erweitert |
| TextBoxen | 23 | 23 | OK |
| ComboBoxen | 12 | 10 | 2 fehlen |
| Events gesamt | 127 | 89 | 38 fehlen |
```

---

## OUTPUT-STRUKTUR

Nach Abschluss aller Phasen:

```
forms3/Access_Abgleich/
│
├── MASTER_INVENTORY.md          # Gesamtübersicht aller Formulare
│
├── forms/                        # 40 Hauptformulare
│   ├── frm_va_Auftragstamm.md
│   ├── frm_MA_Mitarbeiterstamm.md
│   ├── frm_KD_Kundenstamm.md
│   ├── frm_OB_Objekt.md
│   ├── frm_MA_VA_Schnellauswahl.md
│   ├── frm_DP_Dienstplan_Objekt.md
│   ├── frm_DP_Dienstplan_MA.md
│   ├── ... (33 weitere)
│   └── zfrm_SyncError.md
│
├── subforms/                     # 16 Unterformulare
│   ├── sub_VA_Einsatztage.md
│   ├── sub_VA_Schichten.md
│   ├── sub_MA_VA_Zuordnung.md
│   ├── ... (13 weitere)
│   └── sub_ZusatzDateien.md
│
└── vba_code/                     # Extrahierter VBA-Code
    ├── frm_va_Auftragstamm.bas
    ├── frm_MA_Mitarbeiterstamm.bas
    └── ... (pro Formular mit Events)
```

---

## ZEITSCHÄTZUNG

| Phase | Aufwand |
|-------|---------|
| Phase 0: Vorbereitung | 10 min |
| Phase 1: Export (56 Formulare × 10 min) | ~10 Stunden |
| Phase 2: Master-Inventar | 30 min |
| Phase 3: (integriert in Phase 1) | - |
| Phase 4: Qualitätsprüfung | 1 Stunde |
| **Gesamt** | **~12 Stunden** |

**Mit Automatisierung (VBA-Script):** ~2-3 Stunden

---

## ANHANG: VBA-Export-Script

```vba
' Dieses Script in Access ausführen um alle Formular-Infos zu exportieren
Option Compare Database
Option Explicit

Public Sub ExportAlleFormulare()
    Dim db As DAO.Database
    Dim frm As AccessObject
    Dim exportPath As String
    
    exportPath = "C:\...\forms3\Access_Abgleich\forms\"
    Set db = CurrentDb
    
    ' Liste der zu exportierenden Formulare
    Dim formList As Variant
    formList = Array("frm_va_Auftragstamm", "frm_MA_Mitarbeiterstamm", ...)
    
    Dim i As Integer
    For i = LBound(formList) To UBound(formList)
        Call ExportFormular(CStr(formList(i)), exportPath)
    Next i
End Sub

Private Sub ExportFormular(formName As String, exportPath As String)
    ' Formular öffnen, Properties lesen, Controls iterieren
    ' Output als Markdown-Datei speichern
    ' ...
End Sub
```

---

*Dokument-Ende*
