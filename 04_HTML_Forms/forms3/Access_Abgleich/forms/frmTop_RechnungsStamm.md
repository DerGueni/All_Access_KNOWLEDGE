# frmTop_RechnungsStamm

## Formular-Metadaten

| Eigenschaft | Wert |
|-------------|------|
| **Name** | frmTop_RechnungsStamm |
| **Datensatzquelle** | tbl_Rch_Kopf |
| **Datenquellentyp** | Table |
| **Default View** | SplitForm |
| **Allow Edits** | Ja |
| **Allow Additions** | Ja |
| **Allow Deletions** | Ja |
| **Data Entry** | Nein |
| **Navigation Buttons** | Nein |

## Controls


### ComboBoxen (Auswahllisten)

| Name | Control Source | Position (L/T) | Groesse (W/H) | TabIndex |
|------|----------------|----------------|---------------|----------|
| cboKunde | - | 13372 / 521 | 2098 x 345 | 10 |
| cboMahnstufe | - | 13372 / 946 | 2098 x 345 | 11 |
| cboRchID | - | 13372 / 75 | 2098 x 345 | 12 |
| kun_ID | kun_ID | 3929 / 2190 | 4965 x 359 | 6 |
| RchTyp | RchTyp | 10834 / 1290 | 1380 x 315 | 7 |
| Kombinationsfeld448 | VA_ID | 3914 / 1290 | 4965 x 359 | 14 |
| lbl_Auftragsdatum | VA_ID | 3914 / 1725 | 4965 x 359 | 15 |
| MA_ID | MA_ID | 5135 / 2655 | 3975 x 359 | 4 |
| ZahlBed_ID | ZahlBed_ID | 5135 / 3236 | 3976 x 359 | 5 |

### Buttons (Schaltflaechen)

| Name | Caption | Position (L/T) | Groesse (W/H) | Events |
|------|---------|----------------|---------------|--------|
| Befehl38 | btn_Formular_schliessen | 9653 / 90 | 336 x 336 | OnClick: [Eingebettetes Makro] |
| Befehl39 | btn_letzter_Datensatz | 9194 / 90 | 336 x 336 | OnClick: [Eingebettetes Makro] |
| Befehl40 | btn_Datensatz_vor | 8735 / 90 | 336 x 336 | OnClick: [Eingebettetes Makro] |
| Befehl41 | btn_Datensatz_zurueck | 8276 / 90 | 336 x 336 | OnClick: [Eingebettetes Makro] |
| Befehl42 | drucken | 7358 / 90 | 336 x 336 | OnClick: [Eingebettetes Makro] |
| Befehl43 | btn_erster_Datensatz | 7817 / 90 | 336 x 336 | OnClick: [Eingebettetes Makro] |
| Befehl46 | Neue Rechnung | 10204 / 945 | 1845 x 345 | OnClick: [Eingebettetes Makro] |
| btnHilfe | Hilfe | 6899 / 90 | 336 x 336 | OnClick: [Eingebettetes Makro] |
| mcobtnDelete | Rechnung löschen | 10204 / 520 | 1845 x 345 | OnClick: [Eingebettetes Makro] |
| btnFIlterLoesch | Filter löschen | 10204 / 75 | 1845 x 345 | OnClick: [Event Procedure] |
| btnRibbonAus | Befehl179 | 1248 / 283 | 283 x 223 | - |
| btnRibbonEin | Befehl179 | 1248 / 613 | 283 x 223 | - |
| btnDaBaEin | Befehl179 | 1533 / 448 | 283 x 223 | - |
| btnDaBaAus | Befehl179 | 963 / 448 | 283 x 223 | - |
| btnMahnen | Mahnen | 12292 / 5499 | 2936 x 510 | OnClick: [Event Procedure] |
### Labels (Bezeichnungsfelder)

| Name | Position (L/T) | Groesse (W/H) | ForeColor |
|------|----------------|---------------|-----------||
| Auto_Kopfzeile0 | 3884 / 60 | 2715 x 460 | -2147483616 (Unbekannt) |
| Bezeichnungsfeld362 | 12124 / 520 | 1080 x 345 | -2147483616 (Unbekannt) |
| Bezeichnungsfeld414 | 12124 / 945 | 1080 x 345 | -2147483616 (Unbekannt) |
| Bezeichnungsfeld443 | 12124 / 75 | 1080 x 345 | -2147483616 (Unbekannt) |
| Bezeichnungsfeld18 | 3149 / 7905 | 1903 x 360 | 0 (Schwarz) |
| Bezeichnungsfeld33 | 2999 / 2835 | 1423 x 315 | 0 (Schwarz) |
| Bezeichnungsfeld42 | 3014 / 3780 | 1423 x 315 | 0 (Schwarz) |
| Bezeichnungsfeld54 | 12900 / 1360 | 1423 x 315 | 0 (Schwarz) |
| Bezeichnungsfeld372 | 9629 / 3780 | 1123 x 315 | 0 (Schwarz) |
| Bezeichnungsfeld60 | 12559 / 2220 | 1048 x 315 | 0 (Schwarz) |
| Bezeichnungsfeld12 | 2999 / 2190 | 870 x 360 | 0 (Schwarz) |
| Bezeichnungsfeld3 | 9629 / 1290 | 1123 x 315 | 0 (Schwarz) |
| Bezeichnungsfeld6 | 9629 / 1725 | 1123 x 315 | 0 (Schwarz) |
| Bezeichnungsfeld297 | 3104 / 4620 | 1140 x 255 | 0 (Schwarz) |
| Bezeichnungsfeld366 | 3163 / 8323 | 1245 x 315 | 0 (Schwarz) |
| Bezeichnungsfeld371 | 9629 / 2835 | 1123 x 315 | 0 (Schwarz) |
| Bezeichnungsfeld374 | 2999 / 3300 | 1423 x 315 | 0 (Schwarz) |
| Bezeichnungsfeld376 | 9629 / 3300 | 1123 x 315 | 0 (Schwarz) |
| lbl_Auftrag | 2984 / 1290 | 870 x 360 | 0 (Schwarz) |
| Bezeichnungsfeld451 | 2999 / 1725 | 870 x 360 | 0 (Schwarz) |
| Bezeichnungsfeld21 | 3117 / 3798 | 1903 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld24 | 3170 / 1365 | 1903 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld27 | 3170 / 1725 | 1903 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld30 | 3170 / 2085 | 1903 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld15 | 3170 / 2655 | 1903 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld45 | 3170 / 3236 | 1903 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld447 | 3170 / 4578 | 1903 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld63 | 3105 / 1225 | 1648 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld66 | 3105 / 1585 | 1648 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld69 | 3105 / 1945 | 1648 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld72 | 3105 / 2305 | 1648 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld353 | 3170 / 2947 | 1365 x 315 | 8355711 (Grau) |
| Bezeichnungsfeld382 | 7484 / 1245 | 1603 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld383 | 7484 / 1605 | 1603 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld384 | 7484 / 1965 | 1603 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld385 | 7484 / 2325 | 1603 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld387 | 7475 / 2947 | 1380 x 315 | 8355711 (Grau) |
| Bezeichnungsfeld392 | 11680 / 2327 | 1573 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld393 | 11680 / 1247 | 1573 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld394 | 11680 / 1607 | 1573 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld395 | 11680 / 1967 | 1573 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld397 | 11680 / 2947 | 1350 x 315 | 8355711 (Grau) |
| Bezeichnungsfeld406 | 5494 / 2940 | 1140 x 315 | 8355711 (Grau) |
| Bezeichnungsfeld408 | 9697 / 2948 | 1245 x 315 | 8355711 (Grau) |
| Bezeichnungsfeld412 | 13665 / 2948 | 1185 x 315 | 8355711 (Grau) |
| Bezeichnungsfeld417 | 3109 / 1220 | 1648 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld419 | 3109 / 1580 | 1648 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld421 | 3109 / 1940 | 1648 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld423 | 3109 / 2300 | 1648 x 360 | 8355711 (Grau) |
| Bezeichnungsfeld425 | 3174 / 2942 | 1365 x 315 | 8355711 (Grau) |
| Bezeichnungsfeld427 | 5498 / 2935 | 1140 x 315 | 8355711 (Grau) |
| lbl_Mahnstufe | 7256 / 1247 | 7994 x 566 | 4210752 (Dunkelgrau) |
| Bezeichnungsfeld433 | 8503 / 2891 | 615 x 315 | 8355711 (Grau) |
| Bezeichnungsfeld435 | 8560 / 3515 | 615 x 315 | 8355711 (Grau) |
| Bezeichnungsfeld0 | 2947 / 113 | 703 x 360 | 0 (Schwarz) |
| Bezeichnungsfeld401 | 5099 / 120 | 1153 x 360 | 0 (Schwarz) |
| Bezeichnungsfeld449 | 375 / 15 | 615 x 315 | 8355711 (Grau) |
| Bezeichnungsfeld188 | 2999 / 60 | 810 x 199 | -2147483616 (Unbekannt) |
| Bezeichnungsfeld194 | 5201 / 60 | 345 x 199 | -2147483616 (Unbekannt) |
| Bezeichnungsfeld196 | 10704 / 60 | 855 x 199 | -2147483616 (Unbekannt) |
| Bezeichnungsfeld198 | 12879 / 73 | 345 x 199 | -2147483616 (Unbekannt) |

### OptionButtons

| Name | Caption | Position (L/T) | Groesse (W/H) |
|------|---------|----------------|---------------|
| IstBezahlt | - | 12585 / 1405 | 270 x 225 |
| IstSammelRch | - | 5082 / 3798 | 3975 x 360 |
| M1IstGemahnt1 | - | 5264 / 2970 | 260 x 240 |
| M2IstGemahnt1 | - | 9467 / 2978 | 260 x 240 |
| M3IstGemahnt1 | - | 13435 / 2978 | 681 x 227 |
| IstGemahnt | - | 5268 / 2965 | 260 x 240 |

### Rectangles

| Name | Caption | Position (L/T) | Groesse (W/H) |
|------|---------|----------------|---------------|
| istRechnung | Rechnung | 12649 / 90 | 2793 x 456 |

### Subforms (Unterformulare)

| Name | Source Object | Position (L/T) | Groesse (W/H) |
|------|---------------|----------------|---------------|
| sub_Rch_Sub_VA_Kopf | - | 3074 / 4920 | 12040 x 2211 |
| sub_Rch_VA_Gesamtanzeige | - | 3120 / 1303 | 12239 x 6292 |
| sub_Rch_Pos_Geschrieben | - | 3117 / 1190 | 12237 x 6864 |
| sub_Rch_Pos_Auftrag | - | 3117 / 1247 | 12242 x 6747 |
| Menü | - | 0 / 0 | 2790 x 10755 |

### TextBoxen

| Name | Control Source | Position (L/T) | Groesse (W/H) | TabIndex |
|------|----------------|----------------|---------------|----------||
| Dateiname | Dateiname | 4334 / 7905 | 10815 x 360 | 0 |
| Zwi_Sum1 | Zwi_Sum1 | 4664 / 2835 | 1605 x 315 | 1 |
| Gesamtsumme1 | Gesamtsumme1 | 4664 / 3780 | 1605 x 315 | 2 |
| Zahlung_am | Zahlung_am | 10849 / 3780 | 1380 x 315 | 4 |
| ZahlBetrag_Netto1 | ZahlBetrag_Netto1 | 13669 / 2220 | 645 x 315 | 5 |
| VorlageDokNr | VorlageDokNr | 10849 / 1725 | 1380 x 315 | 8 |
| Bemerkungen | Bemerkungen | 3175 / 8720 | 12051 x 2595 | 10 |
| Zahlung_Bis | Zahlung_Bis | 10849 / 2835 | 1380 x 315 | 11 |
| MwSt_Sum1 | MwSt_Sum1 | 4664 / 3300 | 1605 x 315 | 12 |
| Zahlbetrag1 | Zahlbetrag1 | 10849 / 3300 | 1380 x 315 | 13 |
| Leist_Datum_von | Leist_Datum_von | 5135 / 1365 | 3975 x 360 | 1 |
| Leist_Datum_Bis | Leist_Datum_Bis | 5135 / 1725 | 3975 x 360 | 2 |
| Ang_Gueltig_Bis | Ang_Gueltig_Bis | 5135 / 2085 | 3975 x 360 | 3 |
| VA_ID | VA_ID | 5135 / 4578 | 3975 x 360 | 6 |
| M1Mahn | M1MahnDok | 4920 / 1225 | 1935 x 360 | 0 |
| M1Mahndat | M1Mahndat | 4920 / 1585 | 1935 x 360 | 1 |
| M1MahnVon | M1MahnVon | 4920 / 1945 | 1935 x 360 | 2 |
| M1Mahnbetrag1 | M1Mahnbetrag1 | 4920 / 2305 | 1935 x 360 | 3 |
| M1Mahn_Bemerkungen | M1Mahn_Bemerkungen | 3187 / 3334 | 3636 x 4695 | 4 |
| Text378 | M2MahnDok | 9268 / 1245 | 1725 x 360 | 5 |
| Text379 | M2Mahndat | 9268 / 1605 | 1725 x 360 | 6 |
| Text380 | M2MahnVon | 9268 / 1965 | 1725 x 360 | 7 |
| Text381 | M2Mahnbetrag1 | 9268 / 2325 | 1725 x 360 | 8 |
| M2Mahn_Bemerkungen | M2Mahn_Bemerkungen | 7477 / 3334 | 3576 x 4695 | 9 |
| Text388 | M3MahnDok | 13315 / 1247 | 1725 x 360 | 10 |
| Text389 | M3Mahndat | 13315 / 1607 | 1725 x 360 | 11 |
| Text390 | M3MahnVon | 13315 / 1967 | 1725 x 360 | 12 |
| Text391 | M3Mahnbetrag1 | 13315 / 2327 | 1725 x 360 | 13 |
| M3Mahn_Bemerkungen | M3Mahn_Bemerkungen | 11682 / 3334 | 3336 x 4695 | 14 |
| MahnBetrag | - | 4924 / 1220 | 1935 x 360 | 0 |
| Mahndat | - | 4924 / 1580 | 1935 x 360 | 1 |
| MahnVon | - | 4924 / 1940 | 1935 x 360 | 2 |
| Mahndok | - | 4924 / 2300 | 10335 x 360 | 3 |
| Mahn_Bemerkungen | - | 3191 / 3329 | 3681 x 4695 | 4 |
| kun_Firma | - | 9231 / 2891 | 6008 x 315 | 6 |
| kun_BriefKopf | - | 9287 / 3515 | 5953 x 1695 | 7 |
| ID | ID | 3712 / 113 | 495 x 360 | 1 |
| RchDatum | RchDatum | 6344 / 120 | 1140 x 360 | 0 |
| Erst_am | Erst_am | 3906 / 60 | 1191 x 199 | 0 |
| Erst_von | Erst_von | 5720 / 60 | 1188 x 199 | 1 |
| Aend_am | Aend_am | 11611 / 60 | 1191 x 199 | 2 |
| Aend_von | Aend_von | 13398 / 73 | 1188 x 199 | 3 |

### Unknown (102)s

| Name | Caption | Position (L/T) | Groesse (W/H) |
|------|---------|----------------|---------------|
| Linie398 | - | 7202 / 1303 | 0 x 6804 |
| Linie399 | - | 11397 / 1303 | 0 x 6804 |

### Unknown (123)s

| Name | Caption | Position (L/T) | Groesse (W/H) |
|------|---------|----------------|---------------|
| reg_Rech | - | 2834 / 660 | 13531 x 11235 |

### Unknown (124)s

| Name | Caption | Position (L/T) | Groesse (W/H) |
|------|---------|----------------|---------------|
| pgMain | Main | 2969 / 1125 | 13260 x 10635 |
| pgWeit | Weiteres | 2969 / 1125 | 13260 x 10635 |
| pg_VA_ID | Aufträge | 2969 / 1125 | 13260 x 10635 |
| pgGeschrPos | Geschriebene Pos | 2969 / 1125 | 13260 x 10635 |
| pgAuftrPos | Auftragspositionen | 2969 / 1125 | 13260 x 10635 |
| pgMahnInfo | Mahnung Info | 2969 / 1125 | 13260 x 10635 |
| pgMahnen | Mahnen | 2969 / 1125 | 13260 x 10635 |

## Events

### Formular-Events
- OnOpen: Keine
- OnLoad: [Event Procedure]
- OnClose: Keine
- OnCurrent: [Event Procedure]
- BeforeUpdate: Keine
- AfterUpdate: Keine
- OnActivate: Keine
- OnDeactivate: Keine

## VBA-Code

```vba
Option Compare Database
Option Explicit

Private Sub btnFIlterLoesch_Click()
'Me!Mahndok.ControlSource = ""
'Me!Mahndat.ControlSource = ""
'Me!MahnVon.ControlSource = ""
'Me!Mahnbetrag.ControlSource = ""
'Me!IstGemahnt.ControlSource = ""
'Me!Mahn_Bemerkungen.ControlSource = ""
'
Me!kun_firma.ControlSource = ""
Me!kun_BriefKopf.ControlSource = ""

Me!cboKunde = ""
Me!cboMahnstufe = ""

Me.RecordSource = "tbl_Rch_Kopf"
Me.Requery
End Sub


Private Sub cboKunde_AfterUpdate()
Me.RecordSource = "SELECT * FROM tbl_Rch_Kopf WHERE kun_ID = " & Me!cboKunde.Column(0)
Me.Requery
End Sub

Public Function fMahnsetz()
Dim iRch_KopfID As Long
Dim strSQL As String

'Me!Mahndok.ControlSource = "M" & i & "Mahndok"
'Me!Mahndat.ControlSource = "M" & i & "Mahndat"
'Me!MahnVon.ControlSource = "M" & i & "MahnVon"
'Me!Mahnbetrag.ControlSource = "M" & i & "Mahnbetrag"
'Me!IstGemahnt.ControlSource = "M" & i & "IstGemahnt"
'Me!Mahn_Bemerkungen.ControlSource = "M" & i & "Mahn_Bemerkungen"
'
Me!kun_firma.ControlSource = "kun_Firma"
Me!kun_BriefKopf.ControlSource = "kun_BriefKopf"
Me!lbl_Mahnstufe.caption = Me!cboMahnstufe.Column(1)
Me!MahnBetrag = Me!ZahlBetrag_Netto1
Me!Mahndat = Date
Me!MahnVon = atCNames(1)
Me!IstGemahnt = True

DoEvents

'Me.Requery

End Function

Private Sub cboMahnstufe_AfterUpdate()
Dim i As Long
i = Me!cboMahnstufe.Column(0)

Me.RecordSource = "qry_Rch_Mahnstufe" & i
Me.Requery

fMahnsetz
End Sub


'Function fMahnen(iMahnstufe As Long, rch_ID As Long)

Private Sub btnMahnen_Click()

Dim i As Long
Dim ikun_ID As Long
Dim Mah_ID As Long
Dim Mah_Num As String
Dim Praefix As String
Dim Praefix1 As String
Dim Mah_Dateiname As String
Dim Mah_PDFDateiname As String
Dim iDokVorlage_ID As Long

Dim vorlPfad As String
Dim VorlNamen As String
Dim DokPfad As String

Dim strVorlage As String
Dim strDokument As String
Dim strPDFDokument As String

Dim iRch_KopfID As Long
Dim strSQL As String

ikun_ID = Nz(TLookup("kun_ID", "tbl_Rch_Kopf", "ID = " & Me!ID), 0)

If ikun_ID = 0 Then
    MsgBox "Keine Kundenrechnung - Keine Mahnung"
    Exit Sub
End If

i = 15  ' Mahnung

' Rechnungsnummer erzeugen
Mah_ID = Update_Rch_Nr(i)
Praefix = Nz(TLookup("Praefix", "_tblEigeneFirma_Word_Nummernkreise", "ID = " & i))
Praefix1 = Nz(TLookup("Praefix1", "_tblEigeneFirma_Word_Nummernkreise", "ID = " & i))
Mah_Num = Praefix1 & Right("00000" & Mah_ID, 5)
Mah_Dateiname = Praefix & "_" & Mah_Num & ".docx"
Mah_PDFDateiname = Praefix & "_" & Mah_Num & ".pdf"

vorlPfad = Get_Priv_Property("prp_CONSYS_GrundPfad") & Nz(TLookup("Pfad", "_tblEigeneFirma_Pfade", "ID = 5"))
DokPfad = Get_Priv_Property("prp_CONSYS_GrundPfad") & Nz(TLookup("Pfad", "_tblEigeneFirma_Pfade", "ID = 2"))

If Right(vorlPfad, 1) <> "\" Then vorlPfad = vorlPfad & "\"
If Right(DokPfad, 1) <> "\" Then DokPfad = DokPfad & "\"

Select Case Me!cboMahnstufe.Column(0)
    Case 1
        iDokVorlage_ID = 19
    Case 2
        iDokVorlage_ID = 20
    Case 3
        iDokVorlage_ID = 21
    Case Else
End Select

VorlNamen = Nz(TLookup("Docname", "_tblEigeneFirma_TB_Dok_Dateinamen", "ID = " & iDokVorlage_ID))

strVorlage = vorlPfad & VorlNamen
DokPfad = DokPfad & "KD_" & ikun_ID & "\"
strDokument = DokPfad & Mah_Dateiname
strPDFDokument = DokPfad & Mah_PDFDateiname

iRch_KopfID = Me!ID

Me!Mahndok = strDokument

i = Me!cboMahnstufe.Column(0)

strSQL = ""
strSQL = strSQL & "UPDATE tbl_Rch_Kopf SET"
strSQL = strSQL & " tbl_Rch_Kopf.M" & i & "Mahndok = '" & Nz(Me!Mahndok) & "'"
strSQL = strSQL & " , tbl_Rch_Kopf.M" & i & "Mahndat = " & SQLDatum(Me!Mahndat)
strSQL = strSQL & " , tbl_Rch_Kopf.M" & i & "MahnVon = '" & Nz(Me!MahnVon) & "'"
strSQL = strSQL & " , tbl_Rch_Kopf.M" & i & "Mahnbetrag1 = " & str(Me!MahnBetrag)
strSQL = strSQL & " , tbl_Rch_Kopf.M" & i & "IstGemahnt1 = " & CLng(Me!IstGemahnt)
strSQL = strSQL & " , tbl_Rch_Kopf.M" & i & "Mahn_Bemerkungen = '" & Nz(Me!Mahn_Bemerkungen) & "'"
strSQL = strSQL & " , tbl_Rch_Kopf.Aend_von = '" & atCNames(1) & "'"
strSQL = strSQL & " , tbl_Rch_Kopf.Aend_am = " & SQLDatum(Date)
strSQL = strSQL & " WHERE ((tbl_Rch_Kopf.ID)= " & iRch_KopfID & ");"
CurrentDb.Execute (strSQL)

DoEvents

Call Textbau_Replace_Felder_Fuellen(iDokVorlage_ID)

Call fReplace_Table_Felder_Ersetzen(Me!ID, ikun_ID, 0, Me!VA_ID)

DoEvents

Call WordReplace(strVorlage, strDokument)

PDF_Print strDokument

'MsgBox "Rechnung / Angebot erzeugt"

'If Me!IsWordAutoClose Then
'    wd_Close_All
'    Reset_Word_Objekt
'Else
    Reset_Word_Objekt
'End If


End Sub


Private Sub cboRchID_AfterUpdate()
Me.Recordset.FindFirst "ID = " & Me!cboRchID
End Sub

Private Sub Dateiname_DblClick(Cancel As Integer)

Dim Datei As String

On Error GoTo Err


    Application.FollowHyperlink Me!Dateiname
    
Ende:
    Exit Sub
Err:
    Datei = Dateiauswahl("Rechnung auswählen", "*.pdf,*.doc,*.docx", consys)
    If Datei <> "" Then Me.Dateiname = Datei
    Resume Ende
End Sub


Private Sub Form_Current()
If Me!reg_Rech.Pages(Me!reg_Rech).Name = "pgMahnen" And Nz(Me!cboMahnstufe.Column(0), 0) > 0 Then
    Call fMahnsetz
End If
End Sub

Private Sub Form_Load()
DoCmd.Maximize
End Sub

Private Sub istRechnung_AfterUpdate()
If Me!istRechnung Then
    Me!istRechnung.caption = "Rechnung"
    Me.RecordSource = "qry_tbl_Rch_Kopf"
    Me.Requery

Else
    Me!istRechnung.caption = "Angebot"
    Me.RecordSource = "qry_tbl_Rch_Kopf_Ang"
    Me.Requery
End If

End Sub

Private Sub btnDaBaAus_Click()
    DoCmd.SelectObject acTable, , True
    RunCommand acCmdWindowHide
End Sub

Private Sub btnDaBaEin_Click()
    DoCmd.SelectObject acTable, , True
End Sub

Private Sub btnRibbonAus_Click()
    DoCmd.ShowToolbar "Ribbon", acToolbarNo
End Sub

Private Sub btnRibbonEin_Click()
    DoCmd.ShowToolbar "Ribbon", acToolbarYes
End Sub

```
