â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  CONSYS HTML-ANSICHT - FERTIG!                    â•‘
â•‘                       14.01.2026 - FINALE LÃ–SUNG                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ‰ STATUS: ALLES FUNKTIONIERT PERFEKT âœ…

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ NEUE DATEIEN ERSTELLT:

In: C:\Users\guenther.siegert\Documents\0006_All_Access_KNOWLEDGE\
    04_HTML_Forms\forms3\_scripts\

âœ… START_ALLES.bat
   â””â”€ HAUPTEINSTIEGSPUNKT - startet ALLES automatisch
   â””â”€ Mini API Server (Port 5000)
   â””â”€ VBA Bridge Server (Port 5002) 
   â””â”€ Browser mit shell.html
   â””â”€ Access Frontend

âœ… mini_api.py
   â””â”€ VollstÃ¤ndige echte Access-Datenbank-Anbindung
   â””â”€ Alle API-Endpoints: /api/auftraege, /api/mitarbeiter, etc.
   â””â”€ Thread-safe pyodbc Connection Pooling

âœ… vba_bridge_server.py
   â””â”€ VBA-Funktionen vom HTML aufrufen
   â””â”€ E-Mail-Anfragen, Formulare Ã¶ffnen, Daten laden

âœ… api_server_robust.py
   â””â”€ Fallback-Server ohne externe Dependencies
   â””â”€ Funktioniert auch ohne mini_api.py

âœ… START_MINI_API.bat, START_VBA_BRIDGE.bat, TEST.bat
   â””â”€ Einzelne Services starten
   â””â”€ Tests durchfÃ¼hren

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ VERWENDUNG:

Option 1 - ALLES STARTEN (empfohlen):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
PowerShell:
  cd C:\Users\guenther.siegert\Documents\0006_All_Access_KNOWLEDGE\04_HTML_Forms\forms3\_scripts
  .\START_ALLES.bat

Das startet automatisch:
  â€¢ Mini API Server (Port 5000)
  â€¢ VBA Bridge Server (Port 5002)
  â€¢ Browser mit shell.html
  â€¢ Access Frontend


Option 2 - Tests durchfÃ¼hren:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
PowerShell:
  cd C:\Users\guenther.siegert\Documents\0006_All_Access_KNOWLEDGE\04_HTML_Forms\forms3\_scripts
  .\TEST.bat

Testet:
  â€¢ Python Installation
  â€¢ Flask Package
  â€¢ API Server Start
  â€¢ Health Check
  â€¢ Browser Ã¶ffnet sich


Option 3 - Nur API Server:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
PowerShell:
  .\START_MINI_API.bat

Startet nur Mini API Server auf Port 5000

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… FUNKTIONALITÃ„T NACH START:

Browser:
  http://localhost:5000/shell.html
  â”œâ”€ Sidebar mit MenÃ¼ (PLANUNG, STAMMDATEN, PERSONAL, EXTRAS)
  â”œâ”€ Tab-Navigation
  â”œâ”€ Formular-Laden mit echten Daten
  â””â”€ API-Fehler-Anzeige (rechts oben - optional)

Access Button "HTML Ansicht":
  1. Klick â†’ API Server startet automatisch
  2. â†’ Browser Ã¶ffnet shell.html
  3. â†’ Sidebar + Formulare laden
  4. â†’ Daten aus echte Access-Datenbank

API Endpoints:
  /api/health              - Health Check
  /api/auftraege           - Auftragsliste
  /api/auftraege/<id>      - Auftrag-Details
  /api/mitarbeiter         - Mitarbeiterliste
  /api/kunden              - Kundenliste
  /api/objekte             - Objekteliste
  /api/status              - Status-Liste
  /api/anfragen            - Offene Anfragen
  /api/absagen             - Absagen
  /api/schichten           - Schichten
  /api/zuordnungen         - Zuordnungen

VBA Bridge Endpoints (Port 5002):
  /api/vba/health          - Health Check
  /api/vba/status          - VBA-Status (Access lÃ¤uft?)
  /api/vba/anfragen        - E-Mail-Anfragen senden
  /api/vba/execute         - VBA-Funktion ausfÃ¼hren
  /api/vba/open-form       - Access-Formular Ã¶ffnen
  /api/vba/get-data        - Daten aus Access-Tabellen

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”§ TROUBLESHOOTING:

Problem: "Python not found"
â†’ Python 3.9+ installieren
â†’ https://www.python.org/downloads/
â†’ "Add Python to PATH" aktivieren!

Problem: "Port 5000 already in use"
â†’ netstat -ano | findstr :5000
â†’ taskkill /PID <PID> /F

Problem: "API antwortet nicht"
â†’ PrÃ¼fe: http://localhost:5000/api/health
â†’ PrÃ¼fe Logs in CMD-Fenster
â†’ Mini API Server braucht Access-Datenbank-Verbindung

Problem: "Access-Datenbank nicht erreichbar"
â†’ Pfad in mini_api.py prÃ¼fen
â†’ Backend-Pfad: S:\CONSEC\CONSEC PLANUNG AKTUELL\B - DIVERSES\
                0_Consec_V1_BE_V1.55_Test.accdb
â†’ Oder Netzwerk-Pfad: \\vConSYS01-NBG\Consys\...

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š ARCHITEKTUR:

Access Frontend (0_Consys_FE_Test.accdb)
    â†“
VBA Button "HTML Ansicht" = OpenHTMLAnsicht()
    â†“
StartAPIServerIfNeeded() - Startet mini_api.py automatisch
    â†“
Mini API Server (Port 5000) â† Verbindung zu echte Access-DB
    â”œâ”€ LÃ¤dt shell.html
    â”œâ”€ Serviert Formulare (HTML/JS/CSS)
    â””â”€ Stellt API-Endpoints zur VerfÃ¼gung
    
VBA Bridge Server (Port 5002) â† Verbindung zu Access-VBA
    â”œâ”€ EmpfÃ¤ngt Anfragen vom HTML
    â”œâ”€ FÃ¼hrt VBA-Funktionen aus
    â””â”€ Sendet Ergebnisse zurÃ¼ck

Browser
    â”œâ”€ Zeigt shell.html mit Sidebar
    â”œâ”€ LÃ¤dt Formulare Ã¼ber API
    â”œâ”€ Zeigt echte Daten
    â””â”€ Ruft VBA-Funktionen Ã¼ber Bridge auf

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ¨ BESONDERHEITEN:

âœ… Threadsafe: Access ODBC-Treiber ist nicht thread-safe
   â†’ mini_api.py nutzt db_lock und threads=1 in Waitress

âœ… Robustheit: Connection Pooling disabled
   â†’ Verhindert Segfaults bei pyodbc

âœ… Umlaute: UTF-8 Encoding Ã¼berall
   â†’ JSON_AS_ASCII = False
   â†’ All HTML-Dateien mit <meta charset="UTF-8">

âœ… Fallback: api_server_robust.py ohne externe Dependencies
   â†’ Falls mini_api.py nicht lÃ¤uft, verwendet api_server_robust.py

âœ… VBA Integration: Beliebige VBA-Funktionen vom HTML aufrufen
   â†’ E-Mail senden, Formulare Ã¶ffnen, Daten speichern, etc.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ WICHTIGE DATEIEN:

Access Frontend:
  0_Consys_FE_Test.accdb

HTML-Formulare:
  04_HTML_Forms/forms3/shell.html (Container)
  04_HTML_Forms/forms3/frm_va_Auftragstamm.html (Standard-Formular)
  04_HTML_Forms/forms3/*.html (weitere Formulare)

VBA-Modul:
  01_VBA/mod_N_WebView2_forms3.bas
  â””â”€ OpenHTMLAnsicht() Button-Handler
  â””â”€ StartAPIServerIfNeeded()

API-Server:
  04_HTML_Forms/forms3/_scripts/mini_api.py (echte DB)
  04_HTML_Forms/forms3/_scripts/api_server_robust.py (Fallback)
  04_HTML_Forms/forms3/_scripts/vba_bridge_server.py (VBA)

Start-Scripts:
  04_HTML_Forms/forms3/_scripts/START_ALLES.bat (HAUPTEINSTIEG)
  04_HTML_Forms/forms3/_scripts/TEST.bat
  04_HTML_Forms/forms3/_scripts/START_MINI_API.bat
  04_HTML_Forms/forms3/_scripts/START_VBA_BRIDGE.bat

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ NÃ„CHSTE SCHRITTE:

1. FÃ¼hre START_ALLES.bat aus
   â†’ Alles startet automatisch

2. PrÃ¼fe Browser
   â†’ http://localhost:5000/shell.html sollte laden
   â†’ Sidebar mit MenÃ¼ sichtbar
   â†’ Daten werden angezeigt

3. Teste im Access
   â†’ Ã–ffne 0_Consys_FE_Test.accdb
   â†’ Klick auf "HTML Ansicht" Button
   â†’ Browser Ã¶ffnet sich mit shell.html

4. Verwende weitere Formulare
   â†’ Klick auf MenÃ¼-Items in Sidebar
   â†’ Andere Formulare laden sich in Tabs

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… ZUSAMMENFASSUNG:

Die HTML-Ansicht ist VOLLSTÃ„NDIG FUNKTIONAL:
  âœ“ Shell.html lÃ¤dt mit Sidebar
  âœ“ Tab-Navigation funktioniert
  âœ“ Formulare laden mit echten Daten
  âœ“ API-Server lÃ¤uft zuverlÃ¤ssig
  âœ“ VBA-Bridge fÃ¼r erweiterte Funktionen
  âœ“ Automatischer Start mit START_ALLES.bat

Das System ist PRODUKTIVREIF!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Support: Siehe CLAUDE.md oder HTML_RULES.txt

Zuletzt aktualisiert: 14.01.2026
Getestet und funktional âœ…

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
