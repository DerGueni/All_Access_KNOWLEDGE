<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planungsübersicht - CONSYS</title>
    <link rel="stylesheet" href="css/app-layout.css">
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/form-titles.css">
    <link rel="stylesheet" href="css/unified-header.css">
    <style>
        /* Planungsübersicht spezifische Styles */
        .dp-container.no-menu {
            display: flex;
            flex-direction: column;
            height: 100vh;
            background: #f5f5f5;
        }
        .dp-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .dp-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 20px;
            background: #4316B2;
            color: white;
            flex-wrap: wrap;
            gap: 10px;
        }
        .dp-header .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .dp-header .dp-title {
            font-size: 16px;
            font-weight: 700;
            color: white;
            margin: 0;
        }
        .dp-header .header-center {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .dp-header .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .dp-date-input {
            padding: 5px 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 13px;
        }
        .dp-btn {
            padding: 6px 12px;
            background: #fff;
            color: #333;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        .dp-btn:hover {
            background: #e0e0e0;
        }
        .dp-btn-nav {
            padding: 6px 10px;
            background: #fff;
            color: #333;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
        }
        .dp-btn-nav:hover {
            background: #e0e0e0;
        }
        .filter-options {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        .filter-checkbox {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            color: white;
        }
        .dp-input-small {
            width: 50px;
            padding: 3px 5px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 12px;
        }
        .version-info {
            display: flex;
            gap: 10px;
            font-size: 11px;
            color: rgba(255,255,255,0.8);
        }

        /* Tabelle */
        .dp-table-container {
            flex: 1;
            overflow: auto;
            padding: 10px;
        }
        .dp-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            font-size: 11px;
        }
        .dp-table th, .dp-table td {
            border: 1px solid #ccc;
            padding: 4px 6px;
        }
        .dp-header-row th {
            background: #4316B2;
            color: white;
            text-align: center;
            font-weight: 600;
        }
        .dp-subheader-row th {
            background: #6633CC;
            color: white;
            text-align: center;
            font-size: 10px;
        }
        .th-content {
            padding: 5px;
        }
        .th-content.cyan {
            background: #00CED1;
            color: #000;
        }
        .col-auftrag {
            min-width: 180px;
            max-width: 220px;
            vertical-align: top;
            background: #f9f9f9;
        }
        .col-day {
            min-width: 180px;
        }
        .sub-col {
            min-width: 60px;
        }
        .auftrag-sub {
            min-width: 180px;
        }

        /* Zeilen */
        .dp-row {
            cursor: pointer;
        }
        .dp-row:hover {
            background: #e8f4ff;
        }
        .dp-row.selected {
            background: #cce5ff;
        }
        .auftrag-row td:first-child {
            font-weight: 600;
        }
        .ma-name {
            font-size: 10px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 80px;
        }
        .zeit {
            font-size: 10px;
            text-align: center;
        }
        .highlight-cyan {
            background: #00CED1 !important;
        }
        .highlight-yellow {
            background: #FFD700 !important;
        }

        /* MA-Zelle für DblClick */
        .ma-zelle {
            cursor: pointer;
        }
        .ma-zelle:hover {
            background: #fffacd;
        }
        .ma-zelle.selected {
            background: #ffeb3b;
            outline: 2px solid #f57c00;
        }

        /* Tag-Header für DblClick */
        .tag-header {
            cursor: pointer;
        }
        .tag-header:hover {
            background: #5a3dd8 !important;
        }

        /* Footer */
        .dp-footer {
            display: flex;
            justify-content: space-between;
            padding: 8px 20px;
            background: #eee;
            border-top: 1px solid #ccc;
            font-size: 12px;
        }
    </style>
</head>
<body data-active-menu="planungsuebersicht">
    <div class="dp-container no-menu">
        <!-- Hauptbereich (ohne Menu - wird aus Access geöffnet) -->
        <main class="dp-main">
            <!-- Header -->
            <header class="dp-header">
                <div class="header-left">
                    <div class="dp-logo"></div>
                    <h1 class="dp-title">Planungsübersicht</h1>
                </div>
                <div class="header-center">
                    <input type="date" id="datStartdatum" class="dp-date-input" value="">
                    <button class="dp-btn" id="btnStartdatumAendern">Startdatum Ändern</button>
                    <button class="dp-btn-nav" id="btnVorwoche" title="3 Tage zurück">&#9664;</button>
                    <button class="dp-btn-nav" id="btnNachwoche" title="3 Tage vor">&#9654;</button>
                    <button class="dp-btn" id="btnAbHeute">Ab Heute</button>
                </div>
                <div class="header-right">
                    <div class="filter-options">
                        <label class="filter-checkbox">
                            <input type="checkbox" id="chkNurFreieSchichten">
                            Nur freie Schichten anzeigen
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" id="chkWenigerAls">
                            Nur Aufträge mit weniger als
                            <input type="number" id="txtPositionen" class="dp-input-small" value="25" min="1" max="100">
                            Positionen anzeigen
                        </label>
                    </div>
                    <button class="dp-btn" id="btnUebersichtDrucken">Übersicht drucken</button>
                    <div class="version-info">
                        <span id="lblVersion">FE | V2.1</span>
                        <span id="lblDatum"></span>
                    </div>
                </div>
            </header>

            <!-- Planungs Tabelle -->
            <div class="dp-table-container">
                <table class="dp-table" id="tblPlanung">
                    <thead>
                        <tr class="dp-header-row">
                            <th class="col-auftrag" rowspan="2">
                                <div class="th-content cyan">Auftrag / Veranstaltung</div>
                            </th>
                            <th class="col-day tag-header" colspan="3" id="thTag1" data-day-offset="0">
                                <div class="th-content">Tag 1</div>
                            </th>
                            <th class="col-day tag-header" colspan="3" id="thTag2" data-day-offset="1">
                                <div class="th-content">Tag 2</div>
                            </th>
                            <th class="col-day tag-header" colspan="3" id="thTag3" data-day-offset="2">
                                <div class="th-content">Tag 3</div>
                            </th>
                            <th class="col-day tag-header" colspan="3" id="thTag4" data-day-offset="3">
                                <div class="th-content">Tag 4</div>
                            </th>
                            <th class="col-day tag-header" colspan="3" id="thTag5" data-day-offset="4">
                                <div class="th-content">Tag 5</div>
                            </th>
                            <th class="col-day tag-header" colspan="3" id="thTag6" data-day-offset="5">
                                <div class="th-content">Tag 6</div>
                            </th>
                            <th class="col-day tag-header" colspan="3" id="thTag7" data-day-offset="6">
                                <div class="th-content">Tag 7</div>
                            </th>
                        </tr>
                        <tr class="dp-subheader-row">
                            <th class="sub-col auftrag-sub">Auftrag Objekt Ort</th>
                            <th class="sub-col">Name</th><th class="sub-col">von</th><th class="sub-col">bis</th>
                            <th class="sub-col">Name</th><th class="sub-col">von</th><th class="sub-col">bis</th>
                            <th class="sub-col">Name</th><th class="sub-col">von</th><th class="sub-col">bis</th>
                            <th class="sub-col">Name</th><th class="sub-col">von</th><th class="sub-col">bis</th>
                            <th class="sub-col">Name</th><th class="sub-col">von</th><th class="sub-col">bis</th>
                            <th class="sub-col">Name</th><th class="sub-col">von</th><th class="sub-col">bis</th>
                            <th class="sub-col">Name</th><th class="sub-col">von</th><th class="sub-col">bis</th>
                        </tr>
                    </thead>
                    <tbody id="tbody_Planung">
                        <tr>
                            <td colspan="22" style="text-align:center;padding:40px;color:#666;">
                                Lade Planungsdaten...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Footer -->
            <footer class="dp-footer">
                <div class="footer-left">
                    <span id="lblStatus">Bereit</span>
                </div>
                <div class="footer-right">
                    <span id="lblAnzAuftraege">0 Aufträge</span>
                </div>
            </footer>
        </main>
    </div>

    <script type="module" src="logic/frm_VA_Planungsuebersicht.logic.js"></script>

    <!-- WebView2 Bridge für Access-Integration -->
    <script src="js/webview2-bridge.js"></script>
</body>
</html>
