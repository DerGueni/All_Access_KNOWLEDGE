<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abwesenheitsplanung - CONSYS</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #8080c0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        .left-menu {
            width: 185px;
            background-color: #6060a0;
            padding: 5px;
            display: flex;
            flex-direction: column;
            gap: 2px;
            overflow-y: auto;
        }

        .menu-header {
            background-color: #000080;
            color: white;
            padding: 6px;
            text-align: center;
            font-weight: bold;
            font-size: 12px;
            margin-bottom: 3px;
        }

        .menu-btn {
            background: linear-gradient(to bottom, #d0d0e0, #a0a0c0);
            padding: 8px 10px;
            font-size: 12px;
            color: #000;
            text-decoration: none;
            display: block;
            text-align: center;
            cursor: pointer;
            font-weight: 500;
            position: relative;
            border: none;
            margin: 1px 0;
            overflow: visible;
        }

        /* Obere helle Kante - 4px nach rechts versetzt */
        .menu-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: calc(100% - 4px);
            height: 2px;
            background: #ffffff;
            z-index: 1;
        }

        /* Untere dunkle Kante - 4px nach links versetzt */
        .menu-btn::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: calc(100% - 4px);
            height: 2px;
            background: #404070;
            z-index: 1;
        }

        .menu-btn:hover {
            background: linear-gradient(to bottom, #e0e0f0, #b0b0d0);
        }

        .menu-btn:active {
            background: linear-gradient(to bottom, #b0b0d0, #9090b0);
        }

        .menu-btn:active::before {
            background: #404070;
            left: 4px;
            width: calc(100% - 4px);
        }

        .menu-btn:active::after {
            background: #ffffff;
            right: 4px;
            width: calc(100% - 4px);
        }

        .menu-btn.active {
            background: linear-gradient(to bottom, #a0a0d0, #8080b0);
        }

        .menu-btn.active::before {
            background: #505080;
            left: 4px;
            width: calc(100% - 4px);
        }

        .menu-btn.active::after {
            background: #c0c0d8;
            right: 4px;
            width: calc(100% - 4px);
        }

        .app-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background-color: #b8b8d8;
        }

        .form-header {
            background-color: #000080;
            color: white;
            padding: 8px 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            font-weight: bold;
        }

        .header-btn-icon {
            background: linear-gradient(to bottom, #d0d0e0, #a0a0c0);
            border: 1px solid;
            border-color: #e0e0f0 #606090 #606090 #e0e0f0;
            padding: 4px 8px;
            cursor: pointer;
            font-size: 16px;
        }

        .header-btn-icon:hover {
            background: linear-gradient(to bottom, #e0e0f0, #b0b0d0);
        }

        .content-area {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
            background-color: #b8b8d8;
        }

        .field-row {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .field-row label {
            min-width: 100px;
            font-size: 11px;
        }

        .input-large, .input-field, .input-date, .input-time {
            padding: 4px 6px;
            border: 1px solid #7070a0;
            background-color: white;
            font-size: 11px;
        }

        .input-large { width: 300px; }
        .input-field { flex: 1; }
        .input-date { width: 110px; }
        .input-time { width: 60px; }

        .main-content-area {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .input-section {
            flex: 0 0 350px;
            background-color: #c0c0d0;
            padding: 10px;
            border: 1px solid #7070a0;
        }

        fieldset {
            border: 1px solid #7070a0;
            padding: 10px;
            margin-bottom: 10px;
        }

        .button-section {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(to bottom, #d0d0e0, #a0a0c0);
            border: 1px solid;
            border-color: #e0e0f0 #606090 #606090 #e0e0f0;
            padding: 5px 10px;
            font-size: 11px;
            cursor: pointer;
        }

        .btn:hover {
            background: linear-gradient(to bottom, #e0e0f0, #b0b0d0);
        }

        .btn-primary {
            background: linear-gradient(to bottom, #6080e0, #4060c0);
            color: white;
            border-color: #8090f0 #2040a0 #2040a0 #8090f0;
        }

        .btn-primary:hover {
            background: linear-gradient(to bottom, #7090f0, #5070d0);
        }

        .list-section {
            flex: 1;
            background-color: #c0c0d0;
            padding: 10px;
            border: 1px solid #7070a0;
        }

        .list-header {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 11px;
        }

        .table-container {
            background-color: white;
            border: 1px solid #7070a0;
            height: 400px;
            overflow-y: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
        }

        .data-table th {
            background-color: #d0d0e0;
            padding: 4px;
            border: 1px solid #7070a0;
            text-align: left;
            font-weight: bold;
        }

        .data-table td {
            padding: 4px;
            border: 1px solid #d0d0d0;
        }

        .status-bar {
            background-color: #c0c0d0;
            border-top: 1px solid #7070a0;
            padding: 4px 8px;
            display: flex;
            justify-content: space-between;
            font-size: 11px;
        }

        /* Vollbild-Button oben rechts */
        .fullscreen-btn {
            position: fixed;
            top: 5px;
            right: 5px;
            width: 24px;
            height: 24px;
            background: linear-gradient(to bottom, #e8e8e8, #c0c0c0);
            border: 2px solid;
            border-color: #ffffff #606060 #606060 #ffffff;
            cursor: pointer;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: #000080;
        }

        .fullscreen-btn:hover {
            background: linear-gradient(to bottom, #f0f0f0, #d0d0d0);
        }

        .fullscreen-btn:active {
            border-color: #606060 #ffffff #ffffff #606060;
        }

    </style>
    <link rel="stylesheet" href="consys-common.css">
</head>
<body>
    <button class="fullscreen-btn tiny-btn" id="fullscreenBtn" onclick="toggleFullscreen()" title="Vollbild">⛶</button>
    <aside class="left-menu">
        <div class="menu-header">HAUPTMENU</div>
        <button class="menu-btn" data-form="frm_DP_Dienstplan_MA">Dienstplanubersicht</button>
        <button class="menu-btn" data-form="frm_DP_Dienstplan_Objekt">Planungsubersicht</button>
        <button class="menu-btn" data-form="frm_va_Auftragstamm">Auftragsverwaltung</button>
        <button class="menu-btn" data-form="frm_MA_Mitarbeiterstamm">Mitarbeiterverwaltung</button>
        <button class="menu-btn" data-form="frm_MA_VA_Schnellauswahl">Offene Mail Anfragen</button>
        <button class="menu-btn" data-form="frm_MA_Zeitkonten">Excel Zeitkonten</button>
        <button class="menu-btn" data-form="frm_MA_Zeitkonten">Zeitkonten</button>
        <button class="menu-btn active" data-form="frm_Abwesenheiten">Abwesenheitsplanung</button>
        <button class="menu-btn">Dienstausweis erstellen</button>
        <button class="menu-btn" data-form="frm_MA_Zeitkonten">Stundenabgleich</button>
        <button class="menu-btn" data-form="frm_KD_Kundenstamm">Kundenverwaltung</button>
        <button class="menu-btn">Verrechnungssatze</button>
        <button class="menu-btn">Sub Rechnungen</button>
        <button class="menu-btn" data-form="frmOff_Outlook_aufrufen">E-Mail</button>
        <button class="menu-btn" data-form="frm_Menuefuehrung1">Menu 2</button>
        <button class="menu-btn" onclick="openHtmlAnsicht()">HTML Ansicht</button>
        <button class="menu-btn">System Info</button>
    </aside>

    <div class="app-container">
        <!-- Header -->
        <div class="form-header">
            <div>Abwesenheitsplanung</div>
            <div>
                <button class="header-btn-icon tiny-btn" id="btnRefresh" title="Aktualisieren">↻</button>
                <button class="header-btn-icon tiny-btn" id="btnExcel" title="Excel Export">📄</button>
            </div>
            <div>
                <span id="lblDatum"></span>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Mitarbeiter Auswahl -->
            <div class="field-row">
                <label>Mitarbeiter</label>
                <select id="cboMitarbeiter" class="input-large">
                    <option value="">-- Mitarbeiter wählen --</option>
                </select>
            </div>

            <!-- Hauptbereich mit Eingabe und Liste -->
            <div class="main-content-area">
                <!-- Eingabebereich links -->
                <div class="input-section">
                    <fieldset>
                        <div class="field-row">
                            <label>Grund:</label>
                            <select id="cboGrund" class="input-field">
                                <option value=""></option>
                                <option value="Urlaub">Urlaub</option>
                                <option value="Krank">Krankheit</option>
                                <option value="Privat verplant">Privat verplant</option>
                                <option value="Fortbildung">Fortbildung</option>
                                <option value="Sonstiges">Sonstiges</option>
                            </select>
                        </div>

                        <div class="field-row">
                            <label>Bemerkung:</label>
                            <input type="text" id="txtBemerkung" class="input-field">
                        </div>

                        <div class="field-row checkbox-row">
                            <input type="checkbox" id="chkNurWerktags">
                            <label for="chkNurWerktags">Nur Werktags (Mo - Fr)</label>
                        </div>

                        <div class="field-row date-row">
                            <label>von</label>
                            <input type="date" id="datVon" class="input-date">
                            <label>bis</label>
                            <input type="date" id="datBis" class="input-date">
                        </div>

                        <div class="field-row radio-row">
                            <label class="radio-label">
                                <input type="radio" name="zeitart" id="radGanztaegig" checked>
                                Ganztägig
                            </label>
                        </div>

                        <div class="field-row radio-row">
                            <label class="radio-label">
                                <input type="radio" name="zeitart" id="radStundenweise">
                                Stundenweise
                            </label>
                        </div>

                        <div class="field-row time-row" id="rowZeiten">
                            <label>von</label>
                            <input type="text" id="txtZeitVon" class="input-time" value="00:00" disabled>
                            <label>bis</label>
                            <input type="text" id="txtZeitBis" class="input-time" value="00:00" disabled>
                        </div>
                    </fieldset>

                    <!-- Buttons -->
                    <div class="button-section">
                        <button class="btn btn-primary" id="btnUebernehmen">Übernehmen</button>
                        <button class="btn" id="btnMarkierteLoeschen">Markierte löschen</button>
                        <button class="btn" id="btnAlleLoeschen">Alle löschen</button>
                    </div>
                </div>

                <!-- Abwesenheitszeiten rechts -->
                <div class="list-section">
                    <div class="list-header">Abwesenheitszeiten:</div>
                    <div class="table-container">
                        <table class="data-table" id="tblAbwesenheiten">
                            <thead>
                                <tr>
                                    <th class="col-select"></th>
                                    <th class="col-datvon">von</th>
                                    <th class="col-datbis">bis</th>
                                </tr>
                            </thead>
                            <tbody id="tbodyAbwesenheiten">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-left" id="lblStatus">Bereit</div>
            <div class="status-right">
                <span id="lblAnzahl">0 Einträge</span>
            </div>
        </div>
    </div>

    <script>
        // Datum anzeigen
        document.getElementById('lblDatum').textContent = new Date().toLocaleDateString('de-DE', {
            day: '2-digit', month: '2-digit', year: 'numeric'
        });

        // Radio-Button Handler für Zeitfelder
        document.getElementById('radGanztaegig').addEventListener('change', function() {
            if (this.checked) {
                document.getElementById('txtZeitVon').disabled = true;
                document.getElementById('txtZeitBis').disabled = true;
            }
        });

        document.getElementById('radStundenweise').addEventListener('change', function() {
            if (this.checked) {
                document.getElementById('txtZeitVon').disabled = false;
                document.getElementById('txtZeitBis').disabled = false;
            }
        });

        // Vollbild-Toggle Funktion (Browser Fullscreen API)
        function toggleFullscreen() {
            const btn = document.getElementById('fullscreenBtn');
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().then(() => {
                    btn.title = 'Vollbild beenden';
                }).catch(err => console.error('Fullscreen error:', err));
            } else {
                document.exitFullscreen().then(() => {
                    btn.title = 'Vollbild';
                }).catch(err => console.error('Exit fullscreen error:', err));
            }
        }

        document.addEventListener('fullscreenchange', () => {
            const btn = document.getElementById('fullscreenBtn');
            btn.title = document.fullscreenElement ? 'Vollbild beenden' : 'Vollbild';
        });
    </script>
    <script type="module" src="logic/frm_MA_Abwesenheit.logic.js"></script>

    <!-- WebView2 Bridge für Access-Integration -->
    <script src="../js/webview2-bridge.js"></script>
    <!-- API-Server Lifecycle (Auto-Start/Stop) -->
    <script src="../js/api-lifecycle.js"></script>
</body>
</html>


