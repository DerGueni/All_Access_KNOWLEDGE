{"id":"MOD_Info_ControlName_in_SubForm_Via_ActiveControl","name":"Info_ControlName_in_ SubForm_Via_ActiveControl","kind":"standard","procedures":[],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n\n'#######################################\n' In Einem einfachen Sub Formular\n'#######################################\n\n'\n' Dim myControl As Control\n' Dim myTarget As Control\n' Dim mySubTarget As Control\n'\n' Set myControl = Screen.ActiveForm.ActiveControl\n'\n'If myControl.ControlType = acSubform Then\n'    Set myTarget = myControl.Form.ActiveControl\n'Else\n'    Set myTarget = myControl\n'End If\n'\n'ctlname = myTarget.Name\n'\n'Debug.Print \"-------\"\n'Debug.Print Mainformname\n'Debug.Print SubformName\n'Debug.Print Application.Screen.ActiveForm.ActiveControl.Form.Name\n'Debug.Print ctlname\n'Debug.Print \"-------\"\n'\n\n'#######################################\n' In Einem SubSub Formular - z.B. wenn über allem das Navigationscontrol 'schwebt'\n'#######################################\n\n'        Set mycontrol = Screen.ActiveForm.ActiveControl\n'\n'        If mycontrol.ControlType = acSubform Then\n'        'If TypeName(myControl) = \"SubForm\" Then\n'            Set myTarget = mycontrol.Form.ActiveControl\n'        Else\n'            Set myTarget = mycontrol\n'        End If\n'        If myTarget.ControlType = acSubform Then\n'            Set mySubTarget = myTarget.Form.ActiveControl\n'        Else\n'            Set mySubTarget = mycontrol\n'        End If\n'        ctlname = mySubTarget.Name"}
