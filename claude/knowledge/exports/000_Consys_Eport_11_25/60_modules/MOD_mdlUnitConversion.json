{"id":"MOD_mdlUnitConversion","name":"mdlUnitConversion","kind":"standard","procedures":["Function C2F(c As Double) As Double","Function CalcUnitFactor(Unit As String) As Double","Function F2C(f As Double) As Double","Private Function RecurseTable(U, UnitTable As DAO.Recordset) As Double","Function ScaleUnit(Value As Double, Unit As String, NewUnit As String) As Double"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database   'Use database order for string comparisons\nOption Explicit\n\n' BeispielFormular zu der Umrechnungstabelle aus der NeatCd97.mdb von Microsoft\n' ftp://ftp.microsoft.com/softlib/mslfiles/neatcd97.exe\n' Benötigt die Tabelle  \"_tblUnit\"\n' Wird in \"frmHlp_Umrechnung\" verwendet\n\n' Some of the functions require data from the \"_tblUnit\" table.\n\n' This is a recursive table.  Entries should not be deleted unless\n' all dependant entries are also deleted.\n\n' The list of fields is provided in case you want to add more conversions:\n'\n'   UnitCode      A 5-letter code that makes up the primary key.\n'                 This can be lengthened or shortened but should be readable.\n'\n'   UnitName      The long name for the unit.\n'\n'   UnitType      Whether the unit is lengths, weights, volumes, etc.\n'                 Conversions should be done only against units of the same\n'                 type (len -> len, not len -> vol) or you will get nonsense\n'                 results.  You can base units of one type on units of another\n'                 type:\n'                      \"1 cc = 1 cm cubed\" would be entered as:\n'                      Unit=\"cc\", ComposedOf=\"cm\", Factor=1, Power=3\n'\n'   ComposedOf    What the other unit is based on.  e.g. \"cc\" composed of \"cm\".\n'                 Leave blank if this is the 'Base Unit' - what all other units\n'                 of that type are based on.\n'\n'                 Note: there is no 'Base Unit' for UnitType 'vol' or 'Wt'.  'Wt' is based on 'vol'\n'                 via \"kg\" and \"l\" (assuming density of water at 4 degrees centigrade) and\n'                 'vol' is based on 'len' via cubic measurements.\n'\n'   Factor        What's the conversion factor of the unit this is based on.\n'                 e.g. 1 Pt = 2 cups\n'\n'   Power         Must be 1 if the ComposedOf is the same unit type.\n'                 See UnitType (above) for example of different UnitType.\n\nFunction C2F(c As Double) As Double\n' Converts temperature from Celcius/Centigrade to Farenheit\n  C2F = 32 + c * 9 / 5\nEnd Function\n\nFunction CalcUnitFactor(Unit As String) As Double\n'\n' Returns the scaling factor to multiply a measurement in\n' to get the equivalent value in the base unit for that class.\n'\n' e.g.  ?CalcUnitFactor(\"cm\") returns .01, since \"m\" is the base unit.\n'\n  Dim MyDB As DAO.Database, UnitTable As DAO.Recordset\n  Set MyDB = CurrentDb\n  Set UnitTable = MyDB.OpenRecordset(\"_tblUnit\", dbOpenTable)\n  CalcUnitFactor = RecurseTable(Unit, UnitTable)\nEnd Function\n\nFunction F2C(f As Double) As Double\n' Converts temperature from Farenheit to Celcius/Centigrade\n  F2C = (f - 32) * 5 / 9\nEnd Function\n\nPrivate Function RecurseTable(U, UnitTable As DAO.Recordset) As Double\n'\n' Used by CalcUnitFactor and ScaleUnit to recursively convert measurements\n' from one type unit into another.\n'\n  Dim result As Double, i As Integer, f As Double\n  Dim comp As Variant, Factr As Double, Pwr As Integer\n  UnitTable.Index = \"PrimaryKey\"\n  UnitTable.Seek \"=\", U\n  RecurseTable = 1#\n  If UnitTable.NoMatch Then Exit Function\n  comp = UnitTable![ComposedOf]\n  Factr = UnitTable![Factor]\n  Pwr = UnitTable![Power]\n  If IsEmpty(comp) Then Exit Function\n  If IsNull(comp) Then Exit Function\n  If comp = \"\" Then Exit Function\n  result = 1\n  f = RecurseTable(comp, UnitTable)\n  For i = 1 To Pwr\n    result = result * f\n  Next i\n  RecurseTable = result * Factr\nEnd Function\n\nFunction ScaleUnit(Value As Double, Unit As String, NewUnit As String) As Double\n'\n' Converts a measurement from one unit to another.\n'\n' e.g.  ?ScaleUnit(5,\"cm\",\"m\") returns .05\n' i.e   5 cm is the same as .05 m\n'\n' You should only do this between units of a similar UnitType\n'\n  Dim MyDB As DAO.Database, UnitTable As DAO.Recordset\n  Set MyDB = CurrentDb\n  Set UnitTable = MyDB.OpenRecordset(\"_tblUnit\", dbOpenTable)\n  ScaleUnit = Value * RecurseTable(Unit, UnitTable) / RecurseTable(NewUnit, UnitTable)\nEnd Function"}
