{"id":"MOD_modExporterDiag","name":"modExporterDiag","kind":"standard","procedures":["Private Function EXPORT_BASE_DIAG() As String","Private Function JoinPath(base As String, subp As String) As String","Private Sub EnsureDir(ByVal path As String)","Private Sub AppendDiag(kind As String, target As String, eno As Long, eds As String)","Private Sub WriteTextDiag(path As String, content As String)","Public Sub Diag_WriteSmoke()","Public Sub Diag_ExportTablesOnly()","Public Sub Diag_PlainOpenPrint()"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"'============================= modExporterDiag.bas ===========================\nOption Compare Database\nOption Explicit\n\n' --- Exportbasis: HIER ggf. testweise auf C:\\Temp\\AccessFE_Export\\ setzen ---\nPrivate Function EXPORT_BASE_DIAG() As String\n    EXPORT_BASE_DIAG = \"C:\\Users\\guenther.siegert\\Documents\\000_Consys_Eport_11_25\\\"\nEnd Function\n\n' --- Hilfen: JoinPath / EnsureDir / Log + robustes Schreiben ---------------\nPrivate Function JoinPath(base As String, subp As String) As String\n    If Right$(base, 1) <> \"\\\" Then base = base & \"\\\"\n    JoinPath = base & subp\nEnd Function\n\nPrivate Sub EnsureDir(ByVal path As String)\n    If Len(Dir(path, vbDirectory)) = 0 Then MkDir path\nEnd Sub\n\nPrivate Sub AppendDiag(kind As String, target As String, eno As Long, eds As String)\n    On Error Resume Next\n    Dim root As String: root = EXPORT_BASE_DIAG()\n    Dim logDir As String: logDir = JoinPath(root, \"99_logs\")\n    If Len(Dir(logDir, vbDirectory)) = 0 Then MkDir logDir\n    Dim flog As String: flog = JoinPath(logDir, \"diag.log\")\n    Dim f As Integer: f = FreeFile\n    Open flog For Append As #f\n    Print #f, Format(Now, \"yyyy-mm-dd hh:nn:ss\") & \" | \" & kind & \" | \" & target & \" | \" & eno & \" | \" & eds\n    Close #f\nEnd Sub\n\nPrivate Sub WriteTextDiag(path As String, content As String)\n    On Error GoTo EH\n    Dim p As Long, folder As String, f As Integer\n    p = InStrRev(path, \"\\\")\n    If p > 0 Then\n        folder = Left$(path, p - 1)\n        If Len(Dir(folder, vbDirectory)) = 0 Then MkDir folder\n    End If\n    f = FreeFile\n    Open path For Output As #f\n    Print #f, content\n    Close #f\n    Exit Sub\nEH:\n    AppendDiag \"WRITE_FAIL\", path, err.Number, err.description\nEnd Sub\n\n' ======================= 1) Minimaler I/O-Smoke-Test ========================\nPublic Sub Diag_WriteSmoke()\n    On Error GoTo E\n    Dim root As String: root = EXPORT_BASE_DIAG()\n    EnsureDir root\n    EnsureDir JoinPath(root, \"zz_smoke\")\n    Dim fp As String: fp = JoinPath(root, \"zz_smoke\\hello.json\")\n    WriteTextDiag fp, \"{\"\"ok\"\":true,\"\"ts\"\":\"\"\" & Format(Now, \"yyyy-mm-dd hh:nn:ss\") & \"\"\"}\"\n    MsgBox \"Smoke OK: \" & fp, vbInformation\n    Exit Sub\nE:\n    MsgBox \"Smoke FAIL: \" & err.Number & \" - \" & err.description, vbCritical\n    AppendDiag \"SMOKE_FAIL\", \"Diag_WriteSmoke\", err.Number, err.description\nEnd Sub\n\n' ======================= 2) Nur Tabellen als Liste exportieren =============\nPublic Sub Diag_ExportTablesOnly()\n    On Error GoTo E\n    Dim root As String: root = EXPORT_BASE_DIAG()\n    EnsureDir JoinPath(root, \"10_tables\")\n\n    Dim db As DAO.Database: Set db = CurrentDb\n    Dim td As DAO.TableDef\n    Dim out As String: out = \"[\"\n\n    Dim first As Boolean: first = True\n    For Each td In db.TableDefs\n        If Left$(td.Name, 4) <> \"MSys\" Then\n            If Not first Then out = out & \",\"\n            out = out & \"\"\"\" & td.Name & \"\"\"\"\n            first = False\n        End If\n    Next td\n    out = out & \"]\"\n\n    Dim fp As String: fp = JoinPath(root, \"10_tables\\_tables_list.json\")\n    WriteTextDiag fp, out\n    MsgBox \"TablesOnly OK: \" & fp, vbInformation\n    Exit Sub\nE:\n    MsgBox \"TablesOnly FAIL: \" & err.Number & \" - \" & err.description, vbCritical\n    AppendDiag \"TABLES_FAIL\", \"Diag_ExportTablesOnly\", err.Number, err.description\nEnd Sub\n\n' ======================= 3) Harte Plain-VBA-Zeile (ohne Helpers) ===========\nPublic Sub Diag_PlainOpenPrint()\n    On Error GoTo E\n    Dim fp As String\n    fp = EXPORT_BASE_DIAG() & \"_plain_vba_test.txt\"\n    Dim f As Integer: f = FreeFile\n    Open fp For Output As #f\n    Print #f, \"hi\"\n    Close #f\n    MsgBox \"Plain I/O OK: \" & fp, vbInformation\n    Exit Sub\nE:\n    MsgBox \"Plain I/O FAIL: \" & err.Number & \" - \" & err.description, vbCritical\n    AppendDiag \"PLAIN_FAIL\", \"Diag_PlainOpenPrint\", err.Number, err.description\nEnd Sub\n'============================================================================\n"}
