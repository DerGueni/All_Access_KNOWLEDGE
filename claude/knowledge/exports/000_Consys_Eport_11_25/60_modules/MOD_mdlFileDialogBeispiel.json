{"id":"MOD_mdlFileDialogBeispiel","name":"mdlFileDialogBeispiel","kind":"standard","procedures":["Function MDBSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"Access Datenbank (*.mdb) suchen\") As String","Function MDFSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"search SQL Server database (*.mdf)\") As String","Function DocSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"WinWord Document (*.doc) suchen\") As String","Function TXTSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"Textdatei (*.txt) suchen\") As String","Function XLSSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"Exceldatei (*.txt) suchen\") As String","Function WavSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"Wav Datei (*.wav) suchen\") As String","Function AlleSuch(Optional ByVal startdir As String = PfadPlanungAktuell, Optional ByVal StBeschriftung As String = \"Datei (*.*) suchen\") As String","Function DllSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"Wav Datei (*.wav) suchen\") As String","Function BMPSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"BMP Datei (*.bmp) suchen\") As String","Function JPGSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"Bild Datei (*.jpg) suchen\") As String","Function Folder_Such(Optional txtDialogTitle As String = \"\") As String","Function XLSSuch_Mehrfach(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"search Excel file (*.xls)\") As String","Function SavefileSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"search filename for output\") As String","Function XLSSuchNeu(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"Exceldatei (*.txt) suchen\") As String"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n\nFunction MDBSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"Access Datenbank (*.mdb) suchen\") As String\n\nDim fd As New FileDialog\n         \nConst OFN_FILEMUSTEXIST = &H1000\nConst OFN_PATHMUSTEXIST = &H800\nConst OFN_HIDEREADONLY = &H4\nConst OFN_READONLY = &H1\nConst OFN_OVERWRITEPROMPT = &H2\n   \n   With fd  ' CommonDialog aufrufen\n    ' Erläuterungen im Code des KlassenModuls FileDialog\n      \n      .DialogTitle = StBeschriftung\n      .InitDir = startdir\n      \n'      .DefaultExt = \"TXT\"             'Standard-Endung wenn vom Benutzer nix anderes angegeben\n'                                      ' Ansonsten wird Filter1 verwendet\n'      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST Or OFN_READONLY\n      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST\n                      \n' Hier können bis max. 5 Filter für Datei-Endungen definiert werden\n      \n      .Filter1Text = \"ACCDB-Dateien (*.accdb)\"\n      .Filter1Suffix = \"*.accdb\"\n      .Filter2Text = \"MDB-Dateien (*.mdb)\"\n      .Filter2Suffix = \"*.mdb\"\n      .Filter3Text = \"MD*-Dateien (*.md*)\"\n      .Filter3Suffix = \"*.md*\"\n      .Filter4Text = \"Alle Dateien (*.*)\"\n      .Filter4Suffix = \"*.*\"\n'      .Filter4Text = \"Ascii-Dateien (*.asc)\"\n'      .Filter4Suffix = \"*.asc\"\n'      .Filter5Text = \"Text-Dateien (*.txt)\"\n'      .Filter5Suffix = \"*.txt\"\n\n'      ... bis max. Filter5Text/Suffix ...\n'\n      .ShowOpen                          ' oder .ShowSave\n   End With\n   \nMDBSuch = fd.fileName\n\nEnd Function\n\n\nFunction MDFSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"search SQL Server database (*.mdf)\") As String\n\nDim fd As New FileDialog\n         \nConst OFN_FILEMUSTEXIST = &H1000\nConst OFN_PATHMUSTEXIST = &H800\nConst OFN_HIDEREADONLY = &H4\nConst OFN_READONLY = &H1\nConst OFN_OVERWRITEPROMPT = &H2\n   \n   With fd  ' CommonDialog aufrufen\n    ' Erläuterungen im Code des KlassenModuls FileDialog\n      \n      .DialogTitle = StBeschriftung\n      .InitDir = startdir\n      \n'      .DefaultExt = \"TXT\"             'Standard-Endung wenn vom Benutzer nix anderes angegeben\n'                                      ' Ansonsten wird Filter1 verwendet\n'      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST Or OFN_READONLY\n      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST\n                      \n' Hier können bis max. 5 Filter für Datei-Endungen definiert werden\n      \n      .Filter1Text = \"MDF-Dateien (*.mdf)\"\n      .Filter1Suffix = \"*.mdf\"\n      .Filter2Text = \"Alle Dateien (*.*)\"\n      .Filter2Suffix = \"*.*\"\n'      .Filter3Text = \"MD*-Dateien (*.md*)\"\n'      .Filter3Suffix = \"*.md*\"\n'      .Filter4Text = \"Ascii-Dateien (*.asc)\"\n'      .Filter4Suffix = \"*.asc\"\n'      .Filter5Text = \"Text-Dateien (*.txt)\"\n'      .Filter5Suffix = \"*.txt\"\n\n'      ... bis max. Filter5Text/Suffix ...\n'\n      .ShowOpen                          ' oder .ShowSave\n   End With\n   \nMDFSuch = fd.fileName\n\nEnd Function\n\n\nFunction DocSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"WinWord Document (*.doc) suchen\") As String\n\nDim fd As New FileDialog\n \nConst OFN_FILEMUSTEXIST = &H1000\nConst OFN_PATHMUSTEXIST = &H800\nConst OFN_HIDEREADONLY = &H4\nConst OFN_READONLY = &H1\nConst OFN_OVERWRITEPROMPT = &H2\n \n   With fd  ' CommonDialog aufrufen\n    ' Erläuterungen im Code des KlassenModuls FileDialog\n      \n      .DialogTitle = StBeschriftung\n      .InitDir = startdir\n      \n'      .DefaultExt = \"TXT\"             'Standard-Endung wenn vom Benutzer nix anderes angegeben\n'                                      ' Ansonsten wird Filter1 verwendet\n'      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST Or OFN_READONLY\n      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST\n                      \n' Hier können bis max. 5 Filter für Datei-Endungen definiert werden\n      \n      .Filter1Text = \"Doc- und Dot-Dateien (*.do??)\"\n      .Filter1Suffix = \"*.do??\"\n      .Filter2Text = \"RTF-Dateien (*.rtf)\"\n      .Filter2Suffix = \"*.rtf\"\n      .Filter3Text = \"Ascii-Dateien (*.asc)\"\n      .Filter3Suffix = \"*.asc\"\n      .Filter4Text = \"Text-Dateien (*.txt)\"\n      .Filter4Suffix = \"*.txt\"\n      .Filter5Text = \"Alle Dateien (*.*)\"\n      .Filter5Suffix = \"*.*\"\n\n'      ... bis max. Filter5Text/Suffix ...\n'\n      .ShowOpen                          ' oder .ShowSave\n   End With\n   \nDocSuch = fd.fileName\n\nEnd Function\n\nFunction TXTSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"Textdatei (*.txt) suchen\") As String\n\nDim fd As New FileDialog\n         \nConst OFN_FILEMUSTEXIST = &H1000\nConst OFN_PATHMUSTEXIST = &H800\nConst OFN_HIDEREADONLY = &H4\nConst OFN_READONLY = &H1\nConst OFN_OVERWRITEPROMPT = &H2\n   \n   With fd  ' CommonDialog aufrufen\n    ' Erläuterungen im Code des KlassenModuls FileDialog\n      \n      .DialogTitle = StBeschriftung\n      .InitDir = startdir\n      \n      .DefaultExt = \"TXT\"             'Standard-Endung wenn vom Benutzer nix anderes angegeben\n'                                      ' Ansonsten wird Filter1 verwendet\n'      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST Or OFN_READONLY\n      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST\n                      \n' Hier können bis max. 5 Filter für Datei-Endungen definiert werden\n      \n      .Filter1Text = \"Text-Dateien (*.txt)\"\n      .Filter1Suffix = \"*.txt\"\n      .Filter2Text = \"Ascii-Dateien (*.asc)\"\n      .Filter2Suffix = \"*.asc\"\n      .Filter3Text = \"Alle Dateien (*.*)\"\n      .Filter3Suffix = \"*.*\"\n'      .Filter4Text = \"MDB-Dateien (*.mdb)\"\n'      .Filter4Suffix = \"*.mdb\"\n'      .Filter5Text = \"MD*-Dateien (*.md*)\"\n'      .Filter5Suffix = \"*.md*\"\n\n'      ... bis max. Filter5Text/Suffix ...\n'\n      .ShowOpen                          ' oder .ShowSave\n   End With\n   \nTXTSuch = fd.fileName\n\nEnd Function\n\n\nFunction XLSSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"Exceldatei (*.txt) suchen\") As String\n\nDim fd As New FileDialog\n         \nConst OFN_FILEMUSTEXIST = &H1000\nConst OFN_PATHMUSTEXIST = &H800\nConst OFN_HIDEREADONLY = &H4\nConst OFN_READONLY = &H1\nConst OFN_OVERWRITEPROMPT = &H2\n   \n   With fd  ' CommonDialog aufrufen\n    ' Erläuterungen im Code des KlassenModuls FileDialog\n      \n      .DialogTitle = StBeschriftung\n      .InitDir = startdir\n      \n      .DefaultExt = \"XLS\"             'Standard-Endung wenn vom Benutzer nix anderes angegeben\n'                                      ' Ansonsten wird Filter1 verwendet\n'      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST Or OFN_READONLY\n      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST\n                      \n' Hier können bis max. 5 Filter für Datei-Endungen definiert werden\n      \n      .Filter1Text = \"Excel-Dateien (*.xl*)\"\n      .Filter1Suffix = \"*.xl*\"\n      .Filter2Text = \"Excel-Dateien (*.xls)\"\n      .Filter2Suffix = \"*.xls\"\n      .Filter3Text = \"Alle Dateien (*.*)\"\n      .Filter3Suffix = \"*.*\"\n'      .Filter4Text = \"MDB-Dateien (*.mdb)\"\n'      .Filter4Suffix = \"*.mdb\"\n'      .Filter5Text = \"MD*-Dateien (*.md*)\"\n'      .Filter5Suffix = \"*.md*\"\n\n'      ... bis max. Filter5Text/Suffix ...\n'\n      .ShowOpen                          ' oder .ShowSave\n   End With\n   \nXLSSuch = fd.fileName\n\nEnd Function\n\n\n\nFunction WavSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"Wav Datei (*.wav) suchen\") As String\n\nDim fd As New FileDialog\n \nConst OFN_FILEMUSTEXIST = &H1000\nConst OFN_PATHMUSTEXIST = &H800\nConst OFN_HIDEREADONLY = &H4\nConst OFN_READONLY = &H1\nConst OFN_OVERWRITEPROMPT = &H2\n \n   With fd  ' CommonDialog aufrufen\n    ' Erläuterungen im Code des KlassenModuls FileDialog\n      \n      .DialogTitle = StBeschriftung\n      .InitDir = startdir\n      \n'      .DefaultExt = \"TXT\"             'Standard-Endung wenn vom Benutzer nix anderes angegeben\n'                                      ' Ansonsten wird Filter1 verwendet\n'      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST Or OFN_READONLY\n      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST\n                      \n' Hier können bis max. 5 Filter für Datei-Endungen definiert werden\n      \n      .Filter1Text = \"Wav-Dateien (*.wav)\"\n      .Filter1Suffix = \"*.wav\"\n      .Filter2Text = \"Alle Dateien (*.*)\"\n      .Filter2Suffix = \"*.*\"\n\n'      ... bis max. Filter5Text/Suffix ...\n'\n      .ShowOpen                          ' oder .ShowSave\n   End With\n   \nWavSuch = fd.fileName\n\nEnd Function\n\nFunction AlleSuch(Optional ByVal startdir As String = PfadPlanungAktuell, Optional ByVal StBeschriftung As String = \"Datei (*.*) suchen\") As String\n\nDim fd As New FileDialog\n \nConst OFN_FILEMUSTEXIST = &H1000\nConst OFN_PATHMUSTEXIST = &H800\nConst OFN_HIDEREADONLY = &H4\nConst OFN_READONLY = &H1\nConst OFN_OVERWRITEPROMPT = &H2\n \n   With fd  ' CommonDialog aufrufen\n    ' Erläuterungen im Code des KlassenModuls FileDialog\n      \n      .DialogTitle = StBeschriftung\n      .InitDir = startdir\n      \n'      .DefaultExt = \"TXT\"             'Standard-Endung wenn vom Benutzer nix anderes angegeben\n'                                      ' Ansonsten wird Filter1 verwendet\n'      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST Or OFN_READONLY\n      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST\n                      \n' Hier können bis max. 5 Filter für Datei-Endungen definiert werden\n      \n      .Filter1Text = \"Alle Dateien (*.*)\"\n      .Filter1Suffix = \"*.*\"\n\n'      ... bis max. Filter5Text/Suffix ...\n'\n      .ShowOpen                          ' oder .ShowSave\n   End With\n   \nAlleSuch = fd.fileName\n\nEnd Function\n\n\n\nFunction DllSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"Wav Datei (*.wav) suchen\") As String\n\nDim fd As New FileDialog\n \nConst OFN_FILEMUSTEXIST = &H1000\nConst OFN_PATHMUSTEXIST = &H800\nConst OFN_HIDEREADONLY = &H4\nConst OFN_READONLY = &H1\nConst OFN_OVERWRITEPROMPT = &H2\n \n   With fd  ' CommonDialog aufrufen\n    ' Erläuterungen im Code des KlassenModuls FileDialog\n'      .hWnd = Me.hWnd\n      .DialogTitle = StBeschriftung\n      .InitDir = startdir\n      \n'      .DefaultExt = \"TXT\"             'Standard-Endung wenn vom Benutzer nix anderes angegeben\n'                                      ' Ansonsten wird Filter1 verwendet\n'      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST Or OFN_READONLY\n      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST\n                      \n' Hier können bis max. 5 Filter für Datei-Endungen definiert werden\n      \n      .Filter1Text = \"Dll-Dateien (*.dll)\"\n      .Filter1Suffix = \"*.dll\"\n      .Filter2Text = \"Ocx-Dateien (*.ocx)\"\n      .Filter2Suffix = \"*.ocx\"\n      .Filter3Text = \"Alle Dateien (*.*)\"\n      .Filter3Suffix = \"*.*\"\n\n'      ... bis max. Filter5Text/Suffix ...\n'\n      .ShowOpen                          ' oder .ShowSave\n   End With\n   \nDllSuch = fd.fileName\n\nEnd Function\n\n\n\nFunction BMPSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"BMP Datei (*.bmp) suchen\") As String\n\nDim fd As New FileDialog\n \nConst OFN_FILEMUSTEXIST = &H1000\nConst OFN_PATHMUSTEXIST = &H800\nConst OFN_HIDEREADONLY = &H4\nConst OFN_READONLY = &H1\nConst OFN_OVERWRITEPROMPT = &H2\n \n   With fd  ' CommonDialog aufrufen\n    ' Erläuterungen im Code des KlassenModuls FileDialog\n      \n      .DialogTitle = StBeschriftung\n      .InitDir = startdir\n      \n'      .DefaultExt = \"TXT\"             'Standard-Endung wenn vom Benutzer nix anderes angegeben\n'                                      ' Ansonsten wird Filter1 verwendet\n'      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST Or OFN_READONLY\n      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST\n                      \n' Hier können bis max. 5 Filter für Datei-Endungen definiert werden\n      \n      .Filter1Text = \"BMP-Dateien (*.bmp)\"\n      .Filter1Suffix = \"*.bmp\"\n      .Filter2Text = \"JPG-Dateien (*.jpg)\"\n      .Filter2Suffix = \"*.jpg\"\n      .Filter3Text = \"Alle Dateien (*.*)\"\n      .Filter3Suffix = \"*.*\"\n\n'      ... bis max. Filter5Text/Suffix ...\n'\n      .ShowOpen                          ' oder .ShowSave\n   End With\n   \nBMPSuch = fd.fileName\n\nEnd Function\n\n\nFunction JPGSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"Bild Datei (*.jpg) suchen\") As String\n\nDim fd As New FileDialog\n \nConst OFN_FILEMUSTEXIST = &H1000\nConst OFN_PATHMUSTEXIST = &H800\nConst OFN_HIDEREADONLY = &H4\nConst OFN_READONLY = &H1\nConst OFN_OVERWRITEPROMPT = &H2\n \n   With fd  ' CommonDialog aufrufen\n    ' Erläuterungen im Code des KlassenModuls FileDialog\n      \n      .DialogTitle = StBeschriftung\n      .InitDir = startdir\n      \n'      .DefaultExt = \"TXT\"             'Standard-Endung wenn vom Benutzer nix anderes angegeben\n'                                      ' Ansonsten wird Filter1 verwendet\n'      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST Or OFN_READONLY\n      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST\n                      \n' Hier können bis max. 5 Filter für Datei-Endungen definiert werden\n      \n      .Filter1Text = \"JPG-Dateien (*.jpg)\"\n      .Filter1Suffix = \"*.jpg\"\n      .Filter2Text = \"BMP-Dateien (*.bmp)\"\n      .Filter2Suffix = \"*.bmp\"\n      .Filter3Text = \"Alle Dateien (*.*)\"\n      .Filter3Suffix = \"*.*\"\n\n'      ... bis max. Filter5Text/Suffix ...\n'\n      .ShowOpen                          ' oder .ShowSave\n   End With\n   \nJPGSuch = fd.fileName\n\nEnd Function\n\n\n\n\nFunction Folder_Such(Optional txtDialogTitle As String = \"\") As String\nOn Error GoTo Error_btnFolder_Click\n\n    Dim fd As New FileDialog\n    \n    ' Dialogtitel kann man setzen\n    If txtDialogTitle <> \"\" Then\n        fd.DialogTitle = txtDialogTitle\n    End If\n\n    ' hWndOwner des FileDialogs setzen, damit wird der Dialog auf das aktuelle Formular\n    ' ausgerichtet und klebt nicht in der linken oberen Ecke. Funktioniert aus\n    ' unerfindlichen Gründen nur, wenn das aktuelle Formular (Me) Popup ist oder mit\n    ' acDialog geöffnet wurde. Sonst ist es wenigstens unschädlich.\n'    If Me!chkHWnd1.Value = True Then\n        fd.hwnd = Application.hWndAccessApp\n'        fd.hwnd = Me.hwnd\n'    End If\n    \n    ' es wird nichts geöffnet, ist nur ein Beispiel\n    fd.ShowFolder\n    If fd.fileName = \"\" Then\n'        Folder_Such = \"(keins)\"\n        Folder_Such = \"\"\n    Else\n        Folder_Such = fd.fileName\n    End If\n    \n    ' man könnte auch schreiben\n    ' Me!Datei = fd.ShowFolder\n    ', da kriegt man aber das '(keins)' nicht angezeigt\n\nExit_btnFolder_Click:\n    Exit Function\nError_btnFolder_Click:\n    MsgBox err.Number & \": \" & err.description, , \"Folder_Such\"\n    Resume Exit_btnFolder_Click\nEnd Function\n\n\nFunction XLSSuch_Mehrfach(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"search Excel file (*.xls)\") As String\nOn Error GoTo XLSSuch_Mehrfach_Error\n' weitere Erläuterungen im Code des Klassenmoduls\n\n'Behelfsweise zum kompilieren, muss aber als Global definiert werden\nDim Global_MultiAuswahl() As String\n\n'Public Global_MultiAuswahl() As String\n\n\n' Konstanten zum rumspielen mit .Flags, sind im normalen Betrieb\n' selten oder nicht nötig\n Const OFN_FILEMUSTEXIST = &H1000\n Const OFN_PATHMUSTEXIST = &H800\n Const OFN_HIDEREADONLY = &H4\n Const OFN_READONLY = &H1\n Const OFN_OVERWRITEPROMPT = &H2\n Const OFN_ALLOWMULTISELECT = &H200\n Const OFN_EXPLORER = &H80000\n\n' ausführliches Beispiel ohne das ganze Theater hier unten, siehe auch Klassenmodul\n'   Dim fd As New FileDialog\n'   Dim Dateiname as String\n'\n'   With fd\n'      .DialogTitle = \"Mein Titel\"\n'      .DefaultExt = \"TXT\"             'Standard-Endung wenn vom Benutzer nix anderes angegeben\n'      .DefaultDir = \"c:\\\"\n'      .DefaultFileName = \"setuplog.txt\"\n'      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST Or OFN_HIDEREADONLY\n'      .Filter1Text = \"Text-Dateien\"\n'      .Filter1Suffix = \"*.txt\"\n'      .Filter2Text = \"Ascii-Dateien\"\n'      .Filter2Suffix = \"*.asc\"\n'      ... bis Filter5Text/Suffix ...\n'\n'      .ShowOpen                          ' oder .ShowSave\n'\n'      if fd.FileName = \"\" then exit sub   ' Abbruch durch Benutzer\n'      DateiName = fd.FileName\n'   End With\n   \n    Dim fd As New FileDialog\n    Dim i As Integer\n    Dim FocusAufAuswahl As Boolean\n        \n    ReDim Global_MultiAuswahl(0)\n        \n'    Me!btnNextFile.Visible = False\n'    Me!txtFileCount.Visible = False\n'    Me!txtFileNr.Visible = False\n        \n    fd.DialogTitle = StBeschriftung\n        \n    ' evtl. einiges vorbesetzen, ist aber nicht zwingend. Hier werden die\n    ' Eingaben aus dem Formular verarbeitet, sofern was drin steht\n    \n    ' Default-Filename, wird nur angezeigt. Die Datei (sofern vorhanden)\n    ' wird nicht markiert. Bewirkt noch keine Filterung.\n    'If Nz(Me!strDefFileName) <> \"\" Then fd.DefaultFileName = Me!strDefFileName ' sonst: NULL\n    \n    ' Default-Dateiendung, wird beim Speichern angehängt, wenn\n    ' keine andere angegeben wurde (z.B. 'txt')\n    ' HIER VÖLLIG SINNLOS (öffnen!), aber unschädlich\n    'If Nz(Me!strDefExt) <> \"\" Then fd.DefaultExt = Me!strDefExt ' sonst: NULL\n    \n    ' Verzeichnis, bei dem gestartet wird\n'    If Nz(Me!strDefDir) <> \"\" Then fd.DefaultDir = Me!strDefDir ' sonst: CurDir\n    fd.DefaultDir = startdir\n    \n'    ' Datei-Filter, es gehört immer Suffix/Text zusammen\n'    If Nz(Me!strFilterSuffix) <> \"\" Then\n'        fd.Filter1Suffix = Me!strFilterSuffix\n'        If Nz(Me!strFilterText) = \"\" Then\n'            fd.Filter1Text = \"Doofkopp: Wie heißen \" & Me!strFilterSuffix & \"-Dateien?\"\n'        Else\n'            fd.Filter1Text = Me!strFilterText\n'        End If\n'\n'        ' noch einen Filter für ALLE Dateien hinzufügen\n'        fd.Filter2Suffix = \"*.*\"\n'        fd.Filter2Text = \"Alle Dateien\"\n'    End If\n            \n      fd.Filter1Text = \"Excel-Dateien (*.xls?)\"\n      fd.Filter1Suffix = \"*.xls?\"\n      fd.Filter2Text = \"Excel-Dateien (*.xl*)\"\n      fd.Filter2Suffix = \"*.xl*\"\n      fd.Filter3Text = \"Alle Dateien (*.*)\"\n      fd.Filter3Suffix = \"*.*\"\n            \n    ' MultiSelect setzen wenn ausgewählt. Die maximale Länge des zurückgegeben\n    ' Strings (und damit die etwaige Anzahl der zurückgegebenen Dateien) kann\n    ' man über LEN_FILENAME_MULTISELECT im Klassenmodul einstellen (derzeit 10000)\n'    If Me!chkMultiSelect.Value = True Then\n        fd.MultiSelect = True   ' sonst: False\n'    End If\n    \n    ' wegen Kompatibilität zum OCX kann man hier einstellen, daß bei Selektion\n    ' mehrerer Dateien die einzelnen Dateinamen nicht über .GetNextFile geholt\n    ' werden sondern in der Originalform ankommen.\n'    If Me!chkMultiSelectOCXCompatible.Value = True Then\n'        fd.MultiSelectOCXCompatible = True ' sonst: False\n'        FocusAufAuswahl = True ' der String mit vbcharnull wird sonst nicht angezeigt\n'    End If\n    fd.MultiSelectOCXCompatible = False\n    \n    ' hWndOwner des FileDialogs setzen, damit wird der Dialog auf das aktuelle Formular\n    ' ausgerichtet und klebt nicht in der linken oberen Ecke. Funktioniert aus\n    ' unerfindlichen Gründen nur, wenn das aktuelle Formular (Me) Popup ist oder mit\n    ' acDialog geöffnet wurde. Sonst ist es wenigstens unschädlich.\n'    If Me!chkHWnd.Value = True Then\n'        fd.hWnd = Me.hWnd\n'    End If\n    \n    \n    ' es wird nichts geöffnet, ist nur ein Beispiel\n    fd.ShowOpen\n'    If fd.Filename = \"\" Then\n'        Me!Datei = \"(keine)\"\n'    Else\n'        Me!Datei = fd.Filename\n'    End If\n    \n    ' man könnte auch schreiben\n    ' Me!Datei = fd.ShowOpen\n    ', da kriegt man aber das '(keine)' nicht angezeigt\n    \n'    If FocusAufAuswahl Then Me!Datei.SetFocus ' zur Anzeige des Strings mit\n                                              ' chr(0) bei .MultiSelectOCXCompatible\n    \n    ' für Multiselect gehts weiter: mit dem eingeblendeten Button kriegt\n    ' man jeweils die nächste Datei angezeigt, wenn mehr als eine ausgewählt wurde\n    \n    If fd.FileCount > 1 Then\n'        Me!btnNextFile.Visible = True\n'        Me!txtFileCount.Visible = True\n'        Me!txtFileNr.Visible = True\n'\n'        If Me!chkMultiSelectOCXCompatible.Value = False Then\n'            Me!txtFileNr.Visible = True\n'            Me!txtFileNr.Caption = \"Datei 1\"\n'            Me!txtFileCount.Caption = \"von \" & fd.FileCount\n'        Else\n'            Me!txtFileCount.Caption = \"(gesamt: \" & fd.FileCount & \")\"\n'            Me!txtFileNr.Visible = False\n'        End If\n\n        ' da das Objekt fd geschlossen wird, wenn ich diese Sub verlasse,\n        ' muß ich mir hier die gewählten Dateien schnell merken.\n        ' Wenn sie direkt verarbeitet werden sollen, z.B. so:\n        \n        'MeineDatei = fd.GetNextFile\n        'Do Until MeineDatei = \"\"\n            '... irgendwas mit dem Dateinamen machen\n        'Loop\n        \n        ' kann man sich das auch sparen\n        \n        ReDim Global_MultiAuswahl(0 To fd.FileCount - 1)\n        \n        ' Achtung: .GetNextFile liefert zwar die nächste Datei,\n        ' aber eben nur einmal. Deswegen Ergebnis immer gleich merken.\n        ' Terminierung bei fd.GetNextFile=\"\" oder bei fd.FileCount\n        \n        For i = 1 To fd.FileCount - 1 ' die erste Datei haben wir oben schon angezeigt\n            Global_MultiAuswahl(i) = fd.GetNextFile\n        Next\n        \n'        AuswIdx = 1 ' Anzeige mit zweiter Datei beginnen, die erste steht schon da\n\n    End If\n    If fd.FileCount > 0 Then\n        Global_MultiAuswahl(0) = fd.fileName\n    End If\n    \nXLSSuch_Mehrfach_End:\n    Exit Function\n    \nXLSSuch_Mehrfach_Error:\n    MsgBox err.description, , \"XLSSuch_Mehrfach\"\n    On Error GoTo 0\n    Resume XLSSuch_Mehrfach_End\nEnd Function\n\n\nFunction SavefileSuch(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"search filename for output\") As String\n\nDim fd As New FileDialog\n \nConst OFN_FILEMUSTEXIST = &H1000\nConst OFN_PATHMUSTEXIST = &H800\nConst OFN_HIDEREADONLY = &H4\nConst OFN_READONLY = &H1\nConst OFN_OVERWRITEPROMPT = &H2\n \n   With fd  ' CommonDialog aufrufen\n    ' Erläuterungen im Code des KlassenModuls FileDialog\n      \n      .DialogTitle = StBeschriftung\n      .InitDir = startdir\n      \n'      .DefaultExt = \"TXT\"             'Standard-Endung wenn vom Benutzer nix anderes angegeben\n'                                      ' Ansonsten wird Filter1 verwendet\n'      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST Or OFN_READONLY\n      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST\n'      .Flags = OFN_PATHMUSTEXIST\n                      \n' Hier können bis max. 5 Filter für Datei-Endungen definiert werden\n      \n      .Filter1Text = \"Alle Dateien (*.*)\"\n      .Filter1Suffix = \"*.*\"\n\n'      ... bis max. Filter5Text/Suffix ...\n'\n'      .ShowOpen                          ' oder .ShowSave\n      .ShowSave\n   End With\n   \nSavefileSuch = fd.fileName\n\nEnd Function\n\nFunction XLSSuchNeu(Optional ByVal startdir As String = \"C:\\\", Optional ByVal StBeschriftung As String = \"Exceldatei (*.txt) suchen\") As String\n\nDim fd As New FileDialog\n         \nConst OFN_FILEMUSTEXIST = &H1000\nConst OFN_PATHMUSTEXIST = &H800\nConst OFN_HIDEREADONLY = &H4\nConst OFN_READONLY = &H1\nConst OFN_OVERWRITEPROMPT = &H2\n   \n   With fd  ' CommonDialog aufrufen\n    ' Erläuterungen im Code des KlassenModuls FileDialog\n      \n      .DialogTitle = StBeschriftung\n      .InitDir = startdir\n      \n      .DefaultExt = \"XLS\"             'Standard-Endung wenn vom Benutzer nix anderes angegeben\n'                                      ' Ansonsten wird Filter1 verwendet\n'      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST Or OFN_READONLY\n'      .Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST\n      .Flags = OFN_OVERWRITEPROMPT Or OFN_PATHMUSTEXIST\n\n' Hier können bis max. 5 Filter für Datei-Endungen definiert werden\n      \n      .Filter1Text = \"Excel-Dateien (*.xls)\"\n      .Filter1Suffix = \"*.xls\"\n      .Filter2Text = \"Excel-Dateien (*.xl*)\"\n      .Filter2Suffix = \"*.xl*\"\n      .Filter3Text = \"Alle Dateien (*.*)\"\n      .Filter3Suffix = \"*.*\"\n'      .Filter4Text = \"MDB-Dateien (*.mdb)\"\n'      .Filter4Suffix = \"*.mdb\"\n'      .Filter5Text = \"MD*-Dateien (*.md*)\"\n'      .Filter5Suffix = \"*.md*\"\n\n'      ... bis max. Filter5Text/Suffix ...\n'\n      '.ShowOpen\n      '' oder\n      .ShowSave\n   \n   End With\n   \nXLSSuchNeu = fd.fileName\n\nEnd Function"}
