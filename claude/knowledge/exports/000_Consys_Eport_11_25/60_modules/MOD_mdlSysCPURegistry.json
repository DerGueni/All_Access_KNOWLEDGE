{"id":"MOD_mdlSysCPURegistry","name":"mdlSysCPURegistry","kind":"standard","procedures":["Sub Test_Click()","Function GetCPUSpeedName(n As Long) As Variant","Public Function HiByte(ByVal wParam As Integer) As Byte","Public Function LoByte(ByVal wParam As Integer) As Byte"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n\n'Flags for GetSystemInfo\nPrivate Const PROCESSOR_INTEL_386 As Long = 386\nPrivate Const PROCESSOR_INTEL_486 As Long = 486\nPrivate Const PROCESSOR_INTEL_PENTIUM As Long = 586\nPrivate Const PROCESSOR_MIPS_R4000 As Long = 4000\nPrivate Const PROCESSOR_ALPHA_21064 As Long = 21064\nPrivate Const PROCESSOR_PPC_601 As Long = 601\nPrivate Const PROCESSOR_PPC_603 As Long = 603\nPrivate Const PROCESSOR_PPC_604 As Long = 604\nPrivate Const PROCESSOR_PPC_620 As Long = 620\nPrivate Const PROCESSOR_HITACHI_SH3 As Long = 10003    'Windows CE\nPrivate Const PROCESSOR_HITACHI_SH3E As Long = 10004   'Windows CE\nPrivate Const PROCESSOR_HITACHI_SH4 As Long = 10005    'Windows CE\nPrivate Const PROCESSOR_MOTOROLA_821 As Long = 821     'Windows CE\nPrivate Const PROCESSOR_SHx_SH3 As Long = 103          'Windows CE\nPrivate Const PROCESSOR_SHx_SH4 As Long = 104          'Windows CE\nPrivate Const PROCESSOR_STRONGARM As Long = 2577       'Windows CE - 0xA11\nPrivate Const PROCESSOR_ARM720 As Long = 1824          'Windows CE - 0x720\nPrivate Const PROCESSOR_ARM820 As Long = 2080          'Windows CE - 0x820\nPrivate Const PROCESSOR_ARM920 As Long = 2336          'Windows CE - 0x920\nPrivate Const PROCESSOR_ARM_7TDMI As Long = 70001      'Windows CE\n\nPrivate Const PROCESSOR_ARCHITECTURE_INTEL As Long = 0\nPrivate Const PROCESSOR_ARCHITECTURE_MIPS As Long = 1\nPrivate Const PROCESSOR_ARCHITECTURE_ALPHA As Long = 2\nPrivate Const PROCESSOR_ARCHITECTURE_PPC As Long = 3\nPrivate Const PROCESSOR_ARCHITECTURE_SHX As Long = 4\nPrivate Const PROCESSOR_ARCHITECTURE_ARM As Long = 5\nPrivate Const PROCESSOR_ARCHITECTURE_IA64 As Long = 6\nPrivate Const PROCESSOR_ARCHITECTURE_ALPHA64 As Long = 7\nPrivate Const PROCESSOR_ARCHITECTURE_UNKNOWN   As Long = &HFFFF\n\nPrivate Const PROCESSOR_LEVEL_80386 As Long = 3\nPrivate Const PROCESSOR_LEVEL_80486 As Long = 4\nPrivate Const PROCESSOR_LEVEL_PENTIUM As Long = 5\nPrivate Const PROCESSOR_LEVEL_PENTIUMII As Long = 6\n\nPrivate Const sCPURegKey = \"HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0\"\n\nPrivate Const HKEY_LOCAL_MACHINE As Long = &H80000002\n\nPrivate Type SYSTEM_INFO\n   dwOemID As Long\n   dwPageSize As Long\n   lpMinimumApplicationAddress As Long\n   lpMaximumApplicationAddress As Long\n   dwActiveProcessorMask As Long\n   dwNumberOfProcessors As Long\n   dwProcessorType As Long\n   dwAllocationGranularity As Long\n   wProcessorLevel As Integer\n   wProcessorRevision As Integer\nEnd Type\n\nPrivate Declare PtrSafe Sub GetSystemInfo Lib \"kernel32\" _\n   (lpSystemInfo As SYSTEM_INFO)\n\nPrivate Declare PtrSafe Function RegCloseKey Lib \"advapi32.dll\" _\n   (ByVal hKey As Long) As Long\n\nPrivate Declare PtrSafe Function RegOpenKey Lib \"advapi32.dll\" _\n   Alias \"RegOpenKeyA\" _\n  (ByVal hKey As Long, _\n   ByVal lpSubKey As String, _\n   phkResult As Long) As Long\n\nPrivate Declare PtrSafe Function RegQueryValueEx Lib \"advapi32.dll\" _\n   Alias \"RegQueryValueExA\" _\n  (ByVal hKey As Long, _\n   ByVal lpValueName As String, _\n   ByVal lpReserved As Long, _\n   lpType As Long, _\n   lpData As Any, _\n   lpcbData As Long) As Long\n   \n\nSub Test_Click()\n\n   Dim si As SYSTEM_INFO\n   Dim tmp As String\n   \n   Call GetSystemInfo(si)\n   \n   Debug.Print \"CPU Speed\", , \" \" & GetCPUSpeedName(1) & \" MHz\"\n   Debug.Print \"Processor Name\", \" \" & GetCPUSpeedName(2)\n   Debug.Print \"----------------------------------------------\"\n   Debug.Print \"Number Of Processors\", si.dwNumberOfProcessors\n   \n   Select Case si.dwProcessorType\n      Case PROCESSOR_INTEL_386: tmp = \"386\"\n      Case PROCESSOR_INTEL_486: tmp = \"486\"\n      Case PROCESSOR_INTEL_PENTIUM: tmp = \"Pentium\"\n      Case PROCESSOR_MIPS_R4000: tmp = \"MIPS 4000\"\n      Case PROCESSOR_ALPHA_21064: tmp = \"Alpha\"\n   End Select\n\n   Debug.Print \"Processor Type\", si.dwProcessorType, tmp\n\n   Select Case si.wProcessorLevel\n      Case PROCESSOR_LEVEL_80386: tmp = \"Intel 80386\"\n      Case PROCESSOR_LEVEL_80486: tmp = \"Intel 80486\"\n      Case PROCESSOR_LEVEL_PENTIUM: tmp = \"Intel Pentium\"\n      Case PROCESSOR_LEVEL_PENTIUMII: tmp = \"Intel Pentium Pro or Pentium II\"\n   End Select\n   \n   Debug.Print \"Processor Level\", si.wProcessorLevel, tmp\n   \n   Debug.Print \"Processor Revision\", si.wProcessorRevision, _\n         \"Model \"; HiByte(si.wProcessorRevision) & _\n         \", Stepping \" & LoByte(si.wProcessorRevision)\n\nEnd Sub\n\n\nFunction GetCPUSpeedName(n As Long) As Variant\n   \n   Dim hKey As Long\n   Dim cpuSpeed As Long\n   Dim cpuName As String\n   Dim i As Long\n    \nIf n = 1 Then\n  'Open CPU key\n   Call RegOpenKey(HKEY_LOCAL_MACHINE, sCPURegKey, hKey)\n                    \n  'and retrieve the value\n   Call RegQueryValueEx(hKey, \"~MHz\", 0, 0, cpuSpeed, 4)\n   Call RegCloseKey(hKey)\n   \n   GetCPUSpeedName = cpuSpeed\nElse\n  \n  'Open CPU key\n   Call RegOpenKey(HKEY_LOCAL_MACHINE, sCPURegKey, hKey)\n                    \n  \n  Dim lType As Long\n  Dim cch As Long\n  Dim lrc As Long\n  \n      ' Determine the size and type of data to be read\n    lrc = RegQueryValueExNULL(hKey, \"ProcessorNameString\", 0&, lType, 0&, cch)\n    If lrc <> ERROR_NONE Then Error 5\n\n    Select Case lType\n        ' For strings\n        Case REG_SZ:\n            cpuName = String(cch, 0)\n            lrc = RegQueryValueExString(hKey, \"ProcessorNameString\", 0&, lType, _\n            cpuName, cch)\n            If lrc = ERROR_NONE Then\n                cpuName = Left$(cpuName, cch - 1)\n            Else\n                cpuName = Empty\n            End If\n            Call RegCloseKey(hKey)\n        Case Else\n          Error 5\n            \n    End Select\n   \n   GetCPUSpeedName = cpuName\n\nEnd If\nEnd Function\n\n\nPublic Function HiByte(ByVal wParam As Integer) As Byte\n   \n  'note: VB4-32 users should declare this function As Integer\n   HiByte = (wParam And &HFF00&) \\ (&H100)\n\nEnd Function\n\n\nPublic Function LoByte(ByVal wParam As Integer) As Byte\n\n  'note: VB4-32 users should declare this function As Integer\n   LoByte = wParam And &HFF&\n\nEnd Function\n'--end block--'\n"}
