{"id":"MOD_mdlOutlookHTMLSendMitBild","name":"mdlOutlookHTMLSendMitBild","kind":"standard","procedures":["Function sendMail_Mit_Bild_obd()","Private Function BinexStd(s As String, ID As Long)","Function TestmailBild()"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n\n\nFunction sendMail_Mit_Bild_obd()\n    Dim TempFilePath As String\n    \n    Dim PicHeader As String\n    Dim att1 As String\n    Dim appOutlook\n    Dim message\n    Const olMailItem As Long = 0\n    Const olByValue As Long = 1\n    Dim s As String, t As String, U As String\n    \n    s = Path_erzeugen(DBPfad() & \"Attach\\\", False)\n    s = DBPfad() & \"Attach\\\"\n    Call BinexStd(s & \"DummyTest.txt\", 9)\n    Call BinexStd(s & \"siemens_Mail_Header_Std.jpg\", 10)\n    \n    PicHeader = s & \"siemens_Mail_Header_std.jpg\"\n    att1 = s & \"DummyTest.txt\"\n    \n    'Create a new Microsoft Outlook session\n    Set appOutlook = CreateObject(\"outlook.application\")\n    'create a new message\n    Set message = appOutlook.CreateItem(olMailItem)\n      \n    \n    With message\n        .Subject = \"My mail auto Object\"\n\n        .htmlBody = \"<span LANG=EN>\"\n       ' Der Param 0 nach olByValue bedeutet: Bei dem Wert 0 wird der Anhang ausgeblendet\n        .Attachments.Add PicHeader, olByValue, 0\n         .Attachments.Add att1, olByValue, 1\n        \n'          .HTMLBody = .HTMLBody & \"<p class=style2><span LANG=EN><font FACE=Calibri SIZE=3>\" _\n'            & \"<img src='cid:siemens_Mail_Header.jpg'\" & \"width='850' height='198'><br>\" _\n'            & \"Hello,<br ><br >\"\n            \n            \ns = \"\"\ns = s & \"<span LANG=EN><img src='cid:siemens_Mail_Header_std.jpg'\" & \"width='850' height='198'><br>\"\ns = s & \"<p class=style2><span LANG=EN><font FACE=Calibri SIZE=3>\"\ns = s & \"Hello,<br ><br >\"\ns = s & \"<div><font face=Arial size=2 color=black>Thank you very much for your\"\ns = s & \" participation at the Firex 2014 exhibition.</font></div><div>&nbsp;</div>\"\ns = s & \"<div><font face=Arial size=2 color=black>It was our pleasure to welcome you on our booth and we hope that you were able\"\ns = s & \" to gain new ideas, support </font></div>\"\ns = s & \"<div><font face=Arial size=2 color=black>and beneficial information for your business needs. </font></div>\"\ns = s & \"<div>&nbsp;</div>\"\ns = s & \"<div><font face=Arial size=2 color=black>Please have a look at the following links to find more information about \"\ns = s & \"the products you were interested in: </font></div>\"\ns = s & \"<ul><ul>\"\ns = s & \"<li><font face=Arial size=2 color=black>Siemens EX Solutions (see attached)</font></li>\"\ns = s & \"</ul></ul>\"\ns = s & \"<div><font face=Arial size=2 color=black>Should you have any questions or require further assistance, we would be pleased to help you.</font></div>\"\ns = s & \"<div><font face=Arial size=2 color=black>Please do not hesitate to contact your local Siemens contact at </font><font\"\ns = s & \"face=Arial size=2 color=blue><u>derrick.hall@siemens.com</u></font></div>\"\ns = s & \"<div>&nbsp;</div>\"\ns = s & \"<div><font face=Arial size=2 color=black>We look forward to a <strong>successful working relationship</strong> with you in the future.</font></div>\"\ns = s & \"<div>&nbsp;</div>\"\ns = s & \"<div><font face=Arial size=2 color=black>Best regards, </font></div>\"\ns = s & \"<div><font face=Arial size=2 color=black>&nbsp;&nbsp;</font></div>\"\ns = s & \"<div><font face=Arial size=2 color=black>Your Siemens Fire Safety Team</font></div>\"\ns = s & \"<div>&nbsp;</div></span>\"\n\n.htmlBody = s\n            \n'            The weekly dashboard is available \" _\n'            & \"<br>Find below an overview :<BR>\"\n            \n           \n        'we attached an invisible the embedded image\n'        TempFilePath = Environ$(\"temp\") & \"\\\"\n       ' Der Param 0 nach olByValue bedeutet: Bei dem Wert 0 wird der Anhang ausgeblendet\n'        .Attachments.Add TempFilePath & \"DashboardFile.jpg\", olByValue, 0\n           \n        'Then we add an html <img src=''> link to this image\n        'Note than you can customize width and height - not mandatory\n           \n'        .HTMLBody = .HTMLBody & \"<br><B>WEEKLY REPPORT:</B><br>\" _\n'            & \"<br>Best Regards,<br>Ed</font></span>\"\n            \n        .TO = \"contact1@email.com; contact2@email.com\"\n        .CC = \"contact3@email.com\"\n            \n        .Display\n        '.Send\n    End With\n\nEnd Function\n\nPrivate Function BinexStd(s As String, ID As Long)\nBinExport \"___Vorlagen_einlesen\", s, \"Picture\", ID\nEnd Function\n\n\nFunction TestmailBild()\n\n\n'Dim arr\n'arr = Array(\"D:\\GEZSpruch.jpg\")\n'Call sendOLEmbeddedHTMLGraphic(\"bobd@gmx.de\", , , \"TesteMail Bild\", \"Test\", arr)\n\nEnd Function\n"}
