{"id":"MOD_zmd_Whatsapp","name":"zmd_Whatsapp","kind":"standard","procedures":[],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n\n\n'Function WhatsAppAnfragen()\n'\n''MA_ID\n''MA_Name\n''Telefonnummer\n''Nachricht\n''Anhang\n''Status\n'\n'Dim rs      As Recordset\n'Dim sql     As String\n'\n'\n'    sql = \"SELECT * FROM [ztbl_WhatsApp]\" ' WHERE [Status] <> 'gesendet'\"\n'    Set rs = CurrentDb.OpenRecordset(sql)\n'    rs.MoveLast\n'    rs.MoveFirst\n'\n'    'Fire\n'    If Not rs.EOF Then Call WhatsAppVerschicken(rs)\n'\n'\n'End Function\n\n\n'\n''Verweis auf Selenium Type Library !\n'Function WhatsAppVerschicken(rs As Recordset) 'As String()\n'\n'\n'Dim bot As New WebDriver\n''Dim Bot As Object\n'Dim ks As New Keys\n'\n'\n'    'Benutzerprofil laden: Hier eigenes Benutzerprofil angeben\n'    Select Case Environ(\"UserName\")\n'        Case \"kypi\"\n'            bot.SetProfile \"C:\\Users\\kypi\\AppData\\Local\\Temp\\Selenium\\scoped_dir12440_675518715\\Default\\Default\"\n'        Case \"güni\"\n'            bot.SetProfile \"C:\\Users\\Güni\\AppData\\Local\\Temp\\283\\Selenium\\scoped_dir13024_1597492609\\Default\"\n'    End Select\n'\n'    'Chrome starten und die WhatsApp-Seite öffnen\n'    bot.Start \"Chrome\", \"https://web.whatsapp.com\"\n'    bot.Wait (7000)\n'    bot.Get \"/\"\n'\n'    'Messagebox anzeigen\n'    MsgBox \"Bitte bei Whatsapp im Browser anmelden anschließend 'OK' klicken.\"\n'\n'\n'\n'    'Schleife über alle Einträge\n'    Do While Not rs.EOF\n'        'Telefonnummer/Name ins Suchfeld einfügen\n'        bot.FindElementByXPath(\"//*[@id='side']/div[1]/div/div/div[2]/div/div[2]\").SendKeys (rs.Fields(\"Telefonnummer\").Value)\n'        bot.Wait (1000)\n'\n'        'Suche bestätigen\n'        bot.SendKeys (ks.Enter)\n'        bot.Wait (1000)\n'\n'        'Nachricht einfügen\n'        If rs.Fields(\"Nachricht\") <> \"\" Then\n'            bot.SendKeys (rs.Fields(\"Nachricht\").Value)\n'            bot.Wait (1000)\n'            'Nachricht absenden\n'            bot.SendKeys (ks.Enter)\n'            bot.Wait (1000)\n'        End If\n'\n'        'Anhang\n'        If rs.Fields(\"Anhang\") <> \"\" Then\n'            bot.FindElementByXPath(\"//*[@id='main']/footer/div[1]/div/span[2]/div/div[1]/div[2]/div/div/span\").Click\n'            bot.Wait (1000)\n'            'Dokument auswählen\n'            bot.FindElementByXPath(\"//*[@id='main']/footer/div[1]/div/span[2]/div/div[1]/div[2]/div/span/div/div/ul/li[4]/button/input\").SendKeys (rs.Fields(\"Anhang\").Value)\n'            bot.Wait (1500)\n'            'Nachricht absenden\n'            bot.SendKeys (ks.Enter)\n'            bot.Wait (1000)\n'        End If\n'\n'        rs.Edit\n'        rs.Fields(\"Status\") = \"gesendet\"\n'        rs.update\n'        rs.MoveNext\n'    Loop\n'\n'End Function"}
