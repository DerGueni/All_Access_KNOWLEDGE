{"id":"MOD_mdl_Exl_Import1","name":"mdl_Exl_Import1","kind":"standard","procedures":["Function fTimeReuck(s1 As Date, s2 As Date) As Date","Function fbackRev(s As String) As String","Function fkurz(s As String) As String","Function fDt(s As String) As Date","Function fZtAdd(s, t) As Date","Function fZt(s) As Date","Function ftst()","Function ftst1()","Function DateVervoll(Optional VA_ID As Long = 0)","Function fAlteID_Neu(Optional iID As Long = 210)","Function fAnzTage_erst(VA_ID As Long, Startdat As Date, endedat As Date) As Long"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n\nFunction fTimeReuck(s1 As Date, s2 As Date) As Date\nDim d As Date\nIf Left(s1, 1) = 0 And Left(s2, 1) = 2 Then\n    d = s1\nElse\n    d = s2\nEnd If\nfTimeReuck = d\nEnd Function\n\nFunction fbackRev(s As String) As String\nDim i As Long\ni = InStrRev(s, \"\\\")\nfbackRev = s\nIf i > 0 Then\n    fbackRev = Mid(s, i + 1)\nEnd If\nEnd Function\n\nFunction fkurz(s As String) As String\nDim i As Long\nDim pk As String\nfkurz = s\npk = Chr(46)\ni = InStrRev(s, pk, , vbTextCompare)\nIf i > 0 Then\n    fkurz = Left(s, i - 1)\n    fkurz = Mid(fkurz, 10)\nEnd If\nEnd Function\n\nFunction fDt(s As String) As Date\nDim tt As Long\nDim mm As Long\nDim jj As Long\nmm = Left(s, 2)\ntt = Mid(s, 4, 2)\njj = 2000 + Mid(s, 7, 2)\nfDt = DateSerial(jj, mm, tt)\nEnd Function\n\nFunction fZtAdd(s, t) As Date\nDim si As Single\nDim dt As Date\nDim s2 As Single\nDim s3 As Single\n\nsi = CDbl(Nz(s, 0))\ns2 = CDbl(Nz(t, 0)) / 24#\ns3 = si + s2\nIf s3 >= 1 Then s3 = s3 - Fix(s3)\nfZtAdd = CDate(s3)\n\nEnd Function\n\nFunction fZt(s) As Date\nDim si As Single\nDim dt As Date\n\nOn Error Resume Next\n\nsi = CDbl(Nz(s, 0))\nIf si >= 1 Then si = si - Fix(si)\nfZt = CDate(si)\n\nEnd Function\n\n\nFunction ftst()\n\nDim ID As Long, StrName As String, strPath As String\n\nOn Error Resume Next\n\nDim ArrFill_DAO_OK1 As Boolean, recsetSQL1 As String, iZLMax1 As Long, iColMax1 As Long, DAOARRAY1, iZl As Long, iCol As Long\nrecsetSQL1 = \"Select ID, Dateiname, strPath from Import_Auftraege_2015_09_09;\"\nArrFill_DAO_OK1 = ArrFill_DAO_Acc(recsetSQL1, iZLMax1, iColMax1, DAOARRAY1)\n'Info:   'AccessArray(iSpalte,iZeile) <0, 0>\nIf ArrFill_DAO_OK1 Then\n    For iZl = 0 To iZLMax1\n        ID = DAOARRAY1(0, iZl)\n        StrName = DAOARRAY1(1, iZl)\n        strPath = DAOARRAY1(2, iZl)\n            Call DoCmd.TransferSpreadsheet(acImport, 8, \"T_\" & Right(\"000\" & ID, 3), strPath & StrName, False, \"Liste!A:DA\")\n        DoEvents\n    Next iZl\n    Set DAOARRAY1 = Nothing\nEnd If\n\nEnd Function\n\nFunction ftst1()\n\nDim ID As Long, StrName As String, strPath As String\n\nOn Error Resume Next\n\nDim ArrFill_DAO_OK1 As Boolean, recsetSQL1 As String, iZLMax1 As Long, iColMax1 As Long, DAOARRAY1, iZl As Long, iCol As Long\nrecsetSQL1 = \"Select ID, Dateiname, strPath from Import_Auftraege_2015_09_09;\"\nArrFill_DAO_OK1 = ArrFill_DAO_Acc(recsetSQL1, iZLMax1, iColMax1, DAOARRAY1)\n'Info:   'AccessArray(iSpalte,iZeile) <0, 0>\nIf ArrFill_DAO_OK1 Then\n    For iZl = 0 To iZLMax1\n        ID = DAOARRAY1(0, iZl)\n        StrName = DAOARRAY1(1, iZl)\n        strPath = DAOARRAY1(2, iZl)\n            Call DoCmd.TransferSpreadsheet(acLink, 8, \"L_\" & Right(\"000\" & ID, 3), strPath & StrName, False)\n        DoEvents\n    Next iZl\n    Set DAOARRAY1 = Nothing\nEnd If\n\nEnd Function\n\nFunction DateVervoll(Optional VA_ID As Long = 0)\n\nDim db As DAO.Database\nDim rst As DAO.Recordset\n\nDim vglDat As String\n\nSet db = CurrentDb\nIf VA_ID = 0 Then\n    Set rst = db.OpenRecordset(\"SELECT * FROM tblZZZ_XL_Auftrag_MA_Einsatz ORDER BY VA_ID, ID;\")\nElse\n    Set rst = db.OpenRecordset(\"SELECT * FROM tblZZZ_XL_Auftrag_MA_Einsatz WHERE VA_ID = \" & VA_ID & \" ORDER BY VA_ID, ID;\")\nEnd If\nWith rst\n    Do While Not .EOF\n        If Len(Trim(Nz(.fields(\"VA_DatumStr\")))) = 0 Then\n            .Edit\n                .fields(\"VA_DatumStr\") = vglDat\n            .update\n        Else\n            vglDat = .fields(\"VA_DatumStr\")\n        End If\n        .MoveNext\n    Loop\nEnd With\n\nEnd Function\n\nFunction fAlteID_Neu(Optional iID As Long = 210)\n\nDim db As DAO.Database\nDim rst As DAO.Recordset\n\nDim vglDat As String\nDim i As Long\n\ni = iID\n\nSet db = CurrentDb\nSet rst = db.OpenRecordset(\"SELECT * FROM qry_IDAlt_Upd ORDER By DatumVon;\")\nWith rst\n    Do While Not .EOF\n        .Edit\n            .fields(\"IDAlt\") = i\n        .update\n        i = i + 1\n        .MoveNext\n    Loop\n    .Close\nEnd With\nSet rst = Nothing\nEnd Function\n\nFunction fAnzTage_erst(VA_ID As Long, Startdat As Date, endedat As Date) As Long\n\nDim i As Long\nDim j As Long\nDim dtk As Date\nDim db As DAO.Database\nDim rst As DAO.Recordset\n   On Error GoTo fAnzTage_erst_Error\n\nSet db = CurrentDb\n\nfAnzTage_erst = 0\n\n'On Error Resume Next\n\nSet rst = db.OpenRecordset(\"Select top 1 * From tbl_VA_AnzTage;\")\nWith rst\nj = DateDiff(\"d\", Startdat, endedat, 2, 2)\ndtk = Startdat\nFor i = 0 To j\n    .AddNew\n        .fields(1) = VA_ID\n        .fields(2) = dtk\n        .fields(3) = 0\n        .fields(4) = 0\n        .fields(5) = True\n        .fields(6) = 0\n    .update\n    dtk = dtk + 1\nNext i\n.Close\nEnd With\nSet rst = Nothing\n\n   On Error GoTo 0\n   Exit Function\n\nfAnzTage_erst_Error:\n    If err.Number = 3022 Or err.Number = 3201 Then\n        err.clear\n        Resume Next\n    Else\n        MsgBox \"Error \" & err.Number & \" (\" & err.description & \") in procedure fAnzTage_erst of Modul Modul1\"\n    End If\nEnd Function"}
