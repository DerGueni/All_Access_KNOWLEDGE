{"id":"MOD_mdlExcelExportMAEinzel","name":"mdlExcelExportMAEinzel","kind":"standard","procedures":["Function Monat_Erz(iAktMon As Long, iAktJahr As Long, MA_ID As Long)"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n\nFunction Monat_Erz(iAktMon As Long, iAktJahr As Long, MA_ID As Long)\n\nDim strSQL As String\n\nCall CreateQuery(\"SELECT \" & iAktJahr & \" AS AktJahr, \" & iAktMon & \" AS AktMon FROM _tblInternalSystemFE;\", \"qry_JB_MA_AktMon\")\n\nDoEvents\n\nCurrentDb.Execute (\"Delete * FROM tbltmp_MA_Monat_Einzel;\")\n\nDoEvents\n\nstrSQL = \"\"\nstrSQL = \"INSERT INTO tbltmp_MA_Monat_Einzel ( AktDat, MA_ID ) SELECT dtDatum, \" & MA_ID & \" AS Aus1 FROM qry_Exl_Tag ORDER BY dtDatum;\"\nCall CreateQuery(strSQL, \"qry_Exl_MA_0\")\nDoEvents\nCurrentDb.Execute (\"qry_Exl_MA_0\")\n\nDoEvents\n\nCurrentDb.Execute (\"qry_Exl_Upd_Mo1\")\n\nDoEvents\nCurrentDb.Execute (\"qry_Exl_Upd_Mo2\")\n\nDoEvents\n\nstrSQL = \"\"\nstrSQL = strSQL & \"SELECT tbltmp_MA_Monat_Einzel.MA_ID, tbltmp_MA_Monat_Einzel.VAStart_ID, tbltmp_MA_Monat_Einzel.VA_ID, tbltmp_MA_Monat_Einzel.AktDat\"\nstrSQL = strSQL & \" FROM tbltmp_MA_Monat_Einzel\"\nstrSQL = strSQL & \" WHERE (((tbltmp_MA_Monat_Einzel.MA_ID)= \" & MA_ID & \") AND ((tbltmp_MA_Monat_Einzel.VA_ID)>0));\"\n\nCall CreateQuery(strSQL, \"qry_Exl_MA_1\")\n\nstrSQL = \"\"\nstrSQL = strSQL & \"SELECT tbl_MA_VA_Zuordnung.VA_ID, tbl_MA_VA_Zuordnung.VAStart_ID, tbl_MA_VA_Zuordnung.MA_ID, tbl_MA_VA_Zuordnung.VADatum\"\nstrSQL = strSQL & \" FROM tbl_MA_VA_Zuordnung\"\nstrSQL = strSQL & \" WHERE (((tbl_MA_VA_Zuordnung.MA_ID)= \" & MA_ID & \") AND ((Year([VADatum]))= \" & iAktJahr & \") AND ((Month([VADatum]))= \" & iAktMon & \"));\"\n\nCall CreateQuery(strSQL, \"qry_Exl_MA_2\")\n\nstrSQL = \"\"\nstrSQL = strSQL & \"SELECT qry_Exl_MA_2.*\"\nstrSQL = strSQL & \" FROM qry_Exl_MA_2 LEFT JOIN qry_Exl_MA_1 ON (qry_Exl_MA_2.MA_ID = qry_Exl_MA_1.MA_ID) AND (qry_Exl_MA_2.VAStart_ID = qry_Exl_MA_1.VAStart_ID)\"\nstrSQL = strSQL & \" WHERE (((qry_Exl_MA_1.VAStart_ID) Is Null));\"\n\nCall CreateQuery(strSQL, \"qry_Exl_MA_3\")\n\nDoEvents\nCurrentDb.Execute (\"qry_Exl_MA_4\")\n\nDoEvents\nCurrentDb.Execute (\"qry_Exl_Upd_Mo2\")\n\nDoEvents\n\nEnd Function"}
