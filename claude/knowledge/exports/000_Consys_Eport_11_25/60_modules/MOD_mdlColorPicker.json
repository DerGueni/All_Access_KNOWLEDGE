{"id":"MOD_mdlColorPicker","name":"mdlColorPicker","kind":"standard","procedures":["Public Function ShowColorDialog(Optional ByVal PreSelectedColor As Long = 0) As Long"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"' Original Code by Terry Kreft\n' Modified by Stephen Lebans\n' Contact Stephen@lebans.com\n\nOption Compare Database\nOption Explicit\n'***********  Code Start  ***********\nPrivate Type COLORSTRUC\n  lStructSize As Long\n  hwnd As Long\n  hInstance As Long\n  rgbResult As Long\n  lpCustColors As String\n  Flags As Long\n  lCustData As Long\n  lpfnHook As Long\n  lpTemplateName As String\nEnd Type\n\nPrivate Const CC_SOLIDCOLOR = &H80\nPrivate Const CC_RGBINIT = &H1\n\n\nPrivate Declare PtrSafe Function ChooseColor Lib \"comdlg32.dll\" Alias \"ChooseColorA\" _\n  (pChoosecolor As COLORSTRUC) As Long\n\nPublic Function ShowColorDialog(Optional ByVal PreSelectedColor As Long = 0) As Long\n  Dim X As Long, cs As COLORSTRUC, CustColor(16) As Long\n\n  cs.lStructSize = Len(cs)\n  \n  cs.hwnd = Application.hWndAccessApp\n\n  cs.Flags = CC_SOLIDCOLOR Or CC_RGBINIT\n  cs.lpCustColors = String$(16 * 4, 0)\n  \n  cs.rgbResult = PreSelectedColor\n\n  X = ChooseColor(cs)\n  If X = 0 Then\n    ' ERROR - return preselected Color\n     ShowColorDialog = PreSelectedColor\n    Exit Function\n  Else\n    ' Normal processing\n     ShowColorDialog = cs.rgbResult\n  End If\n  \nEnd Function\n'***********  Code End   ***********\n\n\n\n'Function XRGB(x As Long) As Variant\n'XRGB = \"#\" & Right(\"000000\" & Hex(x), 6)\n'End Function\n"}
