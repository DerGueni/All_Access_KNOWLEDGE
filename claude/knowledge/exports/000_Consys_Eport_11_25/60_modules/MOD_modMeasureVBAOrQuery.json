{"id":"MOD_modMeasureVBAOrQuery","name":"modMeasureVBAOrQuery","kind":"standard","procedures":["Function MeasureQuery(strQueryName)","Sub StartMeasureVBA()","Sub StopMeasureVBA()","Sub MeasureVBATest()"],"calls":{"DoCmd.OpenForm":[],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n\nDeclare PtrSafe Function GetTickCount Lib \"kernel32\" () As Long\n\nPublic MVBAStartTime As Long, MVBAEndTime As Long\nFunction MeasureQuery(strQueryName)\n  Dim MQStartTime As Long, MQEndTime As Long\n  Dim t As Variant\n  Dim db As DAO.Database, rs As DAO.Recordset, qd As DAO.QueryDef\n\n  DoCmd.Hourglass True\n  On Error GoTo SQ_Error\n  \n  Set db = CurrentDb()\n  Set qd = db.QueryDefs(strQueryName)\n  \n  MQStartTime = GetTickCount()\n  \n  Set rs = qd.OpenRecordset(dbOpenDynaset)\n  If Not rs.EOF Then rs.MoveLast\n  rs.Close\n  \n  MQEndTime = GetTickCount()\n  \n  DoCmd.Hourglass False\n  MsgBox \"Abfrage '\" & strQueryName & \"' benötigte \" & Format((MQEndTime - MQStartTime) / 1000, \"0.000\") & \" Sekunden...\"\n  \n  Set rs = Nothing\n  Set db = Nothing\n  \n  Exit Function\n\nSQ_Error:\n  DoCmd.Hourglass False\n  MsgBox \"Oops - Fehler bei Ausführung der Abfrage '\" & strQueryName & \"': \" & err.description & \"...\"\n    \nEnd Function\n\nSub StartMeasureVBA()\n\n  On Error Resume Next\n  MVBAStartTime = GetTickCount()\n    \nEnd Sub\n\nSub StopMeasureVBA()\n\n  On Error Resume Next\n  MVBAEndTime = GetTickCount()\n    \n  MsgBox \"Ausführung benötigte \" & Format((MVBAEndTime - MVBAStartTime) / 1000, \"0.000\") & \" Sekunden...\"\n  \nEnd Sub\n\n\nSub MeasureVBATest()\n  Dim i&\n  Dim varLookup As Variant\n  \n  On Error Resume Next\n  StartMeasureVBA\n  For i = 1 To 10000\n    DoEvents\n    varLookup = TLookup(\"*\", \"Bestellungen\", \"[Kunden-Code]='ANTON'\")\n  Next i\n  StopMeasureVBA\n  \nEnd Sub\n\n"}
