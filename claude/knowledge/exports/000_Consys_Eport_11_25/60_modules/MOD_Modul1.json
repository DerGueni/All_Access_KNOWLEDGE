{"id":"MOD_Modul1","name":"Modul1","kind":"standard","procedures":["Sub TEST()","Function Testhyp()","Function Ftest_UE()","Function MA_Upd1()","Sub send_qr_mail()","Function sendQR_mail(Email As String, attach As String) As String"],"calls":{"DoCmd.OpenForm":["frm_VA_Auftragstamm","frmTop_VA_Tag_sub"],"DoCmd.OpenReport":[],"DoCmd.RunSQL":[],"CurrentDb.Execute":[],"DLookup":[],"DCount":[],"DMax":[],"DMin":[]},"source":"Option Compare Database\nOption Explicit\n\n\nSub TEST()\nDim tbl As String\nDim ABF As String\nDim sql As String\n\n    ABF = \"zqry_ZK_Stunden_Union\"\n    tbl = \"ztbl_zqry_ZK_Stunden_Union\"\n    \n    sql = \"SELECT * INTO \" & tbl & \" FROM \" & ABF & \" WHERE Monat = 1 And Jahr = 2023 And MA_ID = 56\"\n    \n    If TableExists(tbl) Then DoCmd.DeleteObject acTable, tbl\n    CurrentDb.Execute sql\nEnd Sub\n\n\nFunction Testhyp()\n\nApplication.FollowHyperlink \"C:\\Kunden\\CONSEC (Siegert)\\PGM\\Dokumente\\Auftrag\\Auf_Zusage_02.11.2015_415.pdf\"\n\nEnd Function\n\n\nFunction Ftest_UE()\n\nDim mycontrol\n\nDim iVADatum_ID As Long\nDim iVA_ID As Long\nDim strSQL2 As String\nDim dtsich As Date\nDim stdat As Date\n\nSet mycontrol = Screen.ActiveForm.ActiveControl\n'Debug.Print mycontrol.Name\n'\n'Debug.Print mycontrol.Column(0)\n'Debug.Print mycontrol.Column(1)\n'Debug.Print mycontrol.Column(2)\n'Debug.Print mycontrol.Column(3)\n'Debug.Print mycontrol.Column(4)\n\n\n\n'Alle STunden berechnen\n\n\niVA_ID = mycontrol.Column(0)\niVADatum_ID = mycontrol.Column(1)\nstdat = mycontrol.Column(2)\n\nstrSQL2 = \"\"\nstrSQL2 = strSQL2 & \"SELECT tbl_MA_VA_Zuordnung.ID, tbl_MA_VA_Zuordnung.VA_ID, Nz(tbl_MA_VA_Zuordnung.MA_ID,0) AS Ausdr1, tbl_MA_VA_Zuordnung.PosNr,\"\nstrSQL2 = strSQL2 & \" [Nachname] & ', ' & [Vorname] AS Mitarbeiter, Left(Nz([VA_Start]),5) AS Start\"\nstrSQL2 = strSQL2 & \" FROM tbl_VA_Start RIGHT JOIN (tbl_MA_VA_Zuordnung LEFT JOIN tbl_MA_Mitarbeiterstamm\"\nstrSQL2 = strSQL2 & \" ON tbl_MA_VA_Zuordnung.MA_ID = tbl_MA_Mitarbeiterstamm.ID) ON tbl_VA_Start.ID = tbl_MA_VA_Zuordnung.VAStart_ID\"\nstrSQL2 = strSQL2 & \" WHERE (tbl_MA_VA_Zuordnung.VA_ID= \" & iVA_ID & \") AND ((tbl_MA_VA_Zuordnung.VADatum_ID) = \" & iVADatum_ID & \") Order By PosNr;\"\n\n'DoCmd.OpenForm \"frm_VA_Auftragstamm\", , , \"ID = \" & iVA_ID\nDoCmd.OpenForm \"frmTop_VA_Tag_sub\"\nForms!frmTop_VA_Tag_sub!dtDatum = stdat\nForms!frmTop_VA_Tag_sub!VA_ID = iVA_ID\nForms!frmTop_VA_Tag_sub!lst_Ist.rowSource = strSQL2\nForms!frmTop_VA_Tag_sub!lst_Ist.Requery\nForms!frmTop_VA_Tag_sub.Requery\n\nEnd Function\n\nFunction MA_Upd1()\n\nDim strSQL As String\n\nstrSQL = \"\"\nstrSQL = strSQL & \"UPDATE tbl_MA_Mitarbeiterstamm INNER JOIN tbl_MA_Mitarbeiterstamm1 ON tbl_MA_Mitarbeiterstamm.ID = tbl_MA_Mitarbeiterstamm1.ID SET\"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.ID = [tbl_MA_Mitarbeiterstamm1].[ID], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.LEXWare_ID = [tbl_MA_Mitarbeiterstamm1].[LEXWare_ID], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.IstAktiv = [tbl_MA_Mitarbeiterstamm1].[IstAktiv], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.IstSubunternehmer = [tbl_MA_Mitarbeiterstamm1].[IstSubunternehmer], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Nachname = [tbl_MA_Mitarbeiterstamm1].[Nachname], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Vorname = [tbl_MA_Mitarbeiterstamm1].[Vorname], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Strasse = [tbl_MA_Mitarbeiterstamm1].[Strasse], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Nr = [tbl_MA_Mitarbeiterstamm1].[Nr], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.PLZ = [tbl_MA_Mitarbeiterstamm1].[PLZ], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Ort = [tbl_MA_Mitarbeiterstamm1].[Ort], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Land = [tbl_MA_Mitarbeiterstamm1].[Land], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Bundesland = [tbl_MA_Mitarbeiterstamm1].[Bundesland], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Tel_Mobil = [tbl_MA_Mitarbeiterstamm1].[Tel_Mobil], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Tel_Festnetz = [tbl_MA_Mitarbeiterstamm1].[Tel_Festnetz], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Email = [tbl_MA_Mitarbeiterstamm1].[Email], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Geschlecht = [tbl_MA_Mitarbeiterstamm1].[Geschlecht], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Staatsang = [tbl_MA_Mitarbeiterstamm1].[Staatsang], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Geb_Dat = [tbl_MA_Mitarbeiterstamm1].[Geb_Dat], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Geb_Ort = [tbl_MA_Mitarbeiterstamm1].[Geb_Ort], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Geb_Name = [tbl_MA_Mitarbeiterstamm1].[Geb_Name], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Eintrittsdatum = [tbl_MA_Mitarbeiterstamm1].[Eintrittsdatum], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Austrittsdatum = [tbl_MA_Mitarbeiterstamm1].[Austrittsdatum], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Anstellungsart_ID = [tbl_MA_Mitarbeiterstamm1].[Anstellungsart_ID], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Kostenstelle = [tbl_MA_Mitarbeiterstamm1].[Kostenstelle], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Auszahlungsart = [tbl_MA_Mitarbeiterstamm1].[Auszahlungsart], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Bankname = [tbl_MA_Mitarbeiterstamm1].[Bankname], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Bankleitzahl = [tbl_MA_Mitarbeiterstamm1].[Bankleitzahl], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Kontonummer = [tbl_MA_Mitarbeiterstamm1].[Kontonummer], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.BIC = [tbl_MA_Mitarbeiterstamm1].[BIC], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.IBAN = [tbl_MA_Mitarbeiterstamm1].[IBAN], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Kontoinhaber = [tbl_MA_Mitarbeiterstamm1].[Kontoinhaber], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Stundenlohn_brutto = [tbl_MA_Mitarbeiterstamm1].[Stundenlohn_brutto], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Bezuege_gezahlt_als = [tbl_MA_Mitarbeiterstamm1].[Bezuege_gezahlt_als], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Sozialvers_Nr = [tbl_MA_Mitarbeiterstamm1].[Sozialvers_Nr], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.SteuerNr = [tbl_MA_Mitarbeiterstamm1].[SteuerNr], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Taetigkeit_Bezeichnung = [tbl_MA_Mitarbeiterstamm1].[Taetigkeit_Bezeichnung], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Personengruppe = [tbl_MA_Mitarbeiterstamm1].[Personengruppe], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.KV_Kasse = [tbl_MA_Mitarbeiterstamm1].[KV_Kasse], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Ist_RV_Befrantrag = [tbl_MA_Mitarbeiterstamm1].[Ist_RV_Befrantrag], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Steuerklasse = [tbl_MA_Mitarbeiterstamm1].[Steuerklasse], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Arbst_pro_Arbeitstag = [tbl_MA_Mitarbeiterstamm1].[Arbst_pro_Arbeitstag], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Arbeitstage_pro_Woche = [tbl_MA_Mitarbeiterstamm1].[Arbeitstage_pro_Woche], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Resturl_Vorjahr = [tbl_MA_Mitarbeiterstamm1].[Resturl_Vorjahr], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Urlaubsanspr_pro_Jahr = [tbl_MA_Mitarbeiterstamm1].[Urlaubsanspr_pro_Jahr], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.StundenZahlMax = [tbl_MA_Mitarbeiterstamm1].[StundenZahlMax], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Hat_keine_34a = [tbl_MA_Mitarbeiterstamm1].[Hat_keine_34a], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Kleidergroesse = [tbl_MA_Mitarbeiterstamm1].[Kleidergroesse], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Fahrerlaubnis = [tbl_MA_Mitarbeiterstamm1].[Fahrerlaubnis], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Eigener_PKW = [tbl_MA_Mitarbeiterstamm1].[Eigener_PKW], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.HatSachkunde = [tbl_MA_Mitarbeiterstamm1].[HatSachkunde], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.DienstausweisNr = [tbl_MA_Mitarbeiterstamm1].[DienstausweisNr], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.tblBilddatei = [tbl_MA_Mitarbeiterstamm1].[tblBilddatei], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Bemerkungen = [tbl_MA_Mitarbeiterstamm1].[Bemerkungen], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Briefkopf = [tbl_MA_Mitarbeiterstamm1].[Briefkopf], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.IstBrfAuto = [tbl_MA_Mitarbeiterstamm1].[IstBrfAuto], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Anr = [tbl_MA_Mitarbeiterstamm1].[Anr], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Anr_Brief = [tbl_MA_Mitarbeiterstamm1].[Anr_Brief], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Anr_eMail = [tbl_MA_Mitarbeiterstamm1].[Anr_eMail], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Erst_von = [tbl_MA_Mitarbeiterstamm1].[Erst_von], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Erst_am = [tbl_MA_Mitarbeiterstamm1].[Erst_am], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Aend_von = [tbl_MA_Mitarbeiterstamm1].[Aend_von], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Aend_am = [tbl_MA_Mitarbeiterstamm1].[Aend_am], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.AUsweis_Funktion = [tbl_MA_Mitarbeiterstamm1].[AUsweis_Funktion], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.IstNSB = [tbl_MA_Mitarbeiterstamm1].[IstNSB], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Datum_34a = [tbl_MA_Mitarbeiterstamm1].[Datum_34a], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Ausweis_Endedatum = [tbl_MA_Mitarbeiterstamm1].[Ausweis_Endedatum], \"\nstrSQL = strSQL & \" tbl_MA_Mitarbeiterstamm.Kosten_pro_MAStunde = [tbl_MA_Mitarbeiterstamm1].[Kosten_pro_MAStunde];\"\n\nCall CreateQuery(strSQL, \"qry_MA_Update_MA_Neu\")\nDoEvents\nCurrentDb.Execute (\"qry_MA_Update_MA_Neu\")\nEnd Function\n\n\n\nSub send_qr_mail()\n\nDim attach As String\nDim Email  As String\nDim rs As Recordset\n\n    Set rs = CurrentDb.OpenRecordset(\"SELECT * FROM \" & MASTAMM & \" WHERE Anstellungsart_ID = 3 OR Anstellungsart_ID = 5\")\n    'Set rs = CurrentDb.OpenRecordset(\"SELECT * FROM \" & MASTAMM & \" WHERE Nachname = 'Kuypers'\")\n    Do While Not rs.EOF\n        Email = rs!Email\n        attach = \"\\\\vconsys01-nbg\\Consys\\Bilder\\Mitarbeiter\\QR Codes\\\" & rs!Nachname & \"_\" & rs!Vorname & \".jpg\"\n        If Email <> \"\" Then\n            If Dir(attach) = \"\" Then\n                'PDF erstellen und Verschicken !!!!!\n            End If\n            \n            'Debug.Print sendQR_mail(Email, attach)\n            'If sendQR_mail(Email, attach) <> \"\" Then Debug.Print rs!ID\n        End If\n        rs.MoveNext\n    Loop\n\n    \nEnd Sub\n\nFunction sendQR_mail(Email As String, attach As String) As String\n\nDim mailtext As String\n\n    'mailtext = \"Hallo zusammen,\" & vbCrLf & vbCrLf & \"wir testen gerade unser neues QR Code Check-In System.\" & vbCrLf & \"Deshalb würden wir Dich bitten, den beigefügten QR Code auf Deinem Handy zu speichern, um ihn beim Check In Test vor Ort verwenden zu können.\" & vbCrLf & vbCrLf & \"Vielen lieben Dank \"\n        \n    'sendQR_mail = send_Mail(Email, \"Consec QR_Code Check In\", mailtext, attach)\n    \n    If Dir(attach) = \"\" Then sendQR_mail = \"nope\"\n      \n\nEnd Function\n\n"}
